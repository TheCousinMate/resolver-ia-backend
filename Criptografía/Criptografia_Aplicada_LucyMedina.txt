Criptografía y mecanismos
      de seguridad




            Autor: Lucy Noemy Medina Velandia
  Criptografía y mecanismos de seguridad / Lucy Noemy Medina
  Velandia, / Bogotá D.C., Fundación Universitaria del Área Andina. 2017


  978-958-5460-19-5


  Catalogación en la fuente Fundación Universitaria del Área Andina (Bogotá).




© 2017. FUNDACIÓN UNIVERSITARIA DEL ÁREA ANDINA
© 2017, PROGRAMA INGENIERIA DE SISTEMAS
© 2017, LUCY NOEMY MEDINA VELANDIA

Edición:
Fondo editorial Areandino
Fundación Universitaria del Área Andina
Calle 71 11-14, Bogotá D.C., Colombia
Tel.: (57-1) 7 42 19 64 ext. 1228
E-mail: publicaciones@areandina.edu.co
http://www.areandina.edu.co

Primera edición: noviembre de 2017



Corrección de estilo, diagramación y edición: Dirección Nacional de Operaciones virtuales
Diseño y compilación electrónica: Dirección Nacional de Investigación


Hecho en Colombia
Made in Colombia



Todos los derechos reservados. Queda prohibida la reproducción total o parcial de esta
obra y su tratamiento o transmisión por cualquier medio o método sin autorización escrita
de la Fundación Universitaria del Área Andina y sus autores.
Criptografía y mecanismos de
          seguridad



               Autor: Lucy Noemy Medina Velandia
i
    Índice




       UNIDAD 1 Criptografía
          Introducción                       7

          Metodología                        8

          Desarrollo temático                9

       UNIDAD 1 Usos de la criptografía
          Introducción                       24

          Metodología                        25

          Desarrollo temático                26

       UNIDAD 2 Herramientas de Desarrollo
       Disponibles
          Introducción                       36

          Metodología                        37

          Desarrollo temático                38

       UNIDAD 2 Protocolos criptográficos
          Introducción                       53

          Metodología                        54

          Desarrollo temático                55
i
    Índice



       UNIDAD 3 Algoritmos de criptografía
       simétrica
          Introducción                       75

          Metodología                        76

          Desarrollo temático                77

       UNIDAD 3 Algoritmos de criptografía
       simétrica
          Introducción                       95

          Metodología                        96

          Desarrollo temático                97

       UNIDAD 4 Criptografía en la capa de
       aplicación
          Introducción                       106

          Metodología                        107

          Desarrollo temático                108

       UNIDAD 4 Criptografía en la capa de
       aplicación
          Introducción                       123

          Metodología                        124

          Desarrollo temático                125

       Bibliografía                          140
 1
UNIDAD



     1 Unidad 1




   Criptografía        Criptografía y
                  mecanismos de seguridad

                      Autor: Lucy Medina
Introducción   Debido a la creciente incursión de los usuarios en la red y al
               gran volumen de información que se maneja, surge la eviden-
               te necesidad de ocultar cierta información que para algunas
               empresas o personas es relevante y de suma importancia. In-
               ternet es utilizado para compartir información y realizar tran-
               sacciones de toda índole, sobre todo las entidades financieras
               que realizan la mayor parte de sus operaciones en línea; pero
               la información que viaja través de las redes puede ser inter-
               ceptada y utilizada en contra del usuario o desfavoreciendo
               su bienestar. Por ello, asegurar la información se hace impe-
               rativo y qué mejor que a través de criptografía (que oculta
               mensajes), la esteganografía (que esconde la información de
               manera desapercibida) y el criptoanálisis (que reconstruye un
               mensaje cifrado) que dan la posibilidad de proteger los datos
               que viajan a través de la red.

               La idea de las técnicas mencionadas es que la información se
               vuelva confiable, fiable, íntegra y auténtica, por ello, es impor-
               tante aprender de dónde viene la criptografía, los métodos
               más utilizados y el futuro que se espera sobre esta materia.




                                              Fundación Universitaria
                                              Fundación Universitaria del
                                                                      del Área
                                                                          Área Andina
                                                                               Andina   7
                                                                                        3
U1            Metodología


     En este primer capítulo del módulo, se estudiarán las bases para entender los siguientes
     capítulos y tener claras las ideas que serán utilizadas. Se trabajarán conceptos desde qué
     es la criptografía, su finalidad, los métodos utilizados en la criptografía, la seguridad de la
     información y se estudiarán conceptos sobre la técnica llamada criptosistema, que no es
     otra cosa que un conjunto de instrucciones para garantizar la seguridad de la información a
     través de técnicas criptográficas, las cuales utilizan las claves o llaves.

     Recomendaciones:
     ■ Realizar las lecturas asignadas.
     ■ Elaborar cada uno de los trabajos asignados.
     ■ Realizar las evaluaciones propuestas.
     ■ Cuando no entienda algo, comuníquese con su tutor.
     ■ No continúe con el siguiente tema, hasta que esté perfectamente claro el tema actual.
     ■ Siempre que lea, hágalo entendiendo las ideas.




                                                                  Fundación
                                                                  Fundación Universitaria
                                                                            Universitaria del
                                                                                          del Área
                                                                                              Área Andina   8
                                                                                                   Andina   4
U1            Desarrollo temático


                                                        puede sufrir dos eventos, el uno que llegue
     Historia de la criptografía
                                                        al receptor y lo descifre o que el mensaje sea
     Para iniciar con la historia de la Criptografía,   interceptado y los intrusos lo desencripten
     vale la pena entender lo que es. Básicamen-        y puedan leer el mensaje.
     te, se trata de una herramienta de gran utili-
     dad para tener segura la información y que             Mensaje
     ésta sea confiable, íntegra y esté disponible
                                                                                                 Mensaje
     cuando se necesite. En síntesis, la Criptogra-
     fía es una ciencia que apunta hacia la segu-
     ridad de los datos y los documentos, para
     ello, utiliza códigos o claves que permiten          Ciframiento
     almacenar información secreta que pueda
     circular por medios públicos o privados y
     que para muchos pase desapercibida, solo
     la conocerá el emisor y el receptor siempre y                              Mensaje
     cuando sepan cómo traducir la información                                interceptado
                                                          Criptograma                         Desencriptado
     para entenderla o cómo cifrarla para que
     otros no la comprendan.

     Es importante que el educando aprenda
     que la Criptografía tiene dos divisiones, de
     una parte, la Criptografía y de otra el Crip-      Desciframiento                           Mensaje
     toanálisis. La primera, estudia las técnicas
     del cifrado de la información y la segunda,
     se dedica a todo lo contrario, es decir, a des-           Figura 1. Ciclo de un mensaje secreto
     cifrar o decodificar esa información.                                 Fuente: Propia.

     En la figura 1, se muestra lo que sucede           Una vez entendidos los conceptos de cripto-
     cuando se envía un mensaje, este se cifra          grafía y criptoanálisis, iniciemos con la histo-
     y continúa su viaje como un Criptograma,           ria de la criptografía.
     o sea que hace referencia al mensaje cifra-
     do, es decir que no es entendible por quien        La práctica del ciframiento, ha existido des-
     no conoce la clave para descifrarlo. En ese        de épocas remotas, es el caso de la Mesopo-
     trayecto, el mensaje cifrado o Criptograma         tamia, la India y la China, utilizaban métodos




                                                                        Fundación Universitaria del Área Andina   5
                                                                                                                  9
para que nadie supiera lo que ellos escon-       En la india consideran el Kama Sutra como
dían. De la misma manera, Julio César, mili-     un técnica encriptada para que los amantes
tar y político romano, utilizaba un método       se comunicaran sin ser descubiertos.
particular para cifrar mensajes, consistía en
                                                 Criptografía medieval
sustituir cada una de las letras de un men-
saje por la tercera letra siguiente del alfa-    Año 1000, se inventa la técnica del análisis
beto. Posteriormente, durante la Primera         de frecuencias con el objeto de romper o
Guerra Mundial, la criptografía se convierte
                                                 descifrar los cifrados por sustitución mo-
en un arma útil para la comunicación, pero
                                                 noalfabética, todo esto se realizó a partir
los resultados no fueron los esperados, por
                                                 del Corán, porque le hicieron un análisis
ejemplo, en esta Primera Guerra Mundial se
utilizó intensamente la criptografía; el códi-   textual.
go Ubchi fue desarrollado por los alemanes,
                                                 En 1465 León Battista Alberti inventó el ci-
el cual fue penetrado por los franceses, a
                                                 frado polialfabético.
la vez, los códigos de la fuerza naval de los
alemanes fueron descifradas por Room 40,         En 1510 se utiliza la criptografía en Japón,
también conocido como 40 O.B., que era           pero fue en 1860 que realmente se utiliza-
una sección del Almirantazgo británico que       ron las técnicas avanzadas de criptografía,
trabajaba con el criptoanálisis durante esta
                                                 cuando el país se abrió hacia occidente.
guerra mundial; esta intromisión dentro de
los códigos navales alemanes, hizo que el        Criptografía de 1800 a la Segunda Guerra
Reino Unido tomara la delantera a Alemania       Mundial
y preparara batallas para combatirlos.
Criptografía clásica                             En el siglo XIX se desarrollaron soluciones
                                                 adecuadas para el cifrado y el criptoanálisis.
Hace más de 4500 años en Egipto se inicia        Se distinguieron Charles Babbage, que es-
el uso de jeroglíficos tallados en monu-         tudió el cifrado polialfabético. Esta fue una
mentos.                                          época que se distinguió porque la cripto-
                                                 grafía constaba de reglas muy generales.
Los hebreos utilizaron también los cifrados
por sustitución monoalfabético.                  En el año 1840, otro personaje que se dis-
                                                 tinguió en esta época fue Edgar Alan Poe,
El número “666” denominado el número de
                                                 quien desarrolló métodos sistemáticos
la bestia es considerado como un criptogra-
                                                 que resolvían cifrados, Poe a través de un
ma que oculta algo peligroso.
                                                 periódico invitada a las personas para que
Los militares espartanos utilizaron el cifrado   enviaran mensajes cifrados que él resolvía
por transposición por medio de uno de los        con facilidad, esto le trajo atracción por un
primero dispositivos de cifrado como era la      tiempo.
Escitala.
                                                 Antes de la segunda guerra mundial William
Los romanos utilizaron el cifrado César y sus    Friedman utilizó técnicas estadísticas para
variaciones.                                     desarrollar el criptoanálisis.




                                                             Fundación
                                                             Fundación Universitaria
                                                                       Universitaria del
                                                                                     del Área
                                                                                         Área Andina
                                                                                              Andina   10
                                                                                                       6
Criptografía en la Segunda Guerra Mun-            A mediados de los años 70 se avanzó en dos
dial                                              aspectos, uno fue la propuesta que la IBM
                                                  envió al Registro Federal una propuesta ti-
Se empieza el uso de máquinas de cifrado          tulada “Data Encryption Standard - DES-”,
mecánicas y electromecánicas.                     con el fin de desarrollar sistemas de comu-
                                                  nicación seguras para empresas financieras-
Los alemanes utilizan bastante la máquina         bancarias- y otras empresas.
llamada Enigma del ejército alemán.
                                                  En 1977, luego de realizar mejoras al escri-
Una vez estalló la segunda guerra mundial,        to antes mencionado, la NSA de los Estados
Allan Turing y Gordon Welchman, progresa-         Unidos, publica el “Federal Information Pro-
ron bastante en la tecnología de descifrado       cessing Standard”.
de la máquina Enigma.
                                                  En 2001 el DES fue reemplazado por el AES
En 1940 los criptógrafos británicos y holan-      -Advanced Encryption Standard- que es un
deses rompieron los sistemas criptográficos       algoritmo llamado Rijndael realizado por
de la Armada japonesa.                            criptógrafos Bbelgas. De este algoritmo se
                                                  han realizado variantes que hoy en día toda-
Militares del ejército americano rompió el        vía se utilizan. Desafrotunadamente el DES
sistema criptográfico de la diplomacia japo-      (que utiliza 56 bits) es hoy en día inseguro
nesa, que llevó a la victoria de Estados Uni-     para los nuevos criptosistemas.
dos en la batalla de Midway.
                                                  En 1976 cambian radicalmente la forma de
Los alemanes en cabeza de Max Newman y            funcionamiento de los criptosistemas. Apa-
su grupo de trabajo crearon el Colossus, que      rece el famoso “intercambio de claves Diffie-
colaboró con el criptoanálisis.                   Hellman” desarrollado por Whitfield Diffie y
                                                  Martin Hellman.
Hubo tres máquinas utilizadas para la crip-
tografía, como la Typex británica y la Sigaba     También en 1976 a partir de la creación del
norteamericana, Lacida de los polacos, la         algoritmo Diffie-Hellman, aparece un nuevo
M-209 y la M-94.                                  algoritmo para realizar cifrado, llamados al-
                                                  goritmos de cifrado asimétrico.
Criptografía moderna
                                                  También aparece en contraste a los algo-
En 1949, Shannon Claude, llamado el padre         ritmos de cifrado simétrico, los algoritmos
de la criptografía moderna, realiza escritos y    de clave asimétrica, que utilizan claves re-
un libro sobre la teoría de la información y la   lacionadas matemáticamente, consiste en
comunicación, que sirvió como base para el        que una clave realiza el descifrado de la otra
criptoanálisis y criptografía moderna.            clave. A este par de claves se les llama hoy
                                                  en día la clave privada y la clave pública. La
La criptografía es orientada al espionaje         clave privada, siempre será secreta, la clave
y contraespionaje, la dependencia de los          pública la pueden conocer los usuarios en
Estados Unidos denominada la NSA, fue la          general. Para poder acceder a un mensaje
abanderada de la criptografía entre los años      cifrado de este tipo, el usuario debe conocer
1950 a 1970.                                      la clave privada y la pública.




                                                              Fundación
                                                              Fundación Universitaria
                                                                        Universitaria del
                                                                                      del Área
                                                                                          Área Andina
                                                                                               Andina   11
                                                                                                        7
Entre 1982 y 1992, Estados Unidos realiza               Criptoanálisis moderno
grandes cambios legislativos a través de la
NSA.                                                    AES es considerado el cifrador irrompible.

En 1991 Phil Zimmermann publicó el Pretty               Surgen los cifrados A5/1 y A5/2, dirigidos a
Good Privacy - PGP - que hacía una defen-               los teléfonos móviles GSM.
sa del cifrado fuerte para uso público y fue
distribuido como freeware, al pasar el tiem-            Conceptos generales
po se convirtió en el estándar RFC2440 u                La Criptografía se puede clasificar como se
OpenPGP.                                                aprecia en la siguiente figura.




                                              Criptografía

                    Clásica                                                 Moderna


    Transposición               Sustitución                  Simétrica                  Asimétrica


                                              Bloques                         Flujo


                               Figura 2. Clasificación de la Criptografía
                                            Fuente: Propia.




Algunos términos comunes de la Cripto-                    está en un lugar inseguro o público. Son
grafía                                                    mil veces más rápidos que los algoritmos
a. Criptografía: arte de cifrar y descifrar in-           asimétricos.
   formación, para ello utiliza técnicas que
                                                        b. Cifrado: proceso que transforma la infor-
   hacen posible el intercambio de mensa-
   jes de manera segura y éstos solo pueden                mación por medio de un algoritmo de ci-
   ser leídos por la persona a quien se diri-              frado y para poderlo descifrar se requiere
   ge el mensaje, sin importar si el mensaje               de la clave secreta del algoritmo.




                                                                     Fundación
                                                                     Fundación Universitaria
                                                                               Universitaria del
                                                                                             del Área
                                                                                                 Área Andina
                                                                                                      Andina   12
                                                                                                               8
En la Figura 3, se aprecia gráficamente este proceso.

                                                 Cifrado

                                           Algoritmo de cifrado
    Información en                                                                       Información
      texto plano                                                                           cifrada
                                             Clave de cifrado


                                               Descifrado

                                          Algoritmo de descifrado
       Información                                                                       Información en
          cifrada                                                                          texto plano
                                           Clave de descifrado


                              Figura 3. Cifrado y Descifrado de información
                                              Fuente: Propia.


c. Algoritmo o criptografía simétrica: encriptan y desencriptan información con la misma
   clave o llave, estos algoritmos son seguros y se transmiten con velocidad. Vea la siguiente
   figura.




                                               Clave secreta

                                                Archivo.txt

                 Emisor                                                         Receptor
                 Estudio                          $%&/(¡?                         Estudio


                     Figura 4. Cifrado y Descifrado de información con clave Simétrica
                                               Fuente: Propia




                                                                     Fundación
                                                                     Fundación Universitaria
                                                                               Universitaria del
                                                                                             del Área
                                                                                                 Área Andina
                                                                                                      Andina   13
                                                                                                               9
d. Algoritmos o criptografía asimétrica: en-                 desencriptarán con una clave privada.
   criptan y desencriptan información con                    Los bits que utiliza la llave de 3000 bits
   diferentes clave o llave. Los datos son                   para hacerla segura, son muy lentos. (Ver
   encriptados con una llave pública y se                    Figura 5)




                         Clave                                       Clave
                                               Archivo.txt
                        pública                                     privada

                      Estudio                   $%&/(¡?                       Estudio

                                  Figura 5. Cifrado con clave Asimétrica
                                               Fuente: Propia


e. Criptosistema: procedimiento que a                        simétrica, la asimétrica, la híbrida, la mez-
   través de un algoritmo con una clave,                     cla de las anteriores y las funciones hash
   transforma un mensaje en algo incom-                      o de resumen
   prensible para los usuarios, a menos que
                                                       i. Métodos de seguridad: métodos de clave
   tengan la clave para desencriptar.
                                                          simétrica, métodos de clave pública, cla-
f. Esteganografía: procedimiento por me-                  ve pública SSL, algoritmos de encripción
   dio del cual se esconde la información                 hashing, métodos de autenticación (que
   para que sea desapercibida, no necesa-                 pueden ser por contraseñas, tarjetas de
   riamente la información estará encripta-               acceso o firma digital)
   da, puede estar a la vista de los usuarios
   y no percatarse de que existe un mensa-             Finalidad de la criptografía
   je frente a sus ojos. Por ejemplo, en un
   paisaje que muestre el cielo, puede exis-           El principio fundamental de la criptografía
   tir una nube (dentro de la cual estará el           es mantener la comunicación entre dos en-
   mensaje).                                           tes con toda la seguridad y privacidad. Para
                                                       ello, se modifica o altera el archivo original
g. Criptoanálisis: es lo opuesto a encriptar, es       haciéndolo completamente incomprensi-
   decir es el estudio de métodos para obte-           ble para otros individuos, excepto para el
   ner el sentido de una información antes             receptor de la información. El envío de in-
   cifrada (descifra mensajes), utilizan la cla-       formación entre dos personas debe hacer-
   ve secreta para realizar la desencripción.          se por medio de reglas o claves para poder
h. Métodos de criptográficos: son métodos              enviar o recibir archivos confidenciales, sin
   para encriptar información. Entre estos             temor a que caiga en manos extrañas y en-
   métodos se encuentran: la criptografía              tiendan el mensaje.




                                                                      Fundación Universitaria
                                                                      Fundación Universitaria del
                                                                                              del Área
                                                                                                  Área Andina
                                                                                                       Andina   14
                                                                                                                10
Criptografía y criptosistema                      original no se modifique, sin importar si éste
Los criptosistemas, son un conjunto de pro-       es público o privado. La autenticación, ga-
cedimientos que salvaguardan la seguridad         rantiza la identidad del autor.
de la información entre dos entes y utilizan      Los tipos de criptografía pueden ser:
diferentes técnicas de criptografía. Existe
un término fundamental en estos procedi-          a. Criptografía de clave secreta: son algorit-
mientos, como es el uso de una llave o clave.        mos escritos específicamente para cifrar
                                                     un mensaje utilizando una clave única
Los criptosistemas tienen la particularidad          y secreta que es conocida solo por el
de tomar información legible y convertirla           receptor y el emisor, es decir, que para
en información no legible o no entendible.           descifrar el mensaje tanto receptor como
                                                     emisor deben conocer perfectamente di-
Los criptosistemas están formados matemá-            cha clave.
ticamente por:
                                                  b. Criptografía de clave pública: son algo-
a. Un alfabeto, el cual facilita la construc-        ritmos escritos específicamente para ci-
   ción de un mensaje.                               frar y descifrar los mensajes a través de
b. Espacios o claves, que pueden es conjun-          claves o llaves distintas, una para el ci-
   to finito de ellas y pueden ser para en-          frado y otra para el descifrado. Una clave
   criptar o desencriptar información.               no permite conseguir la otra, pues están
                                                     construidas por medio de relaciones ma-
c. Transformaciones de cifrado, diferentes           temáticas. Para poder enviar un mensaje,
   aplicaciones del alfabeto, llamadas tam-          el usuario debe conocer la clave pública
   bién transformaciones aritmético-lógicas          del usuario destino y cifrar el mensaje
   de cifrado.                                       usando esa clave. Este mensaje será recu-
d. Transformaciones de descifrado, diferen-          perado por el usuario receptor por medio
   tes aplicaciones del alfabeto, llamadas           de la clave privada.
   también transformaciones aritmético-             Este tipo de criptografía o algoritmos
   lógicas de descifrado.                           criptográficos trabajan con cualquiera de
                                                    las claves, es decir, si un mensaje se ha ci-
La criptología es la ciencia compuesta por la
                                                    frado con la clave pública, solo se descifra
criptografía y el criptoanálisis, recordando,
                                                    con la clave privada y el mensaje cifrado
la criptografía encripta la información y el
                                                    con la clave privada solo se descifrará con
criptoanálisis la desencripta. La criptogra-        la clave pública.
fía utiliza técnicas y algoritmos para poder
intercambiar información de forma segura.         Los usos que se le dan a la criptografía a dia-
                                                  rio pueden ser entre otros:
Algunas características de la criptogrfía es la
confidencialidad, que consiste en garantizar      a. Para firmas digitales
la seguridad de la información y que solo         b. Para certificados digitales
los interesados y autorizados puedan tener
acceso a ella. Otra característica es la inte-    c. Para sistemas de autenticación
gridad, la cual garantiza que la información      d. Para el correo electrónico seguro




                                                              Fundación Universitaria
                                                              Fundación Universitaria del
                                                                                      del Área
                                                                                          Área Andina
                                                                                               Andina   15
                                                                                                        11
Esteganografía                                           análisis de tráfico. No se detectan con
La esteganografía proviene de los grie-                  facilidad, pues implican alteración de
gos y significa “steganos”=secreto y                     los datos.
“grafía”=escrito, lo que traduce “escritura se-      •   Ataques activos: en este tipo de ata-
creta”, la cual se define como el arte de ocul-          que se puede modificar el flujo de
tar un mensaje dentro de otros. Este tipo de             datos o se crean flujos falsos. Algunas
ocultamiento de información se utiliza por               técnicas de este tipo de ataque son:
ejemplo incrustando un mensaje dentro de                 La suplantación, la modificación de
un archivo digital utilizado como medio. Al-             mensajes (que consisten en capturar
gunos de los archivos utilizados como: imá-              los paquetes para borrarlos, manipu-
genes, videos, archivos de música.                       larlos, modificarlos o reordenarlos), la
                                                         re actuación (que consiste en captu-
Algunas herramientas de tipo free o gratui-              rar un paquete o una retransmisión),
tas utilizadas para realizar esteganografía              la degradación (que consiste en de-
son: F5, desarrollada por Andreas Westfield.             gradar un servicio).
La herramienta MP3Stego, que esconde da-
                                                  2. Según el conocimiento previo:
tos en archivos MP3, consiste en unir un ar-
chivo .wav con uno de texto y transformarlo          •   Ataque con sólo texto cifrado dispo-
en un archivo MP3. Otra herramienta es la                nible: el atacante solo tiene acceso a
Steganos, que encripta y esconde archivos,               unos textos cifrados o codificados
el usuario puede escoger un archivo o una            •   Ataque con texto plano conocido: el
carpeta para ser escondida y después el lu-              atacante tiene un conjunto de textos
gar donde desea integrarlo.                              cifrados que conoce, pero también
                                                         conoce el descifrado
Criptoanálisis
                                                     •   Ataque con texto cifrado escogido: el
Hace referencia a que por medio del Crip-                atacante obtiene los textos cifrados
toanálisis se encuentran debilidades en los              planos que corresponden a algunos
sistemas y descifrar o romper la seguridad.              textos planos cifrados.
Una de las técnicas que utiliza el criptoanáli-
sis es la de busca errores en el sistema y po-
                                                     •   Ataque adaptativo de texto plano
                                                         escogido: el atacante elige los textos
derlo penetrar para hacer daños.
                                                         planos teniendo como premisa la in-
Los ataques criptoanalíticos tienen cierta               formación que ha obtenido de desci-
clasificación:                                           frados anteriores.

1. Según la actitud del atacante y se sub-           •   Ataque de clave relacionada: similar
   dividen en:                                           al ataque con texto cifrado elegido,
                                                         pero el que ataca puede elegir textos
   •   Ataques pasivos: en este tipo de ata-             cifrados usando dos claves distintas.
       que, el intruso no altera la comunica-
       ción, solo escucha o hace monitoreo        3. Según el objetivo en criptoanálisis:
       para obtener información, utiliza la          •   Ruptura total: el intruso deduce la
       técnica de escucha de paquetes y de               clave secreta.




                                                              Fundación Universitaria
                                                              Fundación Universitaria del
                                                                                      del Área
                                                                                          Área Andina
                                                                                               Andina   16
                                                                                                        12
   •   Deducción global: el intruso descu-          en la actualidad, es muy rápido que se
       bre el algoritmo para cifrado y des-         puede contar con la clave y por supuesto
       cifrado de mensajes, pero no tiene la        con el mensaje.
       clave.
                                                    Dentro de este tipo de criptografía exis-
   •   Deducción local: el intruso obtiene          ten dos métodos importantes:
       textos planos o cifrados adicionales a
       los conocidos.
                                                    •   Data Encryption Standard -DES-: Este
                                                        algoritmo para encriptar fue creado
   •   Deducción de información: el intruso             por la NSA cuyo objetivo era prestar
       descubre información que no era co-              servicios de protección de datos del
       nocida anteriormente.                            gobierno de los Estados Unidos. En
4. 4. Según el costo:                                   1976, este algoritmo de encripción
                                                        fue escogido por la Federal Informa-
   •   Tiempo: por el número de operacio-               tion Processing Standar - FIPS- para
       nes que pueden ser realizadas.                   ser promovido por el mundo entero.
   •   Memoria: por la cantidad de almace-              Pero al día de hoy, DES es muy inse-
       namiento que se requiere para hacer              guro, por cuanto su clave es de 56
       el ataque.                                       bits, muy insuficiente para el poder
   •   Datos: por la cantidad de textos pla-
                                                        de los algoritmos de desencripción
                                                        y al poder computacional con que se
       nos y cifrados.
                                                        cuenta.
Métodos criptográficos y seguridad                  Algunas propiedades de este algoritmo:
Los métodos criptográficos hacen referen-           Cifrado por bloques, cada bloque con
cia a las maneras como se cifra o descifra un       64 bits, la clave tiene 64 bits y 8 de es-
mensaje.                                            tos bits son empleados para comprobar
                                                    la paridad, es decir que la longitud real
Algunos de estos métodos de ciframientos            de la clave es de 56 bits. DES trabaja así:
son:                                                toma un bloque de una longitud fija y lo
a. La criptografía simétrica: este tipo de          transforma por medio de una serie de
   criptografía es del tipo monoclave, es de-       operaciones en otro bloque cifrado de la
   cir, una sola clave para cifrar y descifrar el   misma longitud.
   mensaje, lo que hace vulnerable este tipo
   de ciframiento, pues si alguien escucha el
                                                    •   Advanced Encryption Standard -AES-
                                                        : Rijndael, es su otro nombre y en
   canal por el cual se transmite el mensaje,           1997 fue escogido como ganador
   se corre el riesgo de que intercepte tam-            en el concurso realizado por el Insti-
   bién la clave, lo que hace inútil el cifra-          tuto Nacional de Normas y Tecnolo-
   miento.                                              gías -NIST- como el mejor algoritmo
   Para tratar con este tipo de ciframiento si-         de cifrado. Pasó a ser en 2001 como
   métrico, deberá utilizarse una clave muy             parte de FIPS y se transformó como
   segura y que el método de cifrado sea lo             estándar en 2002, a partir de 2006, es
   más adecuado posible, pues con los al-               el algoritmo que más se utiliza n crip-
   goritmos de desciframiento que existen               tografía simétrica en el mundo.




                                                             Fundación Universitaria
                                                             Fundación Universitaria del
                                                                                     del Área
                                                                                         Área Andina
                                                                                              Andina   17
                                                                                                       13
      El funcionamiento de este algoritmo          duce un XOR bit a bit del flujo de datos y
      es el siguiente: trabaja con una ma-         el de clave.
      triz de 4X4 bytes, que por medio de
      un algoritmo reordena los bytes de
                                                    •   Algoritmo de Flujo -Wired Equivalent
                                                        Privacy -WEP-: es un algoritmo de flu-
      la matriz. La misma clave se utiliza              jo. Este tipo de cifrado se incluye den-
      para descifrar y cifrar, es decir, es un          tro del estándar IEEE 802.11. Se basa
      algoritmo simétrico. Este algoritmo               en el mecanismo de cifrado RC4. Tie-
      funciona por medio de una serie de                ne dos tipos o variantes, la una utiliza
      ciclos de repetición, de los cuales se            clave de 64 bits, de los cuales utiliza
      utilizan diez ciclos para claves de 128           24 bits para el vector de iniciación
      bits, 12 para claves de 192 bits y 14             y los otros 40 para mensaje. La otra
      para claves de 256 bits.                          variante, utiliza clave de 128 bits, de
b. One-time PAD: este algoritmo de cifrado              los cuales 24 bits son para el vector
   fue inventado en 1997, el algoritmo es-              de iniciación y 104 bits para el texto.
   coge un texto a cifrar y éste se combina             Tiene dos estándares denominados
   con una clave aleatoria que tiene la mis-            WEP-40 y WEP-104. Estas versiones
   ma longitud y solo se usa una vez, lo que            de algoritmo fueron declaradas inse-
   lo hace irrompible.                                  guras en 2004, pero aún hoy se utiliza.
c. Cifradores de flujo y de bloque: estos ci-       •   Algoritmo Electronic Codebook -ECB-
   fradores trabajan con claves simétricas,             : es un algoritmo de bloque. Aunque
   toman grupos o bloques de bits de X lon-             existe muchos algoritmos de esta fa-
   gitud fija.                                          milia de bloque, éste es uno de los
                                                        más simples. La información la parte
  Los cifradores de bloque, utilizan un blo-
                                                        en bloques y cada uno es cifrado por
  que de texto plano y como resultado ob-
                                                        separado, pero tienen una clave co-
  tiene un bloque de texto de igual longi-
                                                        mún. El principal problema de este
  tud, pero cifrado; esa transformación de
                                                        algoritmo es que como los bloques
  texto plano a cifrado, se hace por medio
                                                        son idénticos, los bloques cifrados,
  del uso de una clave secreta. El proceso
                                                        también lo son, lo que lleva a que se
  contrario, de texto cifrado a plano, se
                                                        pueda conocer el patrón y de esta
  hace de la misma manera.
                                                        manera se facilitará obtener el men-
  El inconveniente que presentan los cifra-             saje original. Mejorando este algorit-
  dos por bloques es que hay determina-                 mo, se crea el Cipher Block Chaining
  das aplicaciones que no pueden utilizar               -CBC-, cuya mejora es la de hacer
  este tipo de ciframiento por estar forma-             XOR al bloque antes de cifrarse con
  das por un flujo constante de bits.                   el anterior cifrado y luego cifrarlo.
  Los cifradores de flujo, son algoritmos               También surgieron algoritmos como
  que convierten un texto en cifrado, pero              el CFB, el OFB que hacen cifrado pase
  lo hacen bit a bit. Trabajan muy parecido             a operar como un cifrador de flujo.
  a los cifradores de bloque, pero en la en-     d. Cifrado asimétrico: se conoce también
  trada se tiene un flujo de datos, se genera       como de clave pública. Emplea dos cla-
  una Flujo de Clave y como salida se pro-          ves para el mismo individuo, de las cua-




                                                             Fundación Universitaria
                                                             Fundación Universitaria del
                                                                                     del Área
                                                                                         Área Andina
                                                                                              Andina   18
                                                                                                       14
les, una es privada y la otra es pública,                 dificultad para calcular logaritmos
que cualquiera puede tenerla. Este al-                    discretos en un cuerpo finito.
goritmo funciona así: el emisor utiliza la
clave pública del receptor y solamente
                                                  •       Funciones Hash criptográficas: las
                                                          funciones hash son algoritmos ma-
con la clave privada se puede descifrar                   temáticos que con una entrada X,
el mensaje, así solo el receptor puede ac-                genera una salida Y. El algoritmo ma-
ceder a la información. Pero si el emisor                 temático deberá cumplir una serie de
utiliza la clave privada para cifrar el men-              propiedades, como:
saje, este solo se puede descifrar con la
llave pública.                                        •     Cuando se tenga una función hash
                                                            específica, sin importar la longitud
Este tipo de algoritmos asimétricos son                     de la entrada X, la salida Y debe ser
más seguros que los simétricos. Algunas                     de un tamaño fijo.
desventajas de los algoritmos asimétri-
cos, es que toman mayor tiempo de pro-                •     Para cada X, Y tiene que ser única.
ceso que los simétricos, las claves son               •     La función hash deberá ser rápido
más grandes y el mensaje cifrado es mu-                     y sencillo de calcular
cho más grande que el original.                       •     No se devolverá de Y a X.
Algunos algoritmos asimétricos:                       •     No se presentarán colisiones. es
•   Rivest, Shamir y Adlema –RSA-: este                     decir que si se tienen dos X distin-
    algoritmo asimétrico fue elabora-                       tas, no se darán un mismo Y.
    do en 1977 por Rivest, Sharmir y              •       MD5: en 1995 fue creado este algo-
    Adleman, de ahí su nombre RSA. El                     ritmo por Ronald Rivest. Es un algo-
    funcionamiento del algoritmo es el                    ritmo de hash muy utilizado actual-
    siguiente, escoge dos números pri-                    mente. Se basa en dos algoritmos, el
    mos grandes que se escogen aleato-                    MD2 y el MD4. Es llamado de reduc-
    riamente y se mantienen en secreto.                   ción criptográfico de 128 bits. Usado
    La factorización de esos números pri-                 para comprobar que a algún software
    mos grandes, es la principal ventaja                  que se instale en el PC bajado de in-
    de este algoritmo en cuanto a segu-                   ternet no haya sido alterado por al-
    ridad. Es uno de los algoritmos más                   gún usuario que le haya agregado un
    seguros hasta la fecha.                               virus o troyano al instalador; el MD5
•   Diffie-Hellman: este protocolo de ci-                 indicará con seguridad si ese soft-
    frado asimétrico, recibe su nombre                    ware que se descargue de la red es el
    de los creadores Whitfield Diffie y                   oficial o ha sufrido cualquier cambio
    Martin Hellman. Fue el primer algo-                   y podría ser dañino para el sistema.
    ritmo de llave pública. Se denomina
    que es un algoritmo que intercambia        Criptografía de uso cotidiano
    claves entre partes. Empleado para         Por medio de la criptografía la información
    acordar claves simétricas, utilizadas      sensible de las personas puede ampararse,
    para cifrar una sesión. La dificultad      es el caso de: Los datos personales, Datos
    de este algoritmo se basa en la gran       Bancarios




                                                               Fundación Universitaria
                                                               Fundación Universitaria del
                                                                                       del Área
                                                                                           Área Andina
                                                                                                Andina   19
                                                                                                         15
La información puede protegerse en la crea-       ■ Cifrar el almacenamiento de datos: bases
ción, modificación, almacenamiento, proce-           de datos, dispositivos de almacenamien-
                                                     to, almacenamiento distribuido.
samiento y transmisión.
                                                  ■ Cifrar las comunicaciones: correo electró-
Para preservar la identidad de las personas          nico, redes inalámbricas, redes sociales,
                                                     mensajería instantánea, intercambio de
son indispensables los algoritmos cripto-            documentos, radio, televisión.
gráficos, de allí que deberán estar presentes
                                                  ■ Cifrar las investigaciones.
en nuestro diario vivir como en:
                                                  ■ Cifrar la información en el sector financiero.
■ El  comercio electrónico: como en las
                                                  ■ Cifrar diversos sectores: voto electrónico,
  compras en línea, en los dispositivos mó-          pasaporte, planes estratégicos, sector fi-
  viles, pagos con algún tipo de tarjeta dé-         nanciero, cajeros automáticos, investiga-
  bito o crédito, pago de impuestos.                 ciones.


             Algunos ejemplos con ejercicios sobre distintos ciframientos

             Ejemplo de cifrado de mensaje: Ana envía un mensaje a David




                           Imagen 1. Cifrado de un mensaje con clave pública.
         Fuente: https://es.wikipedia.org/wiki/Criptograf%C3%ADa_asim%C3%A9trica#/media/
                                     File:CriptografiaAsimetrica.png


1. Ana redacta un mensaje.
2. Ana cifra el mensaje con la clave pública de David.
3. Ana envía el mensaje cifrado a David a través de internet, ya sea por correo electrónico,
   mensajería instantánea o cualquier otro medio.
4. David recibe el mensaje cifrado y lo descifra con su clave privada.
5. David ya puede leer el mensaje original que le mandó Ana.




                                                               Fundación Universitaria
                                                               Fundación Universitaria del
                                                                                       del Área
                                                                                           Área Andina
                                                                                                Andina   20
                                                                                                         16
     Ejemplo de firma digital con clave asimétrica: David envía un mensaje a Ana




                             Imagen 2. Cifrado de un mensaje con clave privada
 Fuente: https://es.wikipedia.org/wiki/Criptograf%C3%ADa_asim%C3%A9trica#/media/File:Firma_Digital_
                                           Asim%C3%A9trica.png

1. David redacta un mensaje.
2. David firma digitalmente el mensaje con su clave privada.
3. David envía el mensaje firmado digitalmente a Ana a través de internet, ya sea por co-
   rreo electrónico, mensajería instantánea o cualquier otro medio.
4. Ana recibe el mensaje firmado digitalmente y comprueba su autenticidad usando la cla-
   ve pública de David.
5. Ana ya puede leer el mensaje con total seguridad de que ha sido David el remitente.

                               Ejemplo de una clave simétrica




                                Imagen 3. Cifrado con clave Simétrica.
                         Fuente: http://www.rinconastur.com/php/php19.php




                                                                 Fundación Universitaria
                                                                 Fundación Universitaria del
                                                                                         del Área
                                                                                             Área Andina
                                                                                                  Andina   21
                                                                                                           17
Ejemplo del cifrado César

Se tiene el texto Original: ABCDEFGHIJKLMNÑOPQRSTUVWXYZ, A este texto se le puede
aplicar un desplazamiento de posiciones hacia la derecha de siete espacios hacia la derecha,
entonces el texto cifrado será:

Texto cifrado: HIJKLMNÑOPQRSTUVWXYZABCDEFG.

Conociendo el texto original y su ciframiento, haga lo mismo con su nombre, de tal manera
que su nombre quede cifrado.




                                                           Fundación Universitaria
                                                           Fundación Universitaria del
                                                                                   del Área
                                                                                       Área Andina
                                                                                            Andina   22
                                                                                                     18
 1
UNIDAD



     1 Unidad 1




    Usos de la    Criptografía y mecanismos de
   criptografía            seguridad

                       Autor: Lucy Medina
Introducción   Desde tiempos remotos, los seres humanos han tratado de
               protegerse en todos los sentidos de los demás, en especial, el
               conocimiento, pues este lo utilizaban para crear mecanismos
               de defensa para salir victoriosos en las guerras. Surge a partir
               de allí la transformación del conocimiento en claves secretas
               representándolo a través de criptogramas. De ahí la impor-
               tancia de garantizar la protección de la información por me-
               dio de protocolos de ciframiento que limitan el acceso de la
               información.

               De otra parte, es importante que los estudiantes entiendan
               cómo establecer o confirmar la identificación de alguien a tra-
               vés de una red o de un sistema, para poder confirmar la pro-
               cedencia de quien se identifica y poder verificar su identidad.

               Es significativo que se entienda la importancia de mantener
               los datos libres de modificaciones no autorizadas y cómo con-
               trolar esta situación, pero también tener la información dis-
               ponible para cuando se requiera, más importante aún, es la
               irrefutabilidad, que consiste en que cuando un usuario mo-
               difique o utilice la información éste no pueda negar la acción
               realizada.

               En esta semana también se revisarán los protocolos de segu-
               ridad o criptográficos que permiten describir cómo debe uti-
               lizarse cada algoritmo para establecer claves, autenticar en-
               tidades, realizar cifrados, transportar datos de forma segura,
               entre otros.




                                             Fundación Universitaria del Área Andina   24
                                             Fundación Universitaria del Área Andina   3
U1            Metodología


     Una vez estudiada la unidad 1, en donde se aprendieron los conceptos básicos sobre cripto-
     grafía, en esta unidad se revisarán otros términos importantes para sustentar y tener como
     base para continuar con los siguientes conocimientos. Es importante que si no le ha queda-
     do claro algún concepto de la unidad1, se contacte con su tutor para pedir explicación, o de
     lo contrario, acudir a la cartilla de la unidad 1 y volver a repasar los conceptos.

     Recomendaciones:
     ■ Realizar las lecturas asignadas.
     ■ Elaborar cada uno de los trabajos asignados.
     ■ Realizar las evaluaciones propuestas.
     ■ Cuando no entienda algo, comuníquese con su tutor.
     ■ No continúe con el siguiente tema, hasta que esté perfectamente claro el tema actual.
     ■ Siempre que lea, hágalo entendiendo las ideas.




                                                                Fundación
                                                                Fundación Universitaria
                                                                          Universitaria del
                                                                                        del Área
                                                                                            Área Andina
                                                                                                 Andina   25
                                                                                                          4
U1            Desarrollo temático



     Usos de la criptografía                              La confidencialidad de los datos es justifica-
                                                          da porque se requiere en el ejercicio profe-
     La confidencialidad                                  sional, por ejemplo, de los médicos, de los
                                                          abogados, de los sacerdotes, etc.
     La información tiene una propiedad que la
     hace única y es la de garantizar que ésta sea        Un concepto importante que debe quedar
     accesible solamente por las personas inte-           claro es el significado que tiene la seguridad
     resadas para utilizar la información, pero en        de la información y la seguridad informática.
     términos simples:                                    Seguridad informática, hace referencia a la
                                                          seguridad de los medios como el hardware,
             Confidencialidad de la información           el software y por supuesto los datos. La se-
                                                          guridad de la información prevé y mantiene
                             =                            mecanismos para asegurar la integridad de
      Protección de datos entre un emisor y un receptor   la información.

     Para garantizar la confidencialidad de la in-        Son tres características importantes que
     formación, se utilizan los mecanismos de ci-         debe tener la información para que sea se-
     frados o protocolos con el fin de que la infor-      gura, estas son: la disponibilidad, la confi-
     mación permanezca segura, solo hasta que             dencialidad y la integridad, llamado el trián-
     a quien se le envía el mensaje lo descifre.          gulo de la seguridad de la información.

                                                                           Confidencialidad




                                                          Disponibilidad                        Integridad
               Imagen 1. La confidencialidad              Figura 1. Triángulo de la seguridad de la información
       Fuente: http://definicion.de/confidencialidad/                         Fuente: Propia.




                                                                        Fundación Universitaria del Área Andina   5
                                                                                                                  26
La confidencialidad es la característica que   Hoy en día se utilizan otras maneras de au-
se le da a la información para que esta per-   tenticación como son:
manezca en secreta tanto a personas como       a. Una contraseña, denominada, “por lo que
a sistemas que no tenga la autorización de-       el usuario sabe”.
bida, es decir, que dicha información solo
será conocida por las personas que tengan      b. Una tarjeta magnética, denominada, “por
autorización. Por ejemplo, si usted hace una      las huellas digitales”.
compra de un libro en el sitio Amazon.com,     c. Las huellas digitales, denominadas, “por
deberá pagar con su tarjeta de crédito, ¿qué      lo que uno es”.
sería si al transmitir los datos se produce
una violación de la confidencialidad de sus    Entre más métodos se utilicen para la au-
datos? A esto es lo que se llama pérdida de    tenticación, más segura será ésta, pues todo
la confidencialidad.                           dependerá del grado de importancia de lo
                                               que se quiera proteger.
La integridad, hace referencia a que los da-
tos no sean modificados por personal no        Comúnmente se utiliza la contraseña para
autorizado, es decir, que la información se    autenticarse en un sistema, pero esta debe-
mantenga intacta todo el tiempo, que no        rá ser lo más segura posible, esto quiere de-
sea manipulada o alterada por personas o       cir, que dependiendo de las características
sistemas que no estén autorizados.             de la contraseña será mejor o peor. Para que
                                               una contraseña sea segura, deberá ser larga
Se presenta este fenómeno de violar la in-     y compleja, de esta forma no será violada
tegridad de la información, por ejemplo,       ni descifrada tan fácilmente, por ejemplo,
cuando con intención o sin ella, se modifi-    utilizar letras mayúsculas, minúsculas, nú-
can o borran los datos. Para que haya inte-    meros, caracteres especiales; el problema
gridad de la información cuando se envía       radica, en que no es fácil recordar una clave
un mensaje, se utiliza por ejemplo la firma    de esta magnitud, entonces se procede a
digital, así se hace más seguro el mensaje.    tener como clave, el nombre del familiar, la
                                               mascota, el año de nacimiento de un allega-
La disponibilidad, hace referencia a que la    do, y más aún, en las oficinas, escriben las
información se encuentre a disposición de      contraseñas y las dejan debajo del teclado o
quien la necesite, pero que cuente con la      la pegan en la pantalla del PC.
autorización.
                                               Verificaciones de integridad
Autenticación
                                               Cuando se verifica la integridad de la in-
El mecanismo de seguridad llamado auten-       formación, es porque se han establecidos
ticación, es aquel que verifica la identidad   procedimientos para evitar o controlar que
de un usuario cuando entra al sistema, la      la información almacenada en archivos, su-
red o hace ingreso a una base de datos. Ge-    fran cambios que no han sido autorizados
neralmente los usuarios acceden al sistema     y que los paquetes o información enviada
por medio de la contraseña y un nombre de      desde el emisor, llegue a su destino sin ser
usuario.                                       alterada.




                                                           Fundación
                                                           Fundación Universitaria
                                                                     Universitaria del
                                                                                   del Área
                                                                                       Área Andina
                                                                                            Andina   27
                                                                                                     6
La integridad de los datos hace referencia        dificado, lo que quiere decir, que se verifica
a la corrección y complemento de los datos        la integridad del mensaje enviado; mientras
en las bases de datos. Las instrucciones más      que los códigos de autenticación de mensa-
utilizadas al ingresar a una base de datos        jes, tienen por objetivo autenticar el origen
como el “insert, update o delete”, pueden         del mensaje.
modificar el almacenamiento que se tiene,
es decir los datos pierden su integridad, por     Mecanismos de no repudio
cuanto se le puede añadir datos que no son        El repudio hace referencia a que ni el emisor
válidos a la base de datos.                       ni el receptor nieguen que han participado
                                                  en una comunicación.
Generalmente se utilizan algunas técnicas
para controlar o mantener la integridad de        En toda comunicación participan dos tipos de actores, de
los datos, por ejemplo, los antivirus, la en-     una parte el emisor (el que envía un mensaje) y de otra el
cripción y las llamadas funciones hash.           receptor (el que recibe el mensaje). Entonces, el repudio
                                                  puede clasificarse en            dos tipos:
Los antivirus proporcionan seguridad a la
información siempre y cuando se actualicen        No repudio de ori-
con frecuencia. Cabe recordar que no todos        gen: en donde se
los antivirus reconocen todos los virus.          garantiza que el
                                                  emisor no po-
La encripción hace referencia a la codifica-      drá negar que
                                                  es quien envía el
ción de la información que se va a transmitir
                                                  mensaje, pues el recep-
por una red, con el objeto de hacerla más         tor, tendrá las pruebas.
segura y que en caso de ser interceptada no
se pueda entender, solo será descifrada por             Imagen 2. No repudio
                                                       Fuente: http://www.net753.com.ar/seguridad_it.html
la persona a quien va dirigido el mensaje.
Estos procesos de cifrar y descifrar, se hace     No repudio en destino: en donde el receptor no podrá ne-
por medio de software especializado.              gar que ha recibido un mensaje, pues el emisor poseerá la
                                                  prueba de que si recibió el mensaje.
Las funciones hash, son utilizadas en la crip-
tografía para dar mayor seguridad a la infor-
                                                  Cuando se hacen negocios por Internet es
mación que viaja por medio de la red. El he-
                                                  importante el uso de este servicio, pues
cho de venir cifrado un mensaje por medio
                                                  emisor y receptor incrementarán su con-
de estas funciones hash, lo hace resistente a
                                                  fianza en las transacciones comerciales que
los posibles ataques.
                                                  realicen, pero para poder lograrlo, deben
Existen dos tipos de funciones hash. De una       utilizar algunos mecanismos que les permi-
parte, los códigos de detección de modi-          te la confianza mutua:
ficaciones y por el otro, los códigos de au-      ■ Autenticación:    acción que reconoce al
tenticación de mensajes. Los códigos de              emisor de quien envía el mensaje, es de-
detección de modificaciones, son aquellos            cir a quien envía un documento o en su
que tienen como objetivo principal la verifi-        defecto la máquina que se comunica con
cación de la integridad de los datos, es decir,      otra a través de la red para solicitar algún
detectar que el mensaje no haya sido mo-             servicio.




                                                                 Fundación Universitaria del Área Andina       7
                                                                                                               28
■ Autorización: acción que ejecuta el con-       lizar comunicaciones seguras entre una
  trol del acceso de los usuarios a sitios       máquina de un usuario y los servidores
  restringidos, a máquinas diferentes o a        internet, como por ejemplo, las páginas
  servicios, luego de haberse autenticado.       web de los bancos.
■ Auditoría: acción que hace la verificación   ■ Leyes dirigidas a la protección de datos
  del correcto funcionamiento de las polí-       personales: que permiten asegurar de
  ticas, de la seguridad que se han tomado       forma obligatoria la confidencialidad de
  en la comunicación.                            la información de las personas que alber-
                                                 gan en sus bases de datos.
■ Encriptación: acción que permite ocultar
  la información que se transmite por me-      Estos servicios denominados de no repudio
  dio de la red o que se haya almacenado       permite al emisor tener pruebas de que la
  en los equipos, con el objeto de que ter-    información ha sido entregada al receptor;
  ceros no autorizados, no puedan acceder      de la misma manera el receptor tendrá las
  a la información sin tener los algoritmos    pruebas del origen de los datos recibidos.
  y clave desciframiento.                      En ambos casos, tanto receptor como emi-
■ Realización de copias de seguridad e         sor no pueden negar que son los autores del
  imágenes de respaldo: acción que per-        mensaje o de su recepción.
  mite recuperar la información en caso de
                                               Un ejemplo concreto del servicio de no re-
  fallo.
                                               pudio es el correo electrónico, cuando se
■ Antivirus:
           acción que permite proteger         escriben las direcciones electrónicas del re-
  las máquinas y los datos de virus infor-     ceptor del correo y por ende el correo cuan-
  máticos.                                     do es recibido por el recepto sabe quién lo
■ Cortafuegos – firewall: se refiere a pro-    ha enviado.
  gramas auditores para evitar conexiones
  no deseadas en los dos sentidos, desde la
  red a equipos o desde éstos hacia la red.
■ Servidores proxy: son equipos de hard-
  ware con software especializado conec-
  tados posiblemente en la red interna de
  una empresa y una red externa, con el        Imagen 3. Envío de mensajes para el servicio de No
  objeto de auditar y autorizar los accesos                         repudio
  de usuarios a diferentes servicios como       Fuente: http://www.webmarketingid.com/tijuana/
  el FTP (transferencia de archivos), o el                   img/mail-marketing.jpg
  web (acceso a páginas en internet).
■ Uso de la firma electrónica o certificado    Otros usos o aplicaciones
  digital: elemento que permite garantizar     Para poder proteger la información se debe
  la identidad de un usuario o máquina         hacer desde que se crea, se modifique, se
  evitando el no repudio en la comunica-       almacene, se procese o transmita, pues la
  ción o en firma de documentos privados.      información siempre deberá tener las tres
  Se usan actualmente también para rea-        características importantes para hacerla se-




                                                            Fundación
                                                            Fundación Universitaria
                                                                      Universitaria del
                                                                                    del Área
                                                                                        Área Andina
                                                                                             Andina   29
                                                                                                      8
gura como son: La confidencialidad, la inte-      ■ Cifrado de almacenamiento: bases de
gridad y la disponibilidad.                         datos, dispositivos de almacenamiento,
                                                    almacenamiento distribuido.
En nuestra vida diaria, los procesos cripto-
gráficos son propios de la identidad de los       ■ Cifrado de comunicaciones: correo elec-
seres humanos que utilicen medios de co-            trónico, redes inalámbricas, redes socia-
municación, por ello, casi todos los utiliza-       les, mensajería instantánea, intercambio
mos en nuestro diario vivir, por ejemplo:           de documentos, radio-tv.




                                                          Imagen 6. Cifrado de investigaciones
                                                     Fuente: http://mijobrands.com/ideas/2012/02/
                                                   investigaciones-de-mercado-en-linea-consejos-y-
          Imagen 4. Comercio electrónico                             herramientas/
Fuente: http://www.mordovmedia.ru/media/news/3
 8276/53b27957148565a87c4669cb73120a79.jpg        ■ Cifrado de investigaciones: empresas de-
                                                    dicadas a la investigación cifran su infor-
■ En el comercio electrónico: compra de li-         mación para tenerla más segura o inves-
  bros u otros elementos por la red, pagos          tigadores que quieren tener sus secretos
  con tarjetas de crédito o débito, pago de         profesionales solo para ellos, mientras se
  impuestos, uso de dispositivos móviles.           les expide las patentes correspondientes.
                                                  ■ Cifrado  en el sector financiero: pagos
                                                    electrónicos con tarjetas crédito o debi-
                                                    do, cualquier transacción bancaria: ver
                                                    saldos, consignaciones, retiros, etc.
                                                  ■ Cifrado en sectores varios: votar electró-
                                                    nicamente, el pasaporte, los planes estra-
                                                    tégicos.

                                                  Protocolos criptográficos
                                                  Los cifrados criptográficos o de cifrados, son
                                                  protocolos de seguridad que permite a tra-
          Imagen 5. Comercio electrónico          vés de métodos criptográficos, prestar la se-
 Fuente: http://vantaivanchuyen.com/wp-content/   guridad necesaria para la información que
           uploads/2016/02/amazzon.jpg            se está enviando por la red.




                                                               Fundación
                                                               Fundación Universitaria
                                                                         Universitaria del
                                                                                       del Área
                                                                                           Área Andina   30
                                                                                                Andina   9
La principal tarea de un protocolo cripto-               •   El protocolo MTI/A0, 4 empleando
gráfico es la de indicar cómo se debe utili-                 dos mensajes y sin requerir firmas,
zar un algoritmo, describe sus estructuras                   proporciona claves de sesión varia-
de datos, representaciones e inclusive en                    bles en el tiempo con mutua auten-
dónde debe utilizarse para poder imple-                      ticación implícita de claves contra
mentar versiones interopeables de un pro-                    ataques pasivos.
grama.
                                                         •   El protocolo STS5 es una variante de
Los protocolos criptográficos se utilizan                    tres pasos de la versión básica que
para enviar datos de forma segura. Cuando                    permite el establecimiento de una
se utilizan estos protocolos deben incluir                   clave secreta compartida entre dos
por lo menos, los siguientes elementos:                      partes con mutua autenticación de
                                                             entidades y mutua autenticación ex-
■ Establecer claves.                                         plícita de las claves. El protocolo tam-
■ Autenticar entidades.                                      bién facilita el anonimato: las iden-
■ Permitir cifrado simétrico y autenticacio-                 tidades de A y B pueden protegerse
                                                             contra el adversario E. El método em-
    nes de mensajes.
                                                             plea firmas digitales.
■ Transportar datos seguros en el nivel de            5. Protocolos de autenticación:
    aplicación.
■ Soportar Métodos de no repudio.                        •   Kerberos: es uno de los protocolos
                                                             más utilizados en entornos internet.
Algunos protocolos criptográficos1:                          Identifica usuarios, los cuales están
                                                             registrados en una gran base de da-
■ TransportLayer Security (TLS) es un pro-                   tos encriptada, que no puede ser
    tocolo criptográfico usado en conexio-
                                                             leída fuera del sistema. Cuando un
    nes web (HTTP) seguras.
                                                             sistema se comunica con un usuario,
4. Protocolo de establecimiento de claves:                   solo lo hace con el protocolo.
    •   Protocolo de Diffie-Hellman (estable-            •   Radius: este protocolo autentica
        ce de claves entre partes que no han                 usuarios y es uno de los más anti-
        tenido contacto previo, utilizando un                guos. El protocolo ejecuta un soft-
        canal inseguro, y de manera anónima                  ware en el servidor, de tal manera
        (no autentificada).                                  que cuando un usuario se conecta a
    •   ElGamal de negociación de claves                     la red, un cliente Radius lleva los da-
        provee negociación en un solo paso                   tos del usuario al servidor Radius de
        y autenticación unilateral (del recep-               manera encriptada para que este los
        tor hacia el emisor) si la clave pública             autentique, entonces, el servidor ad-
        del receptor es conocida de antema-                  mite o rechaza al usuario entregando
        no por el emisor.                                    la respuesta al programa cliente de
                                                             Radius.

1         Protocolo de establecimiento de claves.
                                                         •   Tacacs+: es otro protocolo de auten-
Fuente: https://es.wikipedia.org/wiki/Protocolo_de_          ticación, muy similar a Radius, a dife-
establecimiento_de_claves                                    rencia de Radius, este protocolo en-




                                                                  Fundación Universitaria
                                                                  Fundación Universitaria del
                                                                                          del Área
                                                                                              Área Andina
                                                                                                   Andina   31
                                                                                                            10
       cripta completamente los parámetros       5. Pruebas de conocimiento cero: permiten
       utilizados en todo el proceso de au-         a un individuo convencer a otro de que
       tenticación, este protocolo también          posee una cierta información, sin revelar-
       encripta el nombre del usuario y algu-       le nada sobre el contenido de la misma.
       nos otros datos adscritos, a diferencia   6. Transacciones electrónicas seguras: per-
       de Radius que solamente encripta la          miten realizar de manera electrónica se-
       contraseña. Otra diferencia es que Ta-       gura las operaciones bancarias habitua-
       cacs+ es un protocolo de autentica-          les, firma electrónica de contratos, etc.
       ción escalable, mientras que Radius
       es de autenticación independiente.        7. Compromiso de bit: permiten a una par-
       Generalmente se utiliza Tacacs+ con          te A comprometerse con una elección
       Kerberos cuando las autenticaciones          (un bit o más generalmente una serie
       deberán ser muy fuertes.                     de bits) sin revelar tal elección hasta un
                                                    momento posterior. El protocolo garan-
Otra clasificación la hace, quien indica que        tiza a otra parte B que A no cambia su
los protocolos criptográficos se dividen en:        elección.
1. Protocolos de autentificación de usua-        8. Transferencias transcordadas: permiten
   rio: permiten garantizar que el remiten-         a una parte A enviar a otra B un men-
   te de un mensaje o el usuario con el que         saje o secreto entre dos posibles. Al no
   establecemos comunicación es real-               conocer cuál de los dos ha recibido real-
   mente quién pretende ser.                        mente B.
2. Protocolos de autentificación del men-        9. Elecciones electrónicas: permiten rea-
   saje: garantizan que el mensaje enviado          lizar un proceso electoral electrónica-
   no ha sido substituido por otro ni altera-       mente, garantizando la deseable priva-
   do (integridad del mensaje).                     cidad de cada votante y la imposibilidad
3. Distribución de claves: un problema im-          de fraude.
   portante en criptografía de clave priva-      10. Jugar al poker por internet: posibilita
   da es el de la creación y transporte de           a dos personas, físicamente separadas,
   las claves a utilizar por cada par de usua-       mantener una partida de poker (o simi-
   rios. En cuanto a las claves de un sistema        lar: cara o cruz, chinos, etc.), comunicán-
   de clave pública, la problemática de su           dose por correo electrónico, teléfono,
   distribución es distinta (no es necesario         etc., garantizando la imposibilidad de
   el secreto), demandando protocolos es-            hacer trampa (Tena Ayuso, Juan. 2013).
   pecíficos.
4. Protocolos para compartir secretos: su        Nociones preliminares al uso de algorit-
   objetivo es distribuir un cierto secreto      mos criptográficos
   (por ejemplo la clave para abrir una caja     El cifrado es el acto por el cual un mensaje
   fuerte), entre un conjunto P de partici-      se encripta y desencripta, estos algoritmos
   pantes, de forma que ciertos subcon-          se basan en el uso de llaves o claves, es así
   juntos prefijados de P puedan, uniendo        que los mensajes solo podrán ser desencrip-
   sus participaciones, recuperar dicho se-      tados si la clave usada coincide con la que
   creto.                                        fue usada para encriptar el mensaje.




                                                             Fundación Universitaria
                                                             Fundación Universitaria del
                                                                                     del Área
                                                                                         Área Andina
                                                                                              Andina   32
                                                                                                       11
En la siguiente figura, se aprecia los principales algoritmos utilizados para encriptar informa-
ción basados en llaves.

                                                           Criptología

                               Criptografía                                            Criptoanálisis


                    Clásica                      Moderna




                   Simétrica                  Asimétrica


                                                           Figura 2. Algoritmos criptográficos
     Bloques                      Flujos                                      Fuente: Propia.


Los algoritmos para encriptar información           Una característica importante de los algorit-
basados en claves, son los algoritmos simé-         mos simétricos y asimétricos, es que son más
tricos y los asimétricos, los primeros basados      rápidos los simétricos que los asimétricos
en llaves primarias y los segundos basados          para ser ejecutados por las computadoras.
en llaves públicas. Los algoritmos simétricos
se diferencian de los asimétricos porque uti-       También existe la encriptación híbrida, que
lizan la misma clave para encriptar y desen-        consiste en que un algoritmo de llave públi-
criptar información y los algoritmos asimé-         ca utiliza para encriptar una llave randómi-
tricos tienen llaves diferentes para encriptar      ca (generada al azar) y esta llave se utiliza
y dencriptar y las llaves no podrán derivarse       para encriptar datos utilizando el algoritmo
a partir de otra.                                   simétrico. Este algoritmo genera una llave
                                                    pública y otra privada en el receptor, cifra el
Los algoritmos simétricos se dividen en ci-         archivo de forma sincrónica, el receptor en-
frado de flujo y de bloques. El primero en-         vía la clave pública al emisor, se cifra la clave
cripta los mensajes bit a bit y el de bloques       que se utilizó para encriptar el archivo con la
lo hace por medio de bloques de bits, gene-         llave pública del receptor, luego se envía el
ralmente lo hace con 64 bits, y lo encripta         archivo cifrado y la clave del archivo cifrada.
como una unidad simple. De otra parte, el
cifrado asimétrico o de clave pública, tienen       En síntesis, el cifrado híbrido utiliza cifrado
como llave para encriptar una llave pública,        simétrico y asimétrico, utiliza para ello una
esto hace que cualquier usuario encripte            clave pública para compartir la clave para el
datos con dicha llave, pero a quien se le di-       cifrado simétrico. El mensaje será enviado
rige el mensaje deberá tener la llave privada       con ciframiento que utiliza la clave. Como
para poderlo desencriptar.                          no es seguro utilizar la clave simétrica, en-




                                                                  Fundación Universitaria del Área Andina   12
                                                                                                            33
tonces, para cada envío se usa una clave dis-   debido a la capacidad de cómputo de las
tinta.                                          computadoras actuales, ya no se considera
                                                seguro, por lo que ha sido reemplazado des-
El algoritmo más popular que pertenece          de el año 2000, por el Estándar Avanzado de
al algoritmo de cifrado simétrico es el Es-     Encriptación-AES, que hasta ahora es el al-
tándar de Encriptación de Datos-DES, pero       goritmo simétrico más usado.




                                                           Fundación Universitaria
                                                           Fundación Universitaria del
                                                                                   del Área
                                                                                       Área Andina
                                                                                            Andina   34
                                                                                                     13
 1
UNIDAD


     2 Unidad 2




  Herramientas
  de Desarrollo        Criptografía y
   Disponibles    mecanismos de seguridad

                      Autor: Lucy Medina
Introducción   Luego de tener claro lo que significa proteger la información,
               se requiere aprender cuáles herramientas pueden utilizarse
               para desarrollar algoritmos criptográficos propios en los dife-
               rentes entornos de desarrollo.

               Los framework son herramientas de gran utilidad, por cuanto
               ayudan al desarrollador de proyectos para agilizar su tarea,
               trabajar sobre una base estructural unificada, facilitan la esca-
               labilidad y el mantenimiento del código.

               Para lograr lo anterior, pueden revisarse entornos como los
               que ofrecen el software libre como es Netbeans, o el fra-
               mework de Microsoft - NET que hace énfasis en la transparen-
               cia de redes, con independencia de plataforma de hardware y
               que permita un rápido desarrollo de aplicaciones.

               También conviene revisar las herramientas de desarrollo que
               ofrece PHP para realizar desarrollos criptográficos como es el
               Laravel o el Yii, entre otros. Pero aún más importante, es cono-
               cer algunas herramientas que ofrecen proteger los datos en la
               base de datos, pues allí es en donde se almacena la informa-
               ción de vital importancia para una empresa o negocio.

               Por todo lo anterior, se expone en esta cartilla algunos ele-
               mentos que se deben tener en cuenta para que a la hora de
               realizar un desarrollo con alguna de las herramientas citas en
               párrafos anteriores, puedan escoger la más adecuada, depen-
               diendo del objetivo del trabajo.




                                              Fundación Universitaria del Área Andina   3
                                                                                        36
U2            Metodología


     En este capítulo del módulo, se revisarán algunas de las herramientas para hacer desarrollos
     criptográficos en algunos de los entornos más utilizados.

     Se trabajarán entornos de desarrollo como los que ofrece Java, .NET, PHP y por supuesto los
     más utilizados para las bases de datos.

     Algunas de las recomendaciones a las que ha de poner más énfasis es a aprender algunas de
     las técnicas y consejos para elaborar código seguro que por ende llevará a que las empresas
     tengan más confianza en sus aplicaciones hechas a la medida.

     Elabore el taller propuesto en el módulo y realice cada una de las actividades sugeridas en el
     orden indicado para comprender mejor la temática.

     Recomendaciones puntuales:
     ■ Realizar las lecturas asignadas.
     ■ Elaborar cada uno de los trabajos asignados.
     ■ Realizar el taller propuesto.
     ■ Cuando no entienda algo, comuníquese con su tutor.
     ■ No continúe con el siguiente tema, hasta que esté perfectamente claro el tema actual.
     ■ Siempre que lea, hágalo entendiendo las ideas.




                                                                  Fundación
                                                                  Fundación Universitaria
                                                                            Universitaria del
                                                                                          del Área
                                                                                              Área Andina   37
                                                                                                   Andina   4
U2            Desarrollo temático




     Herramientas de desarrollo criptográficas para entornos Java
     Las herramientas de desarrollo o también llamadas ambientes de desarrollo integrado o en-
     tornos de desarrollo interactivo - IDE- son aplicaciones informáticas que facilitan el trabajo
     al desarrollador de aplicaciones por medio de servicios integrales. Estos entornos tienen
     facilidades como los editores de código fuente, herramientas de construcción automática
     y depuradores; además, poseen facilidades para autocompletar código o compiladores e
     intérpretes.

     Los entornos de desarrollo más comunes que existen para Java son el Netbeans y Eclipse.

     Entorno de desarrollo Netbeans
     El entorno de desarrollo Netbeans, está escrito en java y en él se puede compilar cualquier
     tipo de aplicación. Tiene soporte para JavaScript, mejora el desempeño en la programación,
     tiene soporte para MySQL para poder acceder a las bases de datos, también tiene soporte en
     Java Beans, al igual que para Ruby/JRuby.

     El entorno de desarrollo Netbeans, se aprecia en la imagen 1, en él se encuentra hacia el
     lado izquierdo, el árbol de las de los proyectos que se desarrollan, se listan con cada uno de
     sus paquetes y clases. También se encuentran los Servicios que ofrece la herramienta como
     son: las bases de datos, los servicios Web y las tareas. De otra parte, se ve una pestaña para
     presentar cada uno de los archivos desarrolladores, estos, los presenta Netbeans como un
     árbol de carpetas y subcarpetas. En la parte izquierda inferior izquierda, se encuentra el Na-
     vegador, el cual mostrará elementos utilizados en cada uno de los proyectos.

     En la parte superior derecha se pueden visualizar las aplicaciones que se estén desarrollan-
     do, tiene la opción de verlas todas, así como la que esté activa.




                                                                  Fundación Universitaria del Área Andina   5
                                                                                                            38
                                                                                         Aplicaciones
            Proyectos




                        Navegador

                                    Imagen 1. Entorno de desarrollo Netbeans
                                                 Fuente: Propia.
En la siguiente imagen, se puede apreciar cómo se puede empezar a desarrollar un proyecto.
En primer lugar, deberá escoger la opción de File- New Project. Se generará la ventana que
aparece en la imagen 2, en donde deberá oprimir el botón Next para poder escribir el nom-
bre del proyecto, que en este caso se llamará “cifrado”.




                                    Imagen 2. Un nuevo proyecto en Netbeans
                                                 Fuente: Propia.




                                                                       Fundación
                                                                       Fundación Universitaria
                                                                                 Universitaria del
                                                                                               del Área
                                                                                                   Área Andina
                                                                                                        Andina   39
                                                                                                                 6
        Imagen 3. Un programa escrito en lenguaje Java, sobre Netbeans, usando el cifrado César
                                           Fuente: Propia.


Entorno de desarrollo Eclipse
De otra parte, el IDE Eclipse, permite trabajar múltiples lenguajes y ambos Eclipse y Net-
beans, tienen plugins para C, C++, Ada, Perl, Python, Ruby y PHP.

El entorno de desarrollo Eclipse es un software de código abierto, es multiplataforma y per-
mite trabajar aplicaciones de cliente llamas enriquecidas, a diferencia de las llamadas de
cliente liviano, que se trabajan en los navegadores. Acepta entornos de desarrollo como son
el Java Development Toolkit (JDT) y el compilador (ECJ).

En Eclipse se pueden compilar programas como C, C++, Python, LaTeX, JSP, Perl, Java, PHP,
JavaScript, así como aplicaciones en red como Telnet y también sistemas de gestión de ba-
ses de datos.

Una característica importe de Eclipse es que puede utilizar GEF (Graphic Editing Framework),
un Framework para la edición gráfica, como editores de diagramas como el UML, interfaces
gráficas, entre otros.

Para iniciar un proyecto en Eclipse, basta con escoger la opción File (ver imagen 4.), luego
New y escoger Java Project, como proyecto nuevo. En seguida se escribe el nombre del
proyecto, que para este caso es “Proyecto 1” (ver imagen 5.) y como se observa en la imagen
no se cambia ninguna opción de las que se encuentran marcadas por defecto, se oprime el
botón Finish.




                                                                   Fundación
                                                                   Fundación Universitaria
                                                                             Universitaria del
                                                                                           del Área
                                                                                               Área Andina   40
                                                                                                    Andina   7
A continuación, en la imagen 6, puede observarse cómo se ve el “proyecto 1” acabado de
crear. Como todo proyecto requiere de una clase para poder programar, se escoge también
de la opción File-New-Class.




                          Imagen 4. Creando un proyecto en Eclipse
                                       Fuente: Propia.




                         Imagen 5. Nombre de un proyecto en Eclipse
                                      Fuente: Propia.




                                                             Fundación
                                                             Fundación Universitaria
                                                                       Universitaria del
                                                                                     del Área
                                                                                         Área Andina
                                                                                              Andina   41
                                                                                                       8
                                 Imagen 6. Proyecto creado
                                      Fuente: Propia.




Imagen 7. Creando una clase en Eclipse                Imagen 8. Darle nombre a la clase creada
            Fuente: Propia.                                       Fuente: Propia.




                                                             Fundación
                                                             Fundación Universitaria
                                                                       Universitaria del
                                                                                     del Área
                                                                                         Área Andina
                                                                                              Andina   42
                                                                                                       9
En la imagen 8, se muestra cómo se le da nombre a la clase, llamada “Clase 1”, que pertene-
cerá al “Proyecto 1”. Esta clase se crea, debido a que dentro de ella es en donde se escribe el
código lenguaje, que en este caso es Java.




                Imagen 9. Codificación de un programa en Java en el Framework Eclipse
                                            Fuente: Propia.

En la imagen 9, se observa cómo puede empezarse a escribir una aplicación en java, estas
aplicaciones pueden ser cifrados, descifrados, programas para establecer seguridad de al-
gún sistema, programas a la medida, etc.

Herramientas de desarrollo criptográficas para entornos .NET
Visual Studio ofrece herramientas para desarrollos web, móviles y en la nube, también se
pueden compilar aplicaciones para Windows, Android e IOs. Sobre estas herramientas pue-
den compilarse programas escritos en C·, C++, JavaScript, Python, TypeScript, Visual Basic,
F#, entre otros. También permiten trabajar extensiones PHP y la elaboración de juegos.

Entre los lenguajes de .NET Framework que utilizan para desarrollar las aplicaciones, se en-
cuentran: Visual Basic, C#, Visual C, Visual F#, JScript, Visual C++ en Microsoft, admite Servi-
cios Web XML, al igual que AML un lenguaje de marcado para la programación declarativa
de aplicaciones. También trabaja con ASP.NET que se fundamenta en las clases de progra-
mación de .NET Framework y entrega un modelo de aplicaciones web, al igual que un con-
junto de controles, una infraestructura que hacen que la compilación de aplicaciones web
resulte más sencilla.

También permite trabajar sobre Microsoft Ajax, que anexa una serie de bibliotecas de scripts
de cliente que incorporan tecnologías entre exploradores ECMAScript (JavaScript) y HTML
dinámico (DHTML). Las librerías de “Microsoft Ajax Library”, se utilizan para compilar aplica-
ciones Ajax puras. También, también puede utilizar Ajax Library al compilar formularios Web
Forms de ASP.NET o aplicaciones de ASP.NET MVC.




                                                                  Fundación Universitaria
                                                                  Fundación Universitaria del
                                                                                          del Área
                                                                                              Área Andina
                                                                                                   Andina   43
                                                                                                            10
                 Imagen 10. Ingreso a Microsoft Visual Studio
Fuente: http://www.csharpya.com.ar/detalleconcepto.php?codigo=126&inicio=




                    Imagen 11. Creación de un proyecto
Fuente: http://www.csharpya.com.ar/detalleconcepto.php?codigo=126&inicio=




                                                   Fundación Universitaria
                                                   Fundación Universitaria del
                                                                           del Área
                                                                               Área Andina
                                                                                    Andina   44
                                                                                             11
En la imagen anterior, se observa cómo se crea un proyecto en Microsoft Visual Studio. Para
ello, se selecciona el menú “Archivo”, se escoge la opción “Nuevo” y escoge la opción “Pro-
yecto”.




                            Imagen 12. Escoger tipo de aplicación a crear.
            Fuente: http://www.csharpya.com.ar/detalleconcepto.php?codigo=126&inicio=

En la imagen anterior se visualiza cómo se escoge el lenguaje en que se va a desarrollar,
en este caso es Visual C#, se escoge el sistema operativo en el cual se trabajará, como es el
Windows y a continuación se escoge el tipo de aplicación que se va a realizar, como ejemplo,
se toma una “Aplicación de consola”, en la parte inferior de la gráfica, Nombre, se escribe el
nombre que se le dará a la aplicación, la ubicación en la cual se almacenará el programa, así
como el nombre de la solución, que generalmente se le da el mismo nombre de la aplicación.




                 Imagen 13. Esqueleto automático para empezar a escribir el código
            Fuente: http://www.csharpya.com.ar/detalleconcepto.php?codigo=126&inicio=




                                                                Fundación Universitaria
                                                                Fundación Universitaria del
                                                                                        del Área
                                                                                            Área Andina
                                                                                                 Andina   45
                                                                                                          12
En la imagen anterior, se observa el entorno que se generó automáticamente, como es el
esqueleto del programa.

Por último, luego de programar lo que se requiere y guardar la aplicación desarrollada, se
cierra el entorno, como se observa en la imagen 14.




                                  Imagen 14. Cerrando el proyecto
            Fuente: http://www.csharpya.com.ar/detalleconcepto.php?codigo=126&inicio=


Para cerrar el proyecto se escoge el menú “Archivo” y se escoge la opción “Cerrar solución”.

Herramientas de desarrollo criptográficas para entornos PHP
PHP es un lenguaje multiplataforma, que trabaja del lado del servidor, orientado al desa-
rrollo de aplicaciones dinámicas y acceso a información en PHP, orientado a trabajos con
objetos, en él se pueden desarrollar cualquier tipo de aplicaciones.

Como entornos de desarrollo o IDE para PHP, puede utilizarse los ya nombrados en nume-
rales anteriores como son Netbeans o Eclipse, pero además, se puede utilizar alguno de los
siguientes:
a. CodeIgniter. Utilizada para desarrolladores web.
b. CakePHP: en esta herramienta se elabora cualquier tipo de aplicaciones.
c. Symfony: usada por desarrolladores para hacer aplicaciones web complejas y escala cual-
   quier aplicación realizada en una versión antigua de PHP.
d. Prado: herramienta usada para desarrollar aplicaciones web php5 y utiliza la programa-
   ción orientada a objetos.




                                                               Fundación Universitaria del Área Andina   13
                                                                                                         46
e. Qcodo: utilizada para trabajar con programación orientada a objetos completamente.
f. php.MVC: herramienta que utiliza el diseño modelo-vista-controlador-MVC- sirve para
   hacer aplicaciones web.

Zend Studio. Es un Integrated Development Environment -IDE - muy utilizado, es de código
abierto, basado en eclipse e independiente de la plataforma para desarrollar proyectos. En
la siguiente imagen 15 se aprecia el IDE Zend Studio.




                              Imagen 15. Entorno de Zend Studio
                           Fuente: http://www.tufuncion.com/ide-php
De las plataformas más completas se encuentra Eclipse, es de código abierto e independien-
te, para PHP se utiliza la herramienta PHP Development Tools, en la imagen 16, puede verse
las facilidades que permite dicho entorno.




                           Imagen 16. Entorno PHP Development Tools
                           Fuente: http://www.tufuncion.com/ide-php




                                                              Fundación Universitaria
                                                              Fundación Universitaria del
                                                                                      del Área
                                                                                          Área Andina
                                                                                               Andina   47
                                                                                                        14
Otras herramientas que pueden servir para desarrollar en PHP: BlueShoes , Solar, Limb, Ko-
hana, Phocoa, zajax, AjaxAC, Zoop, Seagull, Stratos, evoCore, Maintainable, Akelos y Zend
Framework, entre otros.

Por último, un pequeño ejemplo del famoso saludo “Hola mundo, escrito en PHP.



                          <!DOCTYPE html>
                          <html lang=”es”>
                           <head>
                             <meta charset=”UTF-8” />
                             <title> Priemr ejemplo en PHP</title>
                           </head>
                           <body>
                             <?php
                               echo ‘Hola mundo’;
                             ?>
                           </body>
                          </html>



Herramientas de desarrollo criptográficas en bases de datos
Son varias las herramientas en las que se pueden desarrollar aplicaciones criptográficas y
utilizar bases de datos. Algunas de ellas:

En PHP: se utiliza la base de datos MySQL y phpMyAdmin o también HeidiSQL, que es una
herramienta sencilla, potente, no pesada y sobre todo libre. Otros entornos de desarrollo,
Apache, Xampp, Wamp, Mamp, EasyPHP.

Como se nota, PHP tiene una gran capacidad de conexión con la mayoría de motores de
base de datos actuales, pero es de destacarse la conectividad con MySQL y PostgreSQL.

Actualmente PHP soporte la conexión con servidores de bases de datos SQL como NoSQL,
entre otros, Oracle, ODBC, DB2, Microsoft SQL Server, Firebird, SQLite o MongoDB.

De otra parte, existen muchos IDE de múltiples lenguajes tales como Eclipse, ActiveState
Komodo, IntelliJ IDEA, MyEclipse, Oracle JDeveloper, NetBeans, Codenvy y Microsoft Visual
Studio.




                                                             Fundación Universitaria
                                                             Fundación Universitaria del
                                                                                     del Área
                                                                                         Área Andina
                                                                                              Andina   48
                                                                                                       15
En cuanto al lenguaje de programación Java.
Un ejemplo para realizar la conexión entre java y MySQL:

                 Connection con = null;
                    Statement stat = null;

                     try {
                       Class.forName(“com.mysql.jdbc.Driver”);
                       con = DriverManager.getConnection(“jdbc:mysql://localhost:3306/java1”,
                           “root”, “”);

                       // Creamos un Statement para poder hacer peticiones a la bd
                       stat = con.createStatement();
                 }
                 Catch(ClassNotFoundException | SQLException e){
                  System.out.println(“Error: ” + e.getMessage());
                 }

Java y Netbeans permite también realizar conexiones con el Motor de Bases de Datos SQL.
He aquí un ejemplo, donde se utiliza el driver correspondiente:

            private Connection conn = null;
            private Statement stm;
            private ResultSet rs;
            try {
            Class.forName(“org.gjt.mm.mysql.Driver”);
            conn = DriverManager.getConnection(url, user, password);
            if (conn != null)
            {
            System.out.println(“Conexión a base de datos “+url+” … Ok”);
            stm = conn.createStatement();
            }
            }
            catch(SQLException ex) {
            System.out.println(“Hubo un problema al intentar conectarse con la base de datos “+url);
            }
            catch(ClassNotFoundException ex) {
            System.out.println(ex);
            }
            }




                                                                           Fundación Universitaria
                                                                           Fundación Universitaria del
                                                                                                   del Área
                                                                                                       Área Andina
                                                                                                            Andina   49
                                                                                                                     16
Si lo que se desea es conectar a una base de datos Oracle, se muestra en el siguiente código
la forma de hacerlo, con el driver correspondiente.

                 try{
                        Class.forName(“oracle.jdbc.OracleDriver”);
                        String BaseDeDatos = “jdbc:oracle:thin:@localhost:1521:XE”;
                        Connection conexion= DriverManager.getConnection(BaseDeDatos,”HR”,”HR”);
                        if(conexion!=null)
                        {
                        System.out.println(“Conexion exitosa a esquema HR”);
                        }
                        else{System.out.println(“Conexion fallida”);}
                        }
                        catch(Exception e)
                        {e.printStackTrace();}
                   }


Cuando se quiera realizar una conexión con un motor de bases de datos PostgreSQL, se
muestra el driver correspondiente:


            String driver = “org.postgresql.Driver”; // el nombre de nuestro driver Postgres.
            String connectString = “jdbc:postgresql://localhost:5432/ejemplo/”; // llamamos nuestra bd
            String user = “postgres”; // usuario postgres
            String password = ” “; // no tiene password nuestra bd.
            try {
            Class.forName(driver);
            //Hacemos la coneccion.
            Connection conn = DriverManager.getConnection(connectString, user, password);
            //Si la conexión fue realizada con éxito, muestra el siguiente mensaje.
            System.out.println(“Conexión a la base de datos Ejemplo realizada con éxito! “);
            //Cerramos la conexión
            conn.close();
            }
            //Si se produce una Excepción y no nos podemos conectar, muestra el sgte. mensaje.
            catch(SQLException e) {
            System.out.println(“Se ha producido un error en la conexión a la base de datos Ejemplo! “);
            }




                                                                            Fundación Universitaria
                                                                            Fundación Universitaria del
                                                                                                    del Área
                                                                                                        Área Andina
                                                                                                             Andina   50
                                                                                                                      17
Ejercicio para realizar
Tome alguno de los IDE descritos, en el lenguaje que desee y realice la conexión a la base
de datos que desee, para ello, utilice el driver adecuado, así como se señaló en el numeral 4.




                                                             Fundación Universitaria
                                                             Fundación Universitaria del
                                                                                     del Área
                                                                                         Área Andina
                                                                                              Andina   51
                                                                                                       18
 1
UNIDAD


     2 Unidad 2




    Protocolos          Criptografía y
  criptográficos   mecanismos de seguridad

                       Autor: Lucy Medina
Introducción   Es esta unidad se trata el tema sobre los protocolos criptográ-
               ficos, se realiza un recorrido sobre qué son y cuáles son dichos
               protocolos, así como los protocolos más conocidos como son
               los simétricos y asimétricos. También se revisan qué son y cuá-
               les son los algoritmos criptográficos, las llaves criptográficas y
               cómo seleccionar un algoritmo en determinado caso.

               Los temas vistos en esta unidad, son de vital importancia para
               la seguridad de la información cuando se transmite por me-
               dio de la red. Por lo anterior, los estudiantes deberán ejerci-
               tarse para aprender las temáticas aquí tratadas y ejercitarse
               en ellas a través de las aplicaciones que puedan reforzar sus
               conocimientos.




                                              Fundación
                                              Fundación Universitaria
                                                        Universitaria del
                                                                      del Área
                                                                          Área Andina
                                                                               Andina   53
                                                                                        3
U2            Metodología


     Para captar de mejor forma los tópicos aquí tratados, elabore cada una de las actividades
     aquí expuestas, lea esta cartilla con detenimiento y conciencia de su propio aprendizaje, eje-
     cute las evaluaciones y hágase una retroalimentación para poder avanzar adecuadamente.

     Recomendaciones puntuales:
     ■ Realizar las lecturas asignadas.
     ■ Elaborar cada uno de los trabajos asignados.
     ■ Realizar las actividades de repaso y el parcial propuesto.
     ■ Cuando no entienda algo, comuníquese con su tutor.
     ■ No continúe con el siguiente tema, hasta que esté perfectamente claro el tema actual.
     ■ Siempre que lea, hágalo entendiendo las ideas.




                                                                  Fundación
                                                                  Fundación Universitaria
                                                                            Universitaria del
                                                                                          del Área
                                                                                              Área Andina
                                                                                                   Andina   54
                                                                                                            4
U2            Desarrollo temático



     Protocolos criptográficos                          ticipantes sobre la información que es
                                                        secreta y quieren compartir y es lo que
     Introducción a los protocolos criptográ-           comúnmente se llama clave. Como ejem-
     ficos                                              plo de estos protocolos, se encuentra el
                                                        protocolo de Diffie-Hellman, el ElGamal
     Los protocolos criptográficos tienen la tarea      de negociación de claves, MTI/A0 y el
     de velar por la seguridad de la información,       protocolo STS.
     para ello, utilizan métodos criptográficos.
     Estos protocolos indican cómo deben utili-       b. Protocolo de autenticación de usuario,
     zarse los algoritmos de criptografía, e inclu-      estos protocolos garantizan que el emi-
     sive, algunos de ellos detallan las estructu-       sor del mensaje o el receptor con quien
     ras de datos, con el objeto de convertir en         se establece la comunicación es real-
     interoperables los algoritmos.                      mente quien pretende ser. Cuando se
                                                         trabaja con servidores VNP, se establecen
     Generalmente, los protocolos criptográficos         protocolos para intercambiar informa-
     establecen las claves, autentican las entida-       ción e identificar el usuario, estos proto-
     des, incluyen cifrados simétricos, autentican       colos de acceso remoto son: PAP (Pas-
     claves, realizan el transporte de datos a ni-       sword Authentication Protocol), CHAP
     vel de capa de aplicación de forma segura y         (Challenger Authentication Protocol),
     utilizan el método de no repudio.                   MS-CHAP (Microsoft CHAP), MS-CHAPv2
                                                         (Microsoft CHAP versión 2), EAP (Extensi-
     Los protocolos criptográficos que trabajan          ble Authentication Protocol), SPAP (Shi-
     a nivel de aplicación utilizan generalmente         va Password Authentication Protocol).
     métodos distintos, de acuerdo a las claves,         Se encuentra también el Kerberos, que
     por eso se les llama protocolos criptográfi-        tiene por objetivo identificar usuarios
     cos.                                                a través de bibliotecas de “claves” en-
                                                         criptadas que sólo asigna la plataforma
     Los protocolos criptográficos tienen varias         Kerberos, así mismo se tiene también, el
     divisiones, dependiendo de la función que           protocolo Radius-Remote Authentica-
     realicen, por ello, existen protocolos como         tion Dial-In User Service, que autentica
     los:                                                usuario y ejecuta un programa de soft-
     a. Protocolos de Establecimiento de claves          ware en un servidor, también combina la
        o de intercambio de claves, los cuales           autenticación y autorización en el perfil
        establecen algunos pasos entre los par-          de usuario.




                                                                  Fundación Universitaria del Área Andina   55
                                                                  Fundación Universitaria del Área Andina   5
Los protocolos de autentificación del men-        verificador engañoso tiene algún simula-
saje tratan de garantizar la integridad del       dor que, teniendo en cuenta sólo la de-
mensaje.                                          claración a ser demostrada (y sin acceso
                                                  al probador), puede producir una trans-
c. Protocolos de autentificación del mensa-
                                                  cripción que “parece” una interacción en-
   je, certifican que el mensaje enviado no
                                                  tre el probador honesto y el verificador
   ha sido substituido por otro ni alterado,
                                                  tramposo. (Wikipedia.org).
   es lo que comúnmente se llama integri-
   dad del mensaje.                             g. Protocolo de rellenado con paja y aven-
                                                   tado, este protocolo utiliza una técnica
d. Distribución de claves, la seguridad de
                                                   denominada añadiendo paja y aventado,
   las claves privadas del emisor y receptor       que en otras palabras no es más que a
   es problemática y cuando se trata de cla-       los paquetes con información real y ver-
   ves públicas, se requiere de protocolos         dadera se les agregan datos irrelevantes,
   específicos, pues no se requiere el secre-      con el objeto de que un intruso se le difi-
   to de la clave.                                 culte distinguir los paquetes irrelevantes
e. Protocolos para compartir secretos, el          de los que no los son.
   fin de este protocolo es el de distribuir    h. Transacciones Electrónicas Seguras: las
   un secreto entre unos participantes de          transacciones bancarias se realizan de
   forma tal que un subconjuto de estos            manera segura electrónicamente, puede
   participantes puedan recuperar el se-           ser por medio de la firma electrónica.
   creto.
                                                i. Compromiso de bit: permiten a una par-
f. Protocolo de conocimiento cero o prue-          te A comprometerse con una elección
   ba de conocimiento cero, establece un           (un Bit o más generalmente una serie de
   método para interactuar concedido a             bits) sin revelar tal elección hasta un mo-
   una de las partes, con el fin de probar a       mento posterior. El protocolo garantiza a
   otra parte que una declaración es verda-        otra parte B que A no cambia su elección.
   dera y cierta, sin revelar nada más que la      (Tanenbaum, Andrew S. 2013).
   declaración, es decir, hace que una per-
                                                j. Transferencias transcordadas: permiten a
   sona persuada a otro que posee una cier-
                                                   una parte A enviar a otra B un mensaje o
   ta información, sin revelarle nada sobre
                                                   secreto entre dos posibles. A no conoce
   el contenido de la misma. Las propieda-         cuál de los dos ha recibido realmente B.
   des que tiene este protocolo es la tota-        (Tanenbaum, Andrew S. 2013).
   lidad, cuando la afirmación es verdad,
   el que verifica es honesto y se convence     k. Elecciones Electrónicas: permiten realizar
   al probar honestamente. La solvencia,           un proceso electoral electrónicamente,
   cuando la declaración es falsa, no hay          garantizando la deseable privacidad de
   un probador engañoso que convenza al            cada votante y la imposibilidad de frau-
   verificador honesto que es verdad. El co-       de. (Tanenbaum, Andrew S. 2013).
   nocimiento cero, cuando la afirmación es     l. Jugar al póker por internet: posibilita
   verdadera, un verificador engañoso no           a dos personas, físicamente separadas,
   aprende otra cosa más que este hecho.           mantener una partida de póker (o similar:
   Esto se formaliza mostrando que cada            cara o cruz, chinos, etc.), comunicándo-




                                                            Fundación
                                                            Fundación Universitaria
                                                                      Universitaria del
                                                                                    del Área
                                                                                        Área Andina
                                                                                             Andina   56
                                                                                                      6
  se por correo electrónico, teléfono, etc.,      aprender o anotar en alguna parte, o inter-
  garantizando la imposibilidad de hacer          cambiar correos electrónicos con las claves
  trampa. (Tanenbaum, Andrew S. 2013).            secretas del mismo número de personas
                                                  con quienes se va a comunicar, haciendo
Otros protocolos como el Transport Layer          esta forma de comunicación muy frágil.
Security -TLS- es utilizado cuando se tra-
baja con conexiones web HTTP seguras, el          La fortaleza de los algoritmos criptográfi-
mecanismo de autenticación se basa en el          cos depende de la complejidad interna del
sistema X.509, posee una fase de configura-       mismo y de la longitud utilizada de la clave
ción de claves, allí se trabaja con una clave     secreta, con el fin de evitar ataques denomi-
de cifrado simétrico usando criptografía de       nados de fuerza bruta.
llave pública y los datos son enviados a nivel
de aplicación.                                    Los algoritmos simétricos tienen una ven-
                                                  taja y es su velocidad, pues se utilizan para
Protocolos de criptografía simétrica              cifrar grandes cantidades de datos. Es el
Estos protocolos son también llamados             caso de TrueCrypt que utiliza los algoritmos
Symmetric Key Ccryptography o criptogra-          simétricos.
fía de clave secreta.
                                                  A continuación se relacionan algunos algo-
Este tipo de protocolos, se basan en que uti-     ritmos de clave simétrica aunque algunos
lizan la misma clave para cifrar y descifrar un   de ellos son considerados en esta época no
mensaje en un canal inseguro. Tanto emisor        seguros, vale la pena conocerlos por infor-
como receptor, antes de comunicar el men-         mación general.
saje se ponen de acuerdo sobre la clave que       a. Data Encryption Standard – DES: es un
van a utilizar, cuando el emisor cifra el men-       algoritmo de cifrado monoalfabético, en
saje con la clave acordada y el receptor lo          el que se aplican permutaciones sucesi-
recibe, éste lo descifrará con la misma clave        vas y también sustituciones al texto origi-
que acordaron.                                       nal. La información de 64 bits se somete
                                                     a una permutación inicial de y luego, a
Recordando, el famoso código Enigma utili-
                                                     una de 8 bits y después a una sustitución
zado por los alemanes en la segunda guerra
                                                     de entrada de 5 bits, este proceso cons-
mundial, era un sistema simétrico, el cual a
diario se entregaban las claves de transmi-          ta de diez y seis etapas de cifrado. Por
sión en un libro de códigos, el cual los ope-        lo anterior, esta algoritmo se denomina
radores de radio consultaban y retomaban             de clave simétrica de 64 bits, de los cua-
el código del día para que emisor y receptor         les, emplea los 56 primeros bits para el
tuvieran la misma clave y pudieran comuni-           cifrado y los restantes ocho bits para la
carse por medio de ondas de radio.                   comprobación de errores mientras dura
                                                     el proceso; lo que hace que solo 56 bits
Un gran problema que tiene este tipo de              son utilizados como clave efectiva, esto
criptografía es que si se desea tener un do-         quiere decir que existen 2 a la 56 posibles
cumento o mensaje secreto, privado entre             combinaciones posibles, que lo hace casi
un número grande de personas, se debe                imposible de descifrar.




                                                              Fundación
                                                              Fundación Universitaria
                                                                        Universitaria del
                                                                                      del Área
                                                                                          Área Andina
                                                                                               Andina   57
                                                                                                        7
                   Ventajas                                          Desventajas
                                                   Que la clave no puede ser de longitud variable,
Es uno de los más utilizados y por tanto de los
                                                   la cual se pueda incrementar para hacerla más
más probados.
                                                   segura.
                                                   Si se conoce suficiente texto original o en claro
Que tiene una implementación muy rápida y
                                                   y cifrado, es vulnerable al criptoanálisis llamado
sencilla.
                                                   diferencia.
                                                   La clave con una longitud de 56 bits es muy
                                                   corta, lo que la hace vulnerable.
                                                   Ya no es un estándar, porque en 1999 fue roto
                                                   este algoritmo por una computadora.
                                             Cuadro 1
                                           Fuente: Propia.

b. Triple Data Encryption Standard -                d. International Data Encriptión Algo-
   3DES: su nombre lo recibe debido a que              rithm – IDEA: este algoritmo utiliza
   se aplica tres veces el algoritmo DES y la          claves de 128 bits sin paridad a bloques
   clave con longitud de 128 bits, la hace             de datos de sesenta y cuatro bits, es uti-
   más segura que su antecesor, pero da la             lizado para descifrar y cifrar mensajes.
   posibilidad de cifrar el mismo bloque de            IDEA combina operaciones matemá-
   datos dos veces con claves distintas de             ticas como XOR, sumas con acarreo de
   64 bits, esto hace que el tamaño de la cla-         módulo 2¹⁶ y multiplicaciones de módu-
   ve se incremente, pero también se incre-            lo 2¹⁶+1, sobre bloques de 16 bits. (Wiki-
   mentan los recursos de la computadora.              pedia.org).
   De este algoritmo se ha trabajado sobre
                                                        IDEA es considerado como el mejor algo-
   una nueva versión llamada 3DES o mejor
                                                        ritmo de cifrado de datos, pues si se apli-
   conocida como DES-EDE3, que trabaja
                                                        ca fuerza bruta para descifrar el mensa-
   con tres claves distintas y con una longi-
                                                        je, se tendría que tiene 2 a las 128 claves
   tud de 192 bits, de esta forma el sistema
                                                        privadas que se tendría que probar por
   será mucho más robusto.
                                                        fuerza bruta.
c. RC5: en este algoritmo de cifrado simétri-
                                                    e. Advanced Encryption Standard – AES:
   co, las longitudes de las claves cambian,
                                                       es un método de cifrado utilizado por los
   igual que las iteracciones, esto hace que
                                                       usuarios de routers, por cuanto WPA ope-
   la seguridad del cifrado aumente, pero va
                                                       ra con este método de cifrado. Es un mé-
   de acuerdo con ese número de iteraccio-
                                                       todo versátil, por cuanto se puede utilizar
   nes, pues al aplicar las operaciones XOR
                                                       en hardware como en software y opera
   sobre los datos, se alcanza a tener de 32,
                                                       con bloques de claves de longitud varia-
   64 o 128 bits. De otra parte, puede gene-
                                                       da que van desde 128, 192 y de 256 bits.
   rarse números aleatorios, los cuales se les
   suma a los bloques de texto que se han               El resultado intermedio del cifrado cons-
   rotado por medio de la operación XOR.                tituye una matriz de bytes de cuatro filas




                                                                 Fundación
                                                                 Fundación Universitaria
                                                                           Universitaria del
                                                                                         del Área
                                                                                             Área Andina
                                                                                                  Andina   58
                                                                                                           8
   por cuatro columnas. A esta matriz se le                De este algoritmo existen varias versio-
   vuelve a aplicar una serie de bucles de                 nes como AES-CBC (Cipher-block chai-
   cifrado basado en operaciones matemá-                   ning), AES-CFB (Cipher feedback) y AES-
   ticas (sustituciones no lineales de bytes,              OFB (Output feedback).
   desplazamiento de filas de la matriz,               f. Blowfish: es un algoritmo por bloques
   combinaciones de las columnas median-                  simétrico que utiliza 18 semiclaves y cua-
   te multiplicaciones lógicas y sumas XOR                tro cajas, el proceso que utiliza es simple
   en base a claves intermedias). (Wikipe-                pero seguro pues aún no se ha podido
   dia.org)                                               aplicar criptoanálisis sobre él.




                                   Imagen 1. Algoritmo de cifrado Blowfish
Fuente: naciek. (2013). http://lumbreras-criptografia.blogspot.com.co/2013/07/cifrados-por-bloque-blowfish.
                                                      html


Funciones de una vía y Hash                            de salida finito, denominado mapa, las cua-
Son funciones Hash que se trabajan por me-             les son también cadenas de longitud fija,
dio de algoritmos que cumplen que: H:U->               esto quiere decir: la proyección del conjun-
M x -> h(x), quiere decir, que existen unos            to U sobre el conjunto M, donde M pueden
elementos que generalmente son cadenas                 ser un conjunto de enteros y se entiende
como entradas, se convierten en un rango               que la longitud de la cadena es fija.




                                                                     Fundación
                                                                     Fundación Universitaria
                                                                               Universitaria del
                                                                                             del Área
                                                                                                 Área Andina
                                                                                                      Andina   59
                                                                                                               9
                                      Imagen 2. Función Hash
       Fuente: https://chuquispumasaunejesus.files.wordpress.com/2014/08/funciones.jpg?w=604


Protocolos de criptografía asimétrica              privada, se requiere la correspondiente cla-
Los protocolos criptográficos asimétricos          ve pública para su decodificación. De la mis-
son la base de la criptografía actual, fueron      ma manera, cuando se codifica con la clave
inventados en 1976 por los matemáticos             pública se requiere de la clave privada para
Whit Diffie y Martin Hellman.                      la decodificación.

Este tipo de criptografía simétrica utiliza        Se denominan claves privadas porque solo
dos claves, una clave primaria y una pública,      son conocidas por el propietario y las claves
estas son complementarias, funcionan así,          públicas reciben su nombre porque se les
cuando se codifica un mensaje con la clave         puede conocer abiertamente.




                                   Imagen 3. Criptografía Asimétrica
         Fuente: http://www.ongei.gob.pe/seguridad/seguridad2_archivos/lib5010/cap0506.htm




                                                                Fundación Universitaria
                                                                Fundación Universitaria del
                                                                                        del Área
                                                                                            Área Andina
                                                                                                 Andina   60
                                                                                                          10
En la imagen 3, se presenta el funciona-          Algunos algoritmos y tecnologías de clave
miento del protocolo de criptografía asimé-       asimétrica son:
trica, María y Carlos poseen las dos claves,
                                                  a. Protocolo criptográfico Diffie-Hell-
la secreta y la pública, pero si María codifica
                                                     man: en la imagen 4, se muestra el ma-
con la llave pública el mensaje para Carlos
                                                     nejo del protocolo de Diffie-Hellman, el
con la llave pública, Carlos deberá leerlo con
                                                     cual se basa en lo siguiente: (Wikipedia.
la llave privada que solo él tiene y conoce; al
contrario, si María envía Carlos un mensaje          org)
cifrado con la clave privada de María, enton-       La idea de que dos interlocutores pue-
ces Carlos requiere la clave pública de María       den generar conjuntamente una clave
para descifrarlo.                                   compartida sin que un intruso que esté
                                                    escuchando las comunicaciones pueda
Cuando se requiere saber la identidad del
                                                    llegar a obtenerla.
emisor y del receptor, se combinan las cla-
ves así, María puede enviar un mensaje a            Para ello cada interlocutor elige un nú-
Carlos cifrado dos veces, con la clave priva-       mero público y un número secreto. Usan-
da de María y con la clave pública de Carlos.       do una fórmula matemática, que inclu-
                                                    ye la exponenciación, cada interlocutor
El funcionamiento de la criptografía asimé-         hace una serie de operaciones con los
trica tiene sus bases en el uso de números
                                                    dos números públicos y el secreto. A con-
primos muy grandes, que si se multiplican,
                                                    tinuación los interlocutores se intercam-
producen un número muy difícil de ser des-
                                                    bian los resultados de forma pública. En
compuesto, pues una computadora reque-
                                                    teoría revertir esta función es tan difícil
riría de miles de millones de años y tantos
                                                    como calcular un logaritmo discreto (Un
computadores como los átomos del uni-
                                                    millón de millones de cuadrillones más
verso. Por lo anterior, para que este cifrado
surta un buen efecto sobre a información,           costosa que la exponenciación usada
se requiere que los números primos usados           para transformar los números). Por eso
sean muy grandes.                                   se dice que este número es el resultado
                                                    de aplicar una función unidireccional al
Estos protocolos asimétricos tienen la des-         número secreto.
ventaja que si el texto a cifrar es muy largo,
                                                    A continuación ambos interlocutores
la codificación se vuelve muy lenta.
                                                    utilizan por separado una fórmula ma-
Hoy se codifica el texto base con claves si-        temática que combina los dos números
métricas DES o IDEA, usan claves asimétri-          transformados con su número secreto y
cas para la comunicación de la clave simé-          al final los dos llegan al mismo número
trica usada.                                        resultado que será la clave compartida.




                                                             Fundación Universitaria
                                                             Fundación Universitaria del
                                                                                     del Área
                                                                                         Área Andina
                                                                                              Andina   61
                                                                                                       11
                  Imagen 4. Protocolo criptográfico de Diffie-Hellman
Fuente: http://www.javiercampos.es/blog/wp-content/uploads/2011/07/diffie-hellman.png




                                                         Fundación Universitaria
                                                         Fundación Universitaria del
                                                                                 del Área
                                                                                     Área Andina
                                                                                          Andina   62
                                                                                                   12
b. Protocolo criptográfico RSA: por sus            e. Criptografía de curva elíptica ECC: se
   siglas - Rivest, Shamir y Adleman-. Su             llama así porque esta clave pública re-
   uso es doble, para encriptar y para firmar         quiere de unas claves más pequeñas,
   digitalmente, utiliza clave pública en su          esta característica hace que sea apta para
   funcionamiento, decir, tiene una clave             sistemas que requieren más memoria.
   pública y una privada, en donde quien           f. Criptosistema de Merkle-Hellman: es
   envía el mensaje lo cifra con la clave pú-         un criptosistema de llave pública asmé-
   blica de quien recibirá el mensaje, cuan-          trico, más simple que el RSA, no ofrece la
   do se ha cifrado el mensaje y le ha llega-         opción para firmar y es un criptosistema
   do al destino, el recetor lo descifra con su       que ya fue roto. Este criptosistema para la
   propia clave privada.                              comunicación, requiere de una llave pú-
   La seguridad de este algoritmo radica en           blica y una privada. Solo se utiliza la llave
   el problema de la factorización de nú-             pública para cifrar, no para verificar firma
   meros enteros. Los mensajes enviados               y la llave privada solo descifra mensajes,
   se representan mediante números, y el              no sirve para firmar, lo anterior indica
   funcionamiento se basa en el producto,             que este criptosistema no se utiliza para
   conocido, de dos números primos gran-              autentificación por firma electrónica.
   des elegidos al azar y mantenidos en se-
                                                   Protocolos de firma digital
   creto. Actualmente estos primos son del
   orden de diez a la 200, y se prevé que su       La firma digital es una herramienta tecnoló-
   tamaño crezca con el aumento de la ca-          gica para garantizar la autoría e integridad
   pacidad de cálculo de los computadores.         de documentos digitales, estas firmas aso-
   (Wikipedia.org)                                 cian un mensaje digital para garantizar la
c. DSA Digital Signature Algorithm o               identidad de la persona que firma, así como
   también llamado algoritmo de firma              la integridad del mensaje. Una firma digital
   digital: sirve para firmar y no para cifrar     no asegura que el mensaje sea confiable.
   información. Para mejorar la seguridad,
                                                   Existen algunos algoritmos de firma que se
   se puede utilizar RSA y DSA simultánea-
                                                   basan en la criptografía de clave asimétrica
   mente, pero requiere más tiempo que el
                                                   para cifrar y descifrar, algunos de los más in-
   RSA.                                            teresantes son:
d. ElGamal: usado para generar firmas digi-
   tales, para cifrar y descifrar. Este procedi-   Firma RSA: la firma digital RSA, se utiliza
   miento se basa en cálculos cobre un gru-        para el envío de mensajes, secretos o no con
   po cíclico (G) que hace que la seguridad        el objeto de que nadie los pueda modificar.
   del mismo dependa de la dificultad para         Por ejemplo, Si Ana envía un mensaje a Raúl,
   calcular los llamados logaritmos discre-        Ana posee una clave pública de dos valores
   tos en (G).                                     (a y b) y una clave privada (c).

   Este esquema de firma, da la posibilidad        Firma DSA: este estándar es utilizado para
   que un verificador confirme la autentici-       firmas digitales y no para cifrar la informa-
   dad de un mensaje enviado por un emisor         ción. Su funcionamiento se compone de
   sobre el canal de comunicación inseguro.        tres fases o etapas como son, la generación




                                                               Fundación Universitaria
                                                               Fundación Universitaria del
                                                                                       del Área
                                                                                           Área Andina
                                                                                                Andina   63
                                                                                                         13
de claves, la firma y la verificación. Tanto la         las ejecuta el emisor y la verificación la eje-
generación de las claves como de la firma,              cuta el receptor.




                                           Imagen 5. Diagrama DSA.
     Fuente: DSA (Digital Signature Algorithm). Tomado de http://redyseguridad.fi-p.unam.mx/proyectos/
criptografia/criptografia/index.php/5-criptografia-asimetrica-o-de-clave-publica/56-firmas-digitales/562-dsa-
                                          digital-signature-algorithm


Otros protocolos de firma que se basan en               ■ Firma de Okamoto.
la criptografía de clave asimétrica son:                ■ Firma de Feige-Fiat-Shamir.
■ Firma ESING.
                                                        De otra parte, algunos protocolos de firma
■ Firma de clave asimétrica de Rabin.                   que se basan en la criptografía de clave si-
■ Firma ElGamal.                                        métrica son:
■ Firma con curvas elípticas.                           ■ Firma de Desmedt.
■ Firma de Guillou-Quisquater.                          ■ Firma de Lamport-Diffie.
■ Firma de Ohta-Okamoto.                                ■ Firma de clave simétrica de Rabin.
■ Firma de Schnorr.                                     ■ Firma de Matyas-Meyer.


                                                                      Fundación Universitaria
                                                                                Universitaria del
                                                                                              del Área
                                                                                                  Área Andina
                                                                                                       Andina   64
                                                                      Fundación                                 14
Generación de números aleatorios                 Antes de ser cifrado un mensaje se le llama
                                                 texto en claro, pero una vez ese texto se ha
Muchos de los algoritmos criptográficos          cifrado, se le llama texto cifrado.
requieren generar números aleatorios para
hacer las claves, es decir, que en casi todos    Los algoritmos criptográficos modifican los
los sistemas criptográficos se generan nú-       datos de un documento o mensaje con el
meros aleatorios para que los mensajes no        fin de lograr algunas de las características
se puedan adivinar por intrusos. Ejemplos        de seguridad como son, la autenticación, la
en donde se utilizan los números aleato-         integridad y la confidencialidad.
rios está la telefonía digital GSM, que se usa
                                                 Son tres grupos en los que se clasifican los
para asignar claves aleatorias para autenti-
                                                 algoritmos criptográficos:
car usuarios o dar seguridad a la asignación
inicial de números secretos a las tarjetas de    1. Criptografía simétrica o también llama-
crédito.                                            da de clave secreta.
                                                 2. Criptografía asimétrica o también lla-
La generación de números aleatorios es uti-         mada de clave pública.
lizada para generar claves de sesiones y for-
taleza o calidad, para que la calidad de los     3. Criptografía Hash o de resumen.
sistemas sea fuerte, pues de ellos depende
                                                 En cuanto a la criptografía simétrica, estos
la fortaleza de las claves.
                                                 encriptan y desencriptan el mensaje con la
Si el generador de números aleatorios es         misma clave. Estos algoritmos son seguros y
roto, se volverá el punto más frágil del sis-    veloces, pues son mil veces más rápidos que
                                                 los algoritmos asimétricos.
tema criptográfico. Existen muchos genera-
dores de números pseudo-aleatorios como          Algunos de los algoritmos simétricos ya tra-
el llamado Yarrow, la cual es usado amplia-      tados en esta cartilla son: DES, 3DES, RC2,
mente por el gobierno americano.                 RC4, RC5, IDEA, AES y Blowfish.
Otro cifrador de flujo muy usado es el RC4,      En cuanto a la criptografía asimétrica o de
trabaja con bytes y genera bytes aleatorios,     clave pública, se diferencia de la simétrica,
opera también en modo sincrónico, es muy         porque utiliza una clave para encriptar y
eficiente en implementaciones de software.       otra para desencriptar; ninguna de las dos
                                                 claves depende la una de la otra. Las longi-
Introducción a los algoritmos criptográ-         tudes de las claves son muy superiores a las
ficos                                            de las claves simétricas y su complejidad en
Los algoritmos criptográficos son métodos        el cálculo, hace más lentos los algoritmos
                                                 asimétricos que los simétricos.
matemáticos empleados para cifrar y des-
cifrar mensajes, que operan con una o más        Algunos de los algoritmos asimétricos son:
claves, las cuales pueden ser numéricas o de     Diffie-Hellman, RSA, ElGamal y Criptografía
cadenas de caracteres, utilizados como pa-       de curva elíptica.
rámetros de los algoritmos, con el objeto de
recuperar los mensajes a partir de la versión    Hash: es una función que genera claves
que se utilice para cifrar el mensaje.           para representar un documento, registro,




                                                             Fundación Universitaria del Área Andina   15
                                                                                                       65
archivo, mensaje u otro, que resume o iden-     funciona de una forma parecida a este algo-
tifica un dato por medio de la probabilidad     ritmo discreto.
usando una función Hash o también llama-
do algoritmo Hash y lo que resulta se deno-     A partir de los años 70 se han dado los apor-
mina un hash.                                   tes más notorios de la matemática en la
                                                criptografía de clave pública, pues se creó la
La criptografía utiliza mucho este tipo de      criptografía simétrica AES, la cual es una de
funciones, por ejemplo en las firmas digi-      las áreas que trabaja el álgebra.
tales, en el procesamiento de datos y para
encriptar mensajes o documentos. Algunos        Uno de los usos de la matemática en la crip-
algoritmos criptográficos que utilizan fun-     tografía ha sido los números primos, por
ciones hash: MD5, SHA-1, DSA.                   ejemplo en la RSA, generando las claves,
                                                también en DSA generando el dominio de
Matemáticas involucradas                        parámetros para la firma digital, en el DH, se
                                                utiliza el esquema de intercambio de claves,
La criptografía aprovecha las técnicas mate-    al igual que las versiones elípticas EDSA y
máticas para su uso, pues les sirven como       EDH.
herramienta para lograr sus objetivos. Tanto
la matemática como la informática, le han       Otro uso de las matemáticas ha sido a través
dado a la criptografía los avances que ha lo-   de la factorización, es así que RSA basa su
grado hasta el momento.                         seguridad en la imposibilidad de factorizar
                                                un número de determinada longitud, pro-
La relación entre la complejidad y la lon-      ducto de dos números primos. Últimamente
gitud de las claves se ha dado gracias a la     la criptografía estudia en gran medida este
matemática, por cuanto utilizan números         tema, pues existen distintos métodos para
randómicos y el tiempo necesario para en-       factorizar números enteros y en muchas de
criptar y desencriptar los mensajes; de esta    ellas, es imposible factorizar en ciertas con-
manera, la matemática ha sido clave para        diciones, un ejemplo concreto es el famoso
encontrar y definir con claridad sistemas       número de Fermat.
criptográficos estables y seguros.
                                                En tercer término, Diffie y Helmman toman
Otro uso que la criptografía hace de las ma-    como suyo el Problema del Logaritmo Dis-
temáticas es en los algoritmos de encripta-     creto PLD, el cual dio inicio a la criptogra-
ción simétricos, pues utilizan los métodos      fía de clave pública, la idea es encontrar un
de transposición y permutación. Además          grupo particular donde PLD se defina y no
los de algoritmos de clave pública se basan     pueda ser resuelto en tiempo polinomial, lo
en complejas operaciones matemáticas.           que trae consigo el diseño de sistemas crip-
                                                tográficos de clave pública muy seguros.
Otro ejemplo claro, es el procedimiento de      También los campos finitos generales, han
cifrado/descifrado ElGamal, que se refiere      sido utilizados para implementar esquemas
a un esquema de cifrado basado en el pro-       criptográficos y los conocidos como campos
blema matemático del logaritmo discreto.        finitos de característica 3, han sido conside-
Es un algoritmo de criptografía asimétrica      rados en aplicaciones eficientes de firmas
basado en la idea de Diffie-Hellman y que       cortas dentro de la criptografía bilineal.




                                                            Fundación Universitaria
                                                            Fundación Universitaria del
                                                                                    del Área
                                                                                        Área Andina
                                                                                             Andina   66
                                                                                                      16
Otros usos de la matemática en la criptogra-          Por último, la criptografía simétrica utiliza
fía son las curvas elípticas, que hoy en día          un estándar comercial llamado Rijndael,
son muy utilizadas en la mayoría de están-            que basa su representación en 8 bits y las
dares criptográficos. Al igual que las curvas         operaciones básicas se basan en campos fi-
hiperelípticas, que se utilizan en varios paí-        nitos y anillos polinómicos.
ses comercialmente.
                                                      Tipos block y stream de algoritmos crip-
Otra área de la criptografía son los lattices         tográficos
o retículas, aquí se encuentra un vector con          Los algoritmos criptográficos, se encargan
Longitud Mínima dada una lattice. Este tipo           de modificar los datos de un documento
de criptografía se utiliza para el cifrado y fir-     para alcanzar características de seguridad
ma digital, al igual, se usa en ataque a es-          como son la autenticación, integridad y
quemas RSA.                                           confidencialidad. De estos algoritmos se tie-
                                                      nen, los Cipher Blocks y los Cipher Stream.
Los mapeos bilineales, utilizados por los
esquemas de firma digital, de cifrado, inter-         Cipher Blocks - Cifrado por bloques, es un
cambio de claves, entre otras.                        método encargado de encriptar texto, en el
                                                      que la clave criptográfica y el algoritmo se
Un campo de investigación actual es el lla-           aplican en bloque de datos, esto hace que
mado grupo de trenzas o braid group, este             se divida el texto original en bloque de bits
grupo de trenzas puede definir PLD y de               con tamaño fijo y se cifran de manera inde-
esta manera define un esquema criptográ-              pendiente dando así como resultado cifra-
fico.                                                 dos que no son idénticos del texto cifrado,
                                                      el vector de inicialización lo que hace es
El nuevo tipo de criptografía denominado              derivar el generador de números aleatorios
ecuaciones multivariables, las cuales tiene           que se combina con el texto en el primer
claves de longitud equivalente a la cripto-           bloque y la clave, esto asegura que los blo-
grafía simétrica y además que su compleji-            ques posteriores no posean el mismo texto
dad de ataque es exponencial.                         de la primera encripción.

                                               1019bits

                              Bloque 1     Bloque 2     Bloque 3     B4     Mensaje en claro
                                  300b


                              K           Cifrador


                                                           Figura 1. Ejemplo de Cifrado por bloques
                                                              Fuente: http://www.edukanda.es/
           Bloques cifrados   Bloque 1     Bloque 2       mediatecaweb/data/zip/638/PID_00150197/
                                                                  web/main/m3/v3_2_2.html




                                                                   Fundación Universitaria
                                                                   Fundación Universitaria del
                                                                                           del Área
                                                                                               Área Andina
                                                                                                    Andina   67
                                                                                                             17
En la figura anterior se presenta un mensaje         Cipher Stream - Cifrado de Flujo: este mé-
inicial de 1019 bits, el cual se divide en tres      todo de cifrado utiliza bit a bit o cada dígito
bloques de 300 bits y el último de 119 bits.         binario, dado esto, no es muy útil en la crip-
                                                     tografía moderna pero aun así es un buen
Este tipo de cifrado es una unidad de clave          método.
simétrica, que trabaja con grupos de bits de
longitud fija, al cual se les denomina blo-          Este tipo de cifrado es usado en las teleco-
ques y se les aplica una transformación de-          municaciones, porque cuando se establece
nominada invariante. Cuando se descifra el           una comunicación vía teléfono móvil, la voz
texto, se ingresan bloques de texto cifrado y        se digitaliza (se convierte a un flujo de bits)
se generan bloques de texto plano.                   y se envía cifrada por la red de comunica-
                                                     ciones, pero es tan rápido el cifrado que los
Como ejemplo de cifrado por bloques se               hablantes no se dan cuenta.
tienen los siguientes algoritmos de cifrado:
DES-Data Encription Standard, AES-Advan-
ced Encryption Standard, IDEA- Internatio-                M: 01000111
nal Data Encryption Algorithm, RC2, RC5,                  S: 10110011               =     M´:11110100
Khufu, KHAFRE, GOST, SAFER, Blowfish, Ake-                M´:11110100                     S: 10110011
larre, FEAL, Skipjack, 3DES.
                                                                                          M: 01000111

                                                   ..    M                     M´                      M
                                                                                                            ..
                                                   (




                                                                                                           (
                                                               +                               +
                                                   Ana                                                     Bernardo

                                                                   s                               s
                                                            Generador                      Generador
                                                         pseudoaleatorio                pseudoaleatorio

                                                               K                               K
                                                                  Figura 2. Cifrado de flujo
                                                      Fuente: http://www.edukanda.es/mediatecaweb/
                                                     data/zip/638/PID_00150197/web/main/m3/v3_2_1.
                                                                             html


                                                     En la figura 2, se muestra que cada bit que
                                                     entra al sistema, se combina utilizando a
                                                     función lógica XOR con el bit que corres-
          Imagen 6. Cifrado por Bloques              ponda del flujo clave S y da lugar al bit co-
 Fuente: https://upload.wikimedia.org/wikipedia/     rrespondiente al flujo de salida. El receptor
   commons/thumb/f/f9/Cifrado_por_bloques.           hace lo mismo, combina XOR y así obtiene
      png/250px-Cifrado_por_bloques.png              el flujo.




                                                                       Fundación Universitaria
                                                                       Fundación Universitaria del
                                                                                               del Área
                                                                                                   Área Andina
                                                                                                        Andina        68
                                                                                                                      18
La clave utilizada por este tipo de ciframien-     vide por bloques, cada uno de ellos utiliza
to, es la fortaleza del cifrado de flujo, pues     la misma clave (key), (ver imágenes 7 y 8),
se utiliza una clave aleatoria muy larga, que      es decir que los bloques de manera indivi-
utiliza un generador pseudoaleatorio, cuyo         dual son cifrados y una vez se unen estos
algoritmo a partir de un mismo valor de en-        bloques ya cifrados, se obtiene el mensaje
trada, se genere el mismo flujo de bits de sali-
                                                   completo cifrado. Cuando en este método
da, que se asemeja a una secuencia aleatoria.
                                                   se tienen bloques de “texto claro” iguales,
Los métodos más conocidos de este tipo de          los bloques cifrados son iguales, esto quiere
cifrado es el de sustitución y transposición,      decir que el patrón de los datos no es escon-
como es el método de Julio César.                  dido por el método, esta es la gran desven-
                                                   taja de este método, pues lo hace sensible
Modos ECB, CBC, CFB Y OFB de algorit-              para reconocer los patrones guía y de esta
mos criptográficos                                 forma descubrir el mensaje original a partir
ECB – Electronic codebook- Libro de código         del ciframiento hecho. Este método es útil
electrónico: al enviar un mensaje, este se di-     para datos aleatorios.




                          Imagen 7. Modo de encripción ECB – Electronic CodeBook
   Fuente: https://es.wikipedia.org/wiki/Modos_de_operaci%C3%B3n_de_una_unidad_de_cifrado_por_
                                 bloques#/media/File:PCBC_encryption.svg




                        Imagen 8. Modo de desencripción ECB – Electronic Codebook
   Fuente: https://es.wikipedia.org/wiki/Modos_de_operaci%C3%B3n_de_una_unidad_de_cifrado_por_
                                 bloques#/media/File:PCBC_decryption.svg




                                                               Fundación Universitaria
                                                               Fundación Universitaria del
                                                                                       del Área
                                                                                           Área Andina
                                                                                                Andina   19
                                                                                                         69
CBC – Cipher Block Chaining. Cifrado en           tiene una desventaja que consiste en que es
Bloque Encadenado: se inicia con el “texto        secuencial, pues el resultado de un bloque
claro”, el cual es dividido por bloques, a cada   depende de otro y esa forma de trabajo difi-
uno de ellos se le aplica la operación XOR del
                                                  cultaría el procesamiento por bloques para-
bloque obtenido en la etapa anterior, esto
es que cada bloque encontrado depende-            lelos. Es muy útil para encriptar archivos, en
rá de todos los bloques de texto anteriores.      donde la seguridad se incrementa respecto
Aunque es muy utilizado en el ciframiento,        a ECB ver (imágenes 9 y 10).




                        Imagen 9. Modo de encripción CBC – Cipher Block Chaining.
   Fuente: https://es.wikipedia.org/wiki/Modos_de_operaci%C3%B3n_de_una_unidad_de_cifrado_por_
                                  bloques#/media/File:Cbc_encryption.png




                       Imagen 10. Modo de desencripción CBC – Cipher Block Chaning
   Fuente: https://es.wikipedia.org/wiki/Modos_de_operaci%C3%B3n_de_una_unidad_de_cifrado_por_
                                  bloques#/media/File:Cbc_decryption.png




CFB - Cipher FeedBack - Cifrado Reali-            texto claro a partir de la operación XOR y así
mentado y OFB - Output FeedBack: Estos            se obtiene el texto cifrado, para ello, cuando
métodos toman los bloques y los transforma        se intercambia un bit en el texto que se cifra,
en flujo, debido a que crean bloques de flujo     se produce un intercambio estrictamente
de llave, una vez hace el cambio, se cifra el     en la misma posición del texto claro.




                                                               Fundación Universitaria del Área Andina   20
                                                                                                         70
En el método CFB cada bloque de flujo de          liza el operador XOR para realizar las opera-
llave, se calcula cifrándose el bloque de tex-    ciones correspondientes una vez se utiliza
to cifrado anterior. Este método se usa prin-     la clave para crear un bloque pseudoaleato-
cipalmente para flujos continuos y es consi-      rio con el texto claro con el fin de crear un
derado la mejor manera de encriptar flujos        texto cifrado; para ello necesita un vector
de bytes, en donde cada byte se encripta.         de inicialización que es exclusivo para cada
                                                  construcción que realiza. Este modo se utili-
OFB – Output FeedBack: este modo es muy           za en aplicaciones donde la propagación de
útil para transmisiones de flujos continuos       errores no puede soportarse (ver imágenes
en ambientes ruidosos. Al igual que CFB uti-      11 y 12).




                           Imagen 11. Modo de encripción OFB – Output FeedBack
   Fuente: https://es.wikipedia.org/wiki/Modos_de_operaci%C3%B3n_de_una_unidad_de_cifrado_por_
                                  bloques#/media/File:OFB_encryption.svg




                                    Imagen 12. Modo de desencripción
   Fuente: https://es.wikipedia.org/wiki/Modos_de_operaci%C3%B3n_de_una_unidad_de_cifrado_por_
                                                bloques


Relativo a las llaves criptográficas              toman un texto plano o llamado texto claro
Las claves o llaves criptográficas correspon-     y lo convierten en un texto cifrado o desci-
den a información que controla los procesos       frado, para ello utilizan secuencias de letras
de los algoritmos criptográficos, los cuales      o de números.




                                                               Fundación Universitaria
                                                               Fundación Universitaria del
                                                                                       del Área
                                                                                           Área Andina
                                                                                                Andina   71
                                                                                                         21
Estas claves las utilizan los algoritmos cripto-   cualquier medio, podrá acceder a los datos
gráficos como por ejemplo, las firmas digita-      cifrados del sistema.
les y los códigos de autentificación de men-
sajes, también llamadas funciones Hash.            Una frase puede utilizarse como clave para
                                                   un sistema, pero éste debe por algún algo-
Para seleccionar adecuadamente una cla-            ritmo de derivación de claves, expandiéndo-
ve segura se deben tener en cuenta varios          la o reduciéndola de acuerdo a la longitud
factores a saber: la longitud, la cual, a mayor    que se desee, por ejemplo en un algoritmo
número de bits que la componen, el intruso         de cifrado por bloques se utilizan claves de
deberá trabajar con más número de com-             128 bits, la cual es suficiente para que ocupe
binaciones con lo que usualmente se llama          menos espacio y no se reduzca la seguridad.
“fuerza bruta”. Otra característica que debe       De otra parte, las funciones Hash utilizan un
tener la clave de seguridad es la aleatorie-       sistema de cifrado de contraseñas que pro-
dad en lo posible con números, letras y ca-        ducen resultados con la misma longitud, sin
racteres especiales, si se utiliza este método     importar la longitud de la frase original, esto
surte un mejor éxito, pues se genera menor         con el propósito de no inferir la longitud de
probabilidad de desciframiento de la clave.        la frase a partir de la longitud de la clave.
Un último elemento que se debe tener en
cuenta para tener una clave segura es el pe-       Una buena seguridad con algoritmos de cla-
riodo de uso, pues será más insegura esta          ve simétrica se obtienen a partir de 80 bits,
clave cuando más dure su uso, por ello, es         aunque si son de 128 bits, se considerará
aconsejable cambiar las claves con la mayor        una clave muy segura.
regularidad.
                                                   Los sistemas de clave pública utilizan cier-
La fuerza en la seguridad de un sistema ci-        ta estructura matemática para las claves de
frado se basa en que la clave permanezca           sus sistemas, pues se considera que no de-
secreta. Lo aconsejable cuando se tiene un         ben ser completamente aleatorias y que de-
sistema que almacena las claves para que           ben estar relacionadas entre sí, es el caso de
un usuario se autentique, será más seguro          los sistemas RSA, los cuales utilizan claves
si las claves están cifradas, inclusive, suele     públicas generadas a partir de dos núme-
utilizarse como clave de cifrado la misma          ros primos. Lo anterior quiere decir que, los
contraseña que se desea cifrar y cuando el         sistemas de clave pública necesitan longitu-
usuario escriba la contraseña para realizar la     des mayores en sus claves que los sistemas
autenticación, podrá descifrarse la contra-        simétricos, con el fin de dar una seguridad
seña almacenada; en caso de que la contra-         similar.
seña digitada por el usuario y la descifrada
coincidan, el sistema permitirá el ingreso         Una característica de los sistemas que se ba-
del usuario, pues la contraseña es correc-         san en factorización y logaritmos discretos
ta, en otro caso, el resultado del descifrado      es de 3072 bits, con los cuales se obtienen
serán caracteres aleatorios, inentendibles         seguridades similares a un cifrado simétrico
para aquel que pretende atacar el sistema.         de 128 bits.

Las claves son el elemento más débil del sis-      Los conocedores de la seguridad en los sis-
tema, pues si el intruso se hace a la clave por    temas indican que el método de “libreta de




                                                               Fundación Universitaria
                                                               Fundación Universitaria del
                                                                                       del Área
                                                                                           Área Andina
                                                                                                Andina   72
                                                                                                         22
un solo uso” (es un algoritmo de cifrado en        mo de cifrado simétrico muy empleado en
el que el “texto claro” se combina con una         el mundo.
clave aleatoria de igual tamaño que el texto
en claro y solo se usa una vez) es el único        El algoritmo Triple-DES encripta tres veces
que ha sido probado por la matemática y ha         una clave DES, su grado de seguridad varía
sido seguro.                                       dependiendo del método que se elija para
                                                   el ciframiento, es muy lento y por ello ha
Selección de un algoritmo                          sido descartado.
Seleccionar un buen algoritmo de cifrado           RC2, es un algoritmo que reemplazó a DES,
no es fácil, todo dependerá para que se de-
                                                   maneja ciframiento por bloques, la clave es
sea utilizar, pues no existe ningún algorit-
                                                   de tamaño variable y trabaja en bloques de
mo que cubra todas las necesidades de un
                                                   64 bits, es mucho más rápido que el DES, si
sistema. Suele tenerse en cuenta que para
                                                   se elige el tamaño de la clave adecuada, se
obtener un buen algoritmo seguro se han
                                                   vuelve mucho más seguro que DES en ata-
de tener buenos recursos de CPU, que las
frases largas producen mejores resultados          ques de fuerza bruta.
que las claves cortas; que los cifrados asi-       AES - Advanced Encription Standard o Es-
métricos son menos seguros que los simé-
                                                   tándar Criptográfico Avanzado, también es
tricos con la misma longitud de clave, pero
                                                   un algoritmo de cifrado que trabaja por blo-
es mucho más lento; además que el cifrado
                                                   ques simétrico, reemplazó a DES, se puede
por bloques con claves largas y complejas,
                                                   utilizar con información clasificada. El tama-
son mucho más seguros que los cifrados de
                                                   ño de bloques que maneja AES es de 128
flujo. Un consejo es que cuando se cifren
bastantes datos, se haga con una clave si-         bits y sus llaves son de 128, 192 y 256 bits.
métrica y a la vez cifrar la clave simétrica con   Ejercicio para realizar
una clave asimétrica.
                                                   En el lenguaje de programación que usted
Un buen algoritmo de cifrado puede ser,
                                                   domine, elabore un programa que resuelva
utilizar el cifrado AES de 128, 192 o 256 bits
                                                   la siguiente situación:
en el caso de querer realizar un backup onli-
ne, pues con los procesadores actuales, una        María quiere tener una clave muy segura
máquina se tardaría doscientos millones de         a la cual Usted deberá realizarle un cifrado
años en dar con la clave AES de 128 bits.          combinando dos números aleatorios que
La banca mundial utiliza el cifrado AES de         se encuentren entre 10000 y 600.000.000.
128 bits y la Agencia de Seguridad de los Es-      Cuando genere los dos números aleatorios,
tados Unidos también lo usa.                       intercale un dígito del primer número con
                                                   el segundo, así sucesivamente hasta termi-
Los algoritmos más utilizados y seguros son        nar. Esta sería la clave que María utilizaría
los siguientes: DES-Data Encription Stan-          para proteger su información, muestre por
dard, algoritmo de 64 bits, emplea una cla-        pantalla la nueva clave que usted le generó
ve de 56 bits en la ejecución, fue un algorit-     a María.




                                                               Fundación Universitaria
                                                               Fundación Universitaria del
                                                                                       del Área
                                                                                           Área Andina
                                                                                                Andina   73
                                                                                                         23
 1
UNIDAD


     3Unidad 3




  Algoritmos de
   criptografía        Criptografía y
    simétrica     mecanismos de seguridad

                      Autor: Lucy Medina
Introducción   El ciframiento de datos se ha dado desde tiempos remotos,
               con el fin de lograr transmitir cierta información de forma
               confidencial. Por lo anterior, han surgido métodos para que la
               información transite segura por medio de redes inseguras sin
               que le afecte algún ataque que intrusos quisieran realizar a la
               información.

               Por lo expresado se han inventado métodos como los simétri-
               cos y asimétricos que ayuden a los usuarios a comunicarse de
               manera fiable y segura, para ello, han utilizado las matemáti-
               cas como medio para inventar claves o llaves seguras que ase-
               guren la fidelidad de la información transmitida y que entre
               más segura sea la clave generada por los algoritmos basados
               en matemáticas, mayor confianza existirá entre un receptor y
               un transmisor.

               En esta semana se revisarán con más detalle que en anterio-
               res semanas, los algoritmos criptográficos simétricos, con el
               objeto que los estudiantes aprendan a diferenciar entre los
               algoritmos simétricos y asimétricos, los usos que se les da en
               la comunicación, la importancia de proteger la información,
               porque se trata del elemento más preciado por las personas,
               también se revisarán las características que cada uno de los
               algoritmos que pertenece a este tipo de criptografía tiene.




                                             Fundación
                                             Fundación Universitaria
                                                       Universitaria del
                                                                     del Área
                                                                         Área Andina
                                                                              Andina   75
                                                                                       3
U3            Metodología


     En este momento, los estudiantes tienen la fundamentación de lo que es la criptografía, sus
     tipos, el uso que ha tenido las matemáticas en este campo, han aprendido la terminología
     esperada para comprender el tema del ciframiento y lo que éste hace sobre la seguridad. Por
     ello, es pertinente que en este momento se conozca más a fondo los algoritmos simétricos,
     sus usos y características. Para lograr este cometido, se hacen las siguientes recomendacio-
     nes:

     Recomendaciones:
     ■ Realizar las lecturas asignadas.
     ■ Elaborar cada uno de los trabajos asignados.
     ■ Participar en el foro propuesto.
     ■ Realizar las evaluaciones propuestas.
     ■ Cuando no entienda algo, comuníquese con su tutor.
     ■ No continúe con el siguiente tema, hasta que esté perfectamente claro el tema actual.
     ■ Siempre que lea, hágalo entendiendo las ideas.




                                                                Fundación Universitaria del Área Andina   4
                                                                                                          76
U3            Desarrollo temático



     Algoritmos de criptografía simétri-                                        El algoritmo de cifrado DES, trabaja por blo-
                                                                                ques de datos de 64 bits y usa una clave de
     ca
                                                                                56 bits.
     Algoritmo DES y triple DES                                                 El algoritmo realiza combinaciones, sustitu-
     Algoritmo DES                                                              ciones y permutaciones entre el texto que
                                                                                será cifrado y la clave; de igual forma se pro-
     Inicios: Data Encryption Standard. Creado                                  cederá para el descifrado.
     por la IBM en 1975 y el 1977 fue adoptado
     como un Estándar Federal de Procesamien-                                   Al codificar la clave de 64 bits, se reparte
     to de la Información, recibiendo el nombre                                 en 16 bloques de 4 bits. De los 64 bits, solo
     de FIPS PUB-46, por el hoy conocido Insti-                                 se usan 56 para el ciframiento y 8 bits para
     tuto Nacional de Estándares y Tecnología -                                 control de paridad, es decir para verificar la
     NIST. A partir de 1981 la ANSI lo estandarizó                              integridad de la clave; con estos 56 bits, se
     como el ANSI X.3.92, duró como un están-                                   pueden generar 2 a la 56 claves distintas.
     dar federal hasta 1998, año en el cual la Fun-
     dación de las Fronteras Eléctricas, con un                                 Como ejemplo, ver figura 1: Si se tiene el
     ataque de Fuerza bruta, duró 56 horas para                                 Texto Plano para el mensaje, y se encuentra
     desencriptarlo.                                                            en Hexadecimal M= 0123456789ABCDEF


             M: 0000 0001 0010 0011 0101 0110 0111 1000 1001 1010 1011 1100 1101 1110 1111

             L: 0000 0001 0010 0100 0110 0111

             R: 1000 1001 1010 1011 1100 1101 1110 1111

             The first bit of M is “0”. The last bit is “1”. We read from left to right.

             Let K be the hexadecimal key K 133457799BBCDFF1

             K: 00010011             00110100                01010111                01111001     10011011
             10111100                1101111                 11110001


                                          Figura 1. Ejemplo del Algoritmo criptogáfico DES
                                                           Fuente: Propia.




                                                                                            Fundación Universitaria del Área Andina   5
                                                                                                                                      77
En la imagen 1, se muestra el funcionamien-          que al agrandar la clave no se cambiara el
to del Algoritmo DES, con sus tres fases, en         algoritmo de cifrado, pero a los intrusos les
donde en la fase 1, se realizan las permuta-         costara más establecer un ataque. El TDES
ciones del texto plano. En la fase 2, se rea-        utiliza tres claves diferentes (K1, K2, K3),
lizan los desplazamientos, la sustitución,           aunque puede en momentos usar dos cla-
nuevamente se permuta y se realizan los              ves, para ello hace que el K1 = K2, como se
intercambios de bits necesarios. Por último,         muestra en la imagen 2, 3 y 4, esta igualdad
en la fase 3, se ejecuta la permutación con-         hace que la clave efectiva sea de 112 bits.
traria o inversa a la inicial y se genera el crip-
tograma.                                             La seguridad del algoritmos TDES, es supe-
                                                     rior al DES, pero requiere más recursos tanto
Algoritmo Triple DES.
                                                     para cifrar como para descifrar un mensaje o
Este algoritmo también se le denomina                documento.
TDES - Triple Estándar de Cifrado de Datos.
                                                     De este algoritmo hay varios tipos a saber:
En 1999 fue liberado como una mejora del
algoritmo simétrico DES, por el NIST, este al-       ■ DES-EEE3: este es un tipo de cifrado de 3
goritmos recibe su nombre, porque ejecuta              claves diferentes, también es un algorit-
el cifrado DES tres veces y utiliza para ello,         mo TDES.
tres claves.                                         ■ DES-EDE3: este tipo de cifrado utiliza una
                                                       clave distinta para cada una de las opera-
El algoritmo TDES fue inspirado en el DES,
                                                       ciones de triple DES, como son, el cifrado,
pero con la idea de hacerlo más seguro, ya
                                                       el descifrado y el cifrado
que el DES solo utiliza 56 bits para la clave,
mientras que el TDES lo elaboraron para tra-         ■ DES-EEE2 y DES-EDE2: este tipo de cifra-
bajar con 168 bits como longitud de clave.             do, utiliza una clave distinta para la se-
Esta decisión fue tomada para evitar cual-             gunda operación, es decir, para el desci-
quier ataque de fuerza bruta, de tal manera            frado.




                                                                 Fundación
                                                                 Fundación Universitaria
                                                                           Universitaria del
                                                                                         del Área
                                                                                             Área Andina
                                                                                                  Andina   78
                                                                                                           6
                                   Imagen 1. Etapas del Algoritmo DES.
                                                 Fuente:
http://redyseguridad.fi-p.unam.mx/proyectos/criptografia/criptografia/index.php/4-criptografia-simetrica-o-
       de-clave-secreta/42-des-data-encryption-standard/424-aplicacion-del-algoritmo-caso-practico




                                                                     Fundación Universitaria del Área Andina   79
                                                                     Fundación Universitaria del Área Andina   7
                    Imagen 2. Algoritmo TDES o Triple DES
Fuente: http://www.slideshare.net/gopalsakarkar/cryptography-and-encryptions




                        Imagen 3. Algoritmo Triple DES.
Fuente: http://www.slideshare.net/gopalsakarkar/cryptography-and-encryptions




                                                     Fundación
                                                     Fundación Universitaria
                                                               Universitaria del
                                                                             del Área
                                                                                 Área Andina
                                                                                      Andina   80
                                                                                               8
                       Imagen 4. Algoritmo Triple DES, Encripción y desencripción
            Fuente: http://www.slideshare.net/gopalsakarkar/cryptography-and-encryptions



Algoritmo AES                                       a encriptar se parten en segmentos de 16
                                                    byts, o sea 128 bits, o que equivale a un
Este algoritmo fue creado por Vincent Rij-          bloque.
men y Joan Daemen de la Katholieke Uni-
versiteit Leuven en Bélgica al concurso que         Características importantes del algoritmo
organizó el NIST, Instituto Nacional de Nor-        AES, es que utiliza la misma clave para en-
mas Técnicas, con el objeto de encontrar el         criptar y desencriptar, al igual que la clave
mejor algoritmo simétrico de cifrado. Luego         puede formarse con 128, 192 o 256 bits, es-
de ganar el premio como el mejor algoritmo          tas son especificaciones del estándar. Estas
de cifrado, fue propuesto como un estándar          implementaciones reciben los nombres de:
en 2002 y nombrado como el AES- Advan-              AES-128, AES-192 y AES-256.
ced Encryption Standard, convirtiéndose en
el más utilizado actualmente.                       Para generar una clave, se parte de una cla-
                                                    ve inicial de 16 bytes -128 bits, y que se re-
A partir de 2003, el gobierno americano de-         presenta como una matriz de 4 x 4 bytes, a
cidió que el algoritmo AES era lo suficiente-       partir de aquí, se generan diez claves más la
mente seguro para usarlo en la protección           clave inicial. A estas claves se les llama sub-
nacional de la información.                         claves.

AES, es considerado como un algoritmo               Al cifrar una clave se aplica a cada uno de
de cifrado por bloques, cada uno de 128             los estados, unas operaciones o llamadas
bits, de tal forma que los datos que se van         rondas (ver imagen 5), de las que usa once;




                                                                 Fundación
                                                                 Fundación Universitaria
                                                                           Universitaria del
                                                                                         del Área
                                                                                             Área Andina
                                                                                                  Andina   81
                                                                                                           9
cada una de ellas, utiliza una subclave dis-       una ronda final, que se aplica a la última
tinta. Estas subrondas a su vez, se clasifican     subclave.
como: la ronda incial, que se aplica a la sub-
                                                   Dentro de cada ronda se realizan cuatro
clave inicial; luego nuevo rondas estándar,        operaciones como son: SubBytes, Shif-
a las cuales se les aplica las nueve claves        tRows, MixColumns, AddRoundKey, que no
siguientes, una en cada ronda. Por último,         son otra cosa que matrices.




                                Imagen 5. Rondas del Algoritmo AES
                                    Fuente: http://goo.gl/tEqEfj

El esquema de cifrado del algoritmo AES, se muestra en la siguiente imagen:




                                Imagen 6. Algoritmo de Cifrado AES
                                   Fuente: http://goo.gl/tEqEfj




                                                                Fundación Universitaria del Área Andina   82
                                                                Fundación Universitaria del Área Andina   10
Dependiendo si la clave utiliza 128, 192 o        Para generar las claves o llaves, parte la llave
256 bits, el Algoritmo AES realizan las ron-      original en ocho partes de 16 bits cada una.
das correspondientes, así como se observa         Las primeras seis partes son las llaves de la
en la imagen 6. Como se mencionó, cada            k1 a la k6 de izquierda a derecha, es lo que
ronda se componen de cinco matrices, de           utiliza IDEA en la primera ronda. Luego las
las cuales, la primera es la de entrada o ini-    llaves o claves k7 y k8 son las últimas partes.
cio y las otras 4 son transformaciones o fun-     A partir de allí, las 44 llaves se generan con
ciones.                                           un corrimiento circular a la izquierda de 25
                                                  bits sobre la llave original, se extraen las lla-
Para el descifrado, el algoritmo AES utiliza      ves correspondientes y nuevamente se hace
las matrices de Cripto, InvShiftRows (ISR), In-   un corrimiento, de esta forma hasta comple-
vSubBytes (ISB), RoundKey (RK) y Matriz ISB,      tar las 52 claves en los 6 pasos.
para lograrlo, también utilizan rondas para       Algoritmos Blowfish y Twofish
la desencripción.
                                                  Algoritmo Blowfish. Creado por Bruce Sh-
Algoritmo IDEA                                    neier, en 1993. Es un algoritmo de bloques
                                                  simétrico, sencillo de implementar. La lon-
IDEA - International Data Encryption Algo-
                                                  gitud de su clave es variable y puede ir de
rithm, creado por Xuejia Lai y James L. Mas-      32 hasta 448 bits, es decir, 14 bloques de 32
sey en 1991; es un algoritmo usado para en-       bits, lo que le permite un proceso de alta
criptar textos, cuyo bloques son de 64 bits,      seguridad y alta velocidad. Es considerado
para ello requiere de una llave o clave de        más rápido que el algoritmo DES y el IDEA.
128 bits.
                                                  Su trabajo lo realiza por bloques, quie-
Para la encripción de datos utiliza 8 trans-      re decir que toma 64 bits de texto plano y
formaciones o rondas, lo mismo que una            entrega 64 bits de texto cifrado. Genera 18
transformación de salida llamada media            subclaves de 32 bits y toma 4 subclaves de
ronda. Tanto el cifrado como el descifrado        sustitución de 8 X 32.
es el mismo, lo único que cambia son las
                                                  Las claves que genera el algoritmo las alma-
llaves de la ronda, utiliza para ello 52 de 16
                                                  cena en arreglos de permutación, también
bits cada una. Su funcionamiento se basa en
                                                  llamados P-Box. Para el ciframiento utiliza
sumas y multiplicaciones a aplicación del
                                                  dos tipos de operaciones, la suma o adición
XOR, bit a bit, de las operaciones de la suma     y la operación XOR.
se realizan 2 a la 16, de la multiplicación se
realizan 2 a la 16 más 1, lo que genera un        El número de rondas que utiliza este algorit-
número primo.                                     mo es de 16.




                                                               Fundación Universitaria
                                                               Fundación Universitaria del
                                                                                       del Área
                                                                                           Área Andina
                                                                                                Andina   83
                                                                                                         11
                                         Imagen 7. Algoritmo Blowfish
       Fuente: http://lumbreras-criptografia.blogspot.com.co/2013/07/cifrados-por-bloque-blowfish.html


Explicación de la imagen 7, cómo cifra el al-               •   Se aplica la operación binaria XOR a
goritmo Blowfish: Tomado de: http://p.jdiez.                    los bits altos resultantes con la semi-
me/index.php/blowfish/                                          clave 18.
   •     Un bloque de 64 bits de divide en                  •   Se aplica la operación binaria XOR a
         dos de 32 bits.                                        los bits bajos resultantes con la semi-
   •     Luego se aplica la operación binaria                   clave 17.
         XOR a los 32 bits altos con la primera             •   Se recomponen los dos grupos de 32
         de las sub-claves.                                     bits en uno de 64 bits, ya cifrado.
   •     A continuación se aplica la función F          Algoritmo Twofish
         al resultado de la operación xL XOR Pi
         (el paso anterior).                            Creado por Bruce Schneier, John Kelsey,
                                                        Doug Withing, David Wagner, Chris Hall y
   •     Se aplica la operación binaria XOR a           Niels Ferguson en 1998. Este algoritmo es
         los 32 bits bajos (xR en el diagrama)          de cifrado simétrico, que tiene un tamaño
         con el resultado de la operación F(xL).        de 128 bits, sus claves son de hasta 256 bits.
   •     Se intercambian los bits altos con los
         bajos.                                         El algoritmo consta de 16 rondas y de varios
                                                        módulos operativos cuando realiza la en-
   •     Se repite el proceso 16 veces.                 cripción y desencripción. También cifra los
   •     Se deshace el último intercambio.              datos a 285 ciclos de reloj por bloque y los




                                                                      Fundación Universitaria
                                                                      Fundación Universitaria del
                                                                                              del Área
                                                                                                  Área Andina
                                                                                                       Andina   84
                                                                                                                12
datos a 26500 ciclos de reloj por bloque. Tie-       flexible, que se puede implementar eficien-
ne como principal propósito, cumplir con             temente en distintas aplicaciones criptográ-
los criterios de diseño del NIST para AES.           ficas.

Se dice que es un algoritmo simétrico de             Como principal característica del algoritmo
bloques de 128 bits, con longitudes de clave         Twofish, es que utiliza S-boxes con llaves
de 128 bits, 192 bits o de 256 bits, como se         independientes, también usa una clave de
puede ver en la imagen 8. Es un algoritmo            horario compleja.




                                     Imagen 8. Algoritmo Twofish
   Fuente: http://comunidad.dragonjar.org/f156/lista-de-algoritmos-de-encriptacion-8807/index2.html


Algoritmo RC4                                        algoritmo genera un flujo pseudoaleatorio
                                                     de bits, teniendo como premisa la clave
RC4 - Rivest Cipher 4, desarrollado por Ro-          original, el flujo de bits se combina con el
nald Rivest en 1987. Es un algoritmo de ci-          mensaje claro a través de la operación lógi-
frado en flujo y es usado por los protocolos         ca XOR.
para la comunicación como el SSL y WEP. Es
un algoritmo simple y rápido, pero débil,            Una desventaja del algoritmo RC4, es que se
pues sus primeros bytes son predecibles.             puede recuperar la clave secreta, cuando se
                                                     deriva de una concatenación con un vector
El cifrado y descifrado en este algoritmo son        inicial púbico que se usa como WEP, un gran
iguales, debido a la simetría que se presen-         número de mensajes y vectores iniciales la
ta a partir de la operación binaria XOR. Este        clave quede expuesta.




                                                                  Fundación Universitaria
                                                                  Fundación Universitaria del
                                                                                          del Área
                                                                                              Área Andina
                                                                                                   Andina   85
                                                                                                            13
Rc4, además de ser rápido y ser usado por                hemos visto anteriormente es posi-
aplicaciones comerciales serias, es un gene-             ble que este requisito no se cumpla).
rador de números pseudoaleatorios que se
inicializa desde una clave secreta superior a
                                                     •   Poder transformar un texto de lon-
                                                         gitud variable en una huella de ta-
los 256 bytes, utilizada por SSL.                        maño fijo (como el SHA-1 que es de
                                                         160bits).
RC4, se basa en la construcción de dos arre-
glos, uno denominado S-box y el otro arre-           •   Facilidad de empleo e implementa-
glo K. El vector S-box se llena con valores se-          ción.
cuenciales de 0 a 255, mientras que el vector
K se llena con el valor de la semilla hasta ser   Algunos algoritmos de funciones Hash son:
completamente llenado y luego, se mezclan
                                                  El algoritmo MD5 es un algoritmo de fun-
los dos vectores. A continuación, el vector S,
                                                  ción Hash de 128 bits. Toma unos tamaños
se intercambia usando el valor de la semilla.
                                                  determinados a la entrada y como salida,
Como resultado, se tiene la Clave para el al-
                                                  saca los mismos 128 bits, pero números de
goritmo.
                                                  64 pasos.
Algoritmos de funciones de Hash
                                                  El algoritmo SHA-1, por su parte admite blo-
Las funciones Hash tienen como entrada un         ques de 160 bits. la función Hash de com-
conjunto de elementos, que generalmen-            presión es más compleja que la del MD5, por
te son cadenas, las cuales son mapeadas o         ello, es un algoritmo más lento, ya que tiene
convertidas en rangos de salida finitos, que      ochenta pasos y tiene mayor longitud, esto
también son cadenas de longitud fija.             lo hace un algoritmos más seguro y robus-
                                                  to. De este tipo de algoritmos se conocen:
La fórmula que generalmente usan las fun-         SHA-224, SHA-256, SHA-384, y SHA-512. Por
ciones Hash es: H: U -> M x -> h(x).              obvias razones, el más seguro es el SHA-512.
                                                  Pues el que tiene mayor número de bits de
La función Hash actúa como una proyección         salida, utiliza ochenta pasos como el SHA-1,
del conjunto U sobre el conjunto M, el cual       pero su diferencia radica en que el tamaño
puede ser un conjunto de números enteros.         de salida 512 y el SHA-1 es 160. Los tamaños
Por lo general el conjunto U tiene un núme-       del bloque, de palabra e internos el doble
ro elevado de elementos y el conjunto U es        del SHA-1. Como desventaja tienen los al-
un el conjunto U está formado por cadenas         goritmos hash, que entre más seguros, son
con pocos símbolos.                               más lentos.

Según Sergio de Luz (2010), los requisitos        El algoritmo de Residuo de la división, divi-
que deben cumplir las funciones hash:             de el valor de la clave de entrada entre un
   •   Imposibilidad de obtener el texto ori-     número apropiado y utiliza el residuo de la
                                                  división como dirección relativa para el re-
       ginal a partir de la huella digital.
                                                  gistro.
   •   Imposibilidad de encontrar un con-
       junto de datos diferentes que tengan       El algoritmo Media del cuadrado, es otro al-
       la misma huella digital (aunque como       goritmo Hash, el cual toma la clave de en-




                                                              Fundación Universitaria
                                                              Fundación Universitaria del
                                                                                      del Área
                                                                                          Área Andina
                                                                                               Andina   86
                                                                                                        14
trada, la eleva al cuadrado, a continuación        Algoritmo MD5
se extraen algunos dígitos específicos de la
mitad del resultado, con el fin de construir       Desarrollado por Ronald Rivest, 1995. Este
la dirección relativa. Al querer una dirección     algoritmo es uno de los más utilizados en el
de N dígitos, se truncan en ambos extremos         momento. Se basa en dos algoritmos como
de la clave elevada al cuadrado y se toman
                                                   son el MD2 y el MD4, el cual sale de una me-
los N dígitos que se encuentren en la mitad.
Para la clave, se extraen las mismas posicio-      jora que se le hiciera al MD2. Estos proto-
nes de N dígitos.                                  colos producen un número de 128 bits que
                                                   sale de un texto de cualquier longitud.
Al algoritmo Pliegue, utiliza la llave y la ele-
va al cuadrado, luego, unos dígitos específi-      Realmente el algoritmo MD5 reemplazó al
cos se sacan de la mitad del resultado, con el     MD4, que no ha podido superar el rendi-
fin de construir la dirección relativa, cuando
                                                   miento del segundo, pero afortunadamente
se quiere una dirección de N dígitos, se trun-
can los dos extremos de la clave elevada al        no se ha publicado aún ningún compromiso
cuadrado y se toman los N dígitos del me-          sobre la integridad y funcionamiento.
dio. Para clave se extraen las mismas posi-
ciones de N dígitos.                               Como se nota en la imagen 10, el algoritmo
                                                   MD5 inicia con que al mensaje original lo
                                                   rellena hasta completar 448 mod 512, esto
                                                   quiere decir que la longitud del mensaje es
                                                   de 64 bits menos que un entero múltiplo
                                                   de 512. La parte del relleno se conforma de
                                                   un bit en 1 seguido por todos los bits ne-
                                                   cesarios, pero en 0 y la longitud original del
           Imagen 9. Algoritmo Twofish
  Fuente: http://www.redeszone.net/2010/11/09/     mensaje se almacena en los últimos 64 bits
  criptografia-algoritmos-de-autenticacion-hash/   del relleno.




                                                               Fundación Universitaria
                                                               Fundación Universitaria del
                                                                                       del Área
                                                                                           Área Andina
                                                                                                Andina   87
                                                                                                         15
                                     Imagen 10. Algoritmo MD5
                     Fuente: http://neo.lcc.uma.es/evirtual/cdd/graficos/md5.gif



De otra parte, se tiene un valor fijo de 128        tado será un valor en el buffer que no es otra
bits en un buffer, el cual se puede observar        cosa que el hash del mensaje.
como cuatro registros de 32 bits (A, B, C, D)
y se almacena con los valores siguientes:           Algoritmo SHA
A=67452301; B=EFCDAB89; C=98BADCFE;
D=10325476, que se escriben en Hexadeci-            SHA - Secure Hash Algoritm, fue desarrolla-
mal.
                                                    do por NSA, genera números has de 160 bits
Luego de efectuar varias rondas de procesa-         que se generan a partir de:
miento, el algoritmo toma bloques de 512
bits de entrada que son mezclados con los           La longitud máxima de entrada de los men-
128 bits del buffer; de esta forma, el algo-        sajes es de 2 a los 64 bits, los cuales son pro-
ritmo repite el proceso, hasta que todos los        cesados en bloques de 512 bits y el resulta-
bloques de entrada se consuman y el resul-          do producido es de 160 bits.




                                                                  Fundación Universitaria
                                                                  Fundación Universitaria del
                                                                                          del Área
                                                                                              Área Andina
                                                                                                   Andina   88
                                                                                                            16
                                     Imagen 11. Algoritmo SHA-1
Fuente: http://redyseguridad.fi-p.unam.mx/proyectos/criptografia/criptografia/index.php/5-criptografia-
           asimetrica-o-de-clave-publica/55-funciones-hash/552-sha-secure-hash-algorithm




                                                                   Fundación Universitaria
                                                                   Fundación Universitaria del
                                                                                           del Área
                                                                                               Área Andina
                                                                                                    Andina   89
                                                                                                             17
                    Imagen 12. Procesamiento SHA-1 de un único bloque de 512 bits
Fuente: http://redyseguridad.fi-p.unam.mx/proyectos/criptografia/criptografia/index.php/5-criptografia-
           asimetrica-o-de-clave-publica/55-funciones-hash/552-sha-secure-hash-algorithm




                                                                   Fundación Universitaria
                                                                   Fundación Universitaria del
                                                                                           del Área
                                                                                               Área Andina
                                                                                                    Andina   90
                                                                                                             18
Según la Universidad Nacional autónoma              La entrada a cada ronda consta del blo-
de México. (2015). El algoritmo es procesa-         que de 512 bits que se esté procesan-
do en cinco pasos, a saber:                         do (Yq) y los 160 bits de la memoria MD,
1. Se incorporan bits de relleno al mensaje         nótese que cada bloque de 512 bits ac-
   de entrada de tal modo que cumpla:               tualizará el valor de la memoria tempo-
                                                    ral. Cada ronda también hace uso de la
   longitud = 448 mod 512.                          constante aditiva Kt, donde
   El relleno consiste en un uno seguido de         0 ≤ t ≤79 indica uno de los 80 pasos a
   los ceros que sean necesarios. Aunque            lo largo de las cuatro rondas. Los valores
   el mensaje ya tenga la longitud desea-           para dicha constante se muestran en la
   da, se debe efectuar el relleno, por lo          tabla de la imagen 13.
   que el número de bits de dicho relleno
   está en el rango de 1 a 512 bits.
2. A la salida del paso 1, se le añade un
   bloque de 64 bits que represente la lon-
   gitud del mensaje original antes de ser
   rellenado.
   Se inicializa la memoria temporal MD,
   la cual consta de 160 bits y su finalidad
   es almacenar los resultados intermedios
   y finales de la función de dispersión. La      Imagen 13. Valores de la constante aditiva Kt en
   MD consta de 5 registros (A, B, C, D, E) de                         SHA-1
                                                    Fuente: http://redyseguridad.fi-p.unam.mx/
   32 bits cada uno, los valores con los que
                                                  proyectos/criptografia/criptografia/index.php/5-
   se inicializan son los siguientes (valores      criptografia-asimetrica-o-de-clave-publica/55-
   hexadecimales):                                funciones-hash/552-sha-secure-hash-algorithm
   A=67452301
   B=EFCDAB89                                    4. Una vez que se procesan los L bloques
                                                    de 512 bits, el resumen del mensaje son
   C=98BADCFE
                                                    los 160 bits de salida del último bloque.
   D=10325476
                                                 Códigos de autenticación de mensaje
   E= C3D2E1F0
                                                 (MAC) y algoritmo HMAC
3. Se procesa el mensaje por bloques de
   512 bits, cada uno pasa por un módu-          Los códigos de autenticación de mensaje
   lo que consta de 4 rondas de procesa-         – MAC, es un trozo de información que se
   miento de 20 pasos cada una. Las ron-
                                                 usa para autenticar un mensaje. Estos va-
   das tienen una estructura similar, con la
   excepción de que cada una ocupa una           lores MAC se calculan por medio de la fun-
   función lógica primitiva diferente (f1,       ción hash criptográfica con clave secreta K,
   f2, f3 y f4). Esta parte del algoritmo se     la cual solo es conocida por el emisor y el
   muestra en la imagen 12.                      receptor.




                                                              Fundación Universitaria
                                                              Fundación Universitaria del
                                                                                      del Área
                                                                                          Área Andina
                                                                                               Andina   91
                                                                                                        19
Las funciones MAC ideales son aquellas que      Algoritmo HMAC
mapean de forma aleatoria todos los posi-
bles valores del mensaje de entrada M en        HMAC, es un mecanismo para autenticar
salidas de tamaño de N bits. Estas funciones    mensajes. Es un entorno de autenticación
MAC se dice son seguras si resisten a la com-   en entornos seguros SSL, por medio de la
putación de nuevos valores Hash.                operación MAC en la que interviene funcio-
                                                nes hash.
Existen distintas funciones MAC, como por
ejemplo:                                        Los HMAC con clave son algoritmos que ga-
                                                rantizan un mensaje íntegro. Un algoritmo
CBC-MAC: La idea detrás de este algoritmo       HMAC tiene dos parámetros, el uno, es una
es la de convertir un algoritmo de cifrado
                                                entrada del mensaje y una clave secreta,
simétrico en una función MAC. El funciona-
                                                que solo la conocerán el emisor y los posi-
miento básico consiste en cifrar el mensaje
                                                bles receptores. El emisor utiliza la función
usando un algoritmo en modo CBC y tirar
todo el resultado de texto cifrado a excep-     HMAC para generar un valor, es decir el có-
ción del último bloque.                         digo de autenticación de mensajes, forma-
                                                do por la compresión de la clave secreta y
HMAC: dado que una función MAC es un            la entrada del mensaje. Este mensaje es en-
mapeo aleatorio, y que las funciones hash       viado junto al código de autenticación de
se comportan como tales, podemos explo-         mensajes, el receptor calcula el código de
tar la idea de utilizar una función hash para   autenticación de mensajes en el mensaje
implementar una función MAC. La opción          recibido con la misma función HMAC que
más popular hoy en día es la de usar HMAC-      usó el emisor, luego, el receptor hace una
SHA-256.                                        comparación con el resultado que calculó
                                                el código de autenticación de mensajes que
UMAC: las funciones UMAC parten de la pre-
                                                ha recibido, de donde se pude deducir que
misa de que el atacante necesita interactuar
                                                coinciden o no los mensajes. En el momento
con el sistema para comprobar si el resul-
tado MAC que ha generado es válido o no.        que los valores coincidan, el mensaje es re-
Es decir, no existe nada parecido a un ata-     cibido correctamente, por lo que el receptor
que exhaustivo off-line contra las funciones    se percata que el emisor si es parte de su co-
MAC. Así, argumentan que se puede reducir       munidad, porque comparten la clave.
el resultado a tan solo 64 bits. Sin embargo,
no existe un estándar bien definido de fun-     Una función criptográfica HMAC, se dice
ciones MAC como ocurre con las funciones        que es fuerte criptográficamente, cuando
hash, lo que tiene efectos contraproducen-      su tamaño, calidad de clave, tamaño de la
tes a largo plazo desde el punto de vista de    longitud del resultado del hash en bits es
la implementación.                              adecuado. Los algoritmos más comunes de
                                                tipo HMAC son:
Algunos usos que se le dan a las MAC es
para autenticación, es decir que tanto re-      MD5, ya explicado en este escrito, que re-
ceptor como emisor solamente comparten          cordando, utiliza 128 bits, con un mensaje
la clave de la función MAC.                     de longitud variable, cuya clave secreta se




                                                            Fundación Universitaria
                                                            Fundación Universitaria del
                                                                                    del Área
                                                                                        Área Andina
                                                                                             Andina   92
                                                                                                      20
combina y procesa con algoritmos hash           Ejercicio para realizar
HMAC-MD5, cuyo resultado es un hash de
                                                Utilizando algunos de los lenguajes de pro-
128 bits y el hash se adjunta al mensaje ori-
                                                gramación que conoce, realice un algoritmo
ginal y se envía al extremo remoto.
                                                RC4, utilizando dos vectores, el uno deno-
                                                mínelo S y el otro K. en el vector S almacene
SHA: SHA-1 utiliza una clave de 160 bits. El
                                                valores secuenciales de 0 a 250 y en el vec-
mensaje de longitud variable y la clave se-
                                                tor K almacene las semillas producidas por
creta compartida de 160 bits se combinan y      números randómicos. Luego mezcle los dos
se procesan con el algoritmo de hash HMAC-      vectores así: intercambie el valor de una se-
SHA1. El resultado es un hash de 160 bits. El   milla con un número del vector S, así obten-
hash se adjunta al mensaje original y se en-    drá la clave para el algoritmo. Imprima los
vía al extremo remoto.                          dos vectores




                                                            Fundación Universitaria
                                                            Fundación Universitaria del
                                                                                    del Área
                                                                                        Área Andina
                                                                                             Andina   93
                                                                                                      21
 1
UNIDAD


     3Unidad 3




  Algoritmos de
   criptografía        Criptografía y
    simétrica     mecanismos de seguridad

                      Autor: Lucy Medina
Introducción   El conocimiento siempre ha sido una de las facultades más
               preciadas del ser humano, por lo tanto, puede ser convertido
               en información y esta a su vez en elemento vital para cual-
               quier empresa o ciudadano. De ahí que quiera ser preserva-
               do, guardado, secreto e inviolable, por lo que ha acudido a la
               representación simbólica y que se ha requerido simbolizar de
               diferentes formas con miras a que la información permanezca
               siempre en secreto. Para lograrlo, se han inventado los algo-
               ritmos criptográficos para transformar dicha información en
               secreto a través de claves, estas se conocen hoy en día como
               representaciones o criptogramas, los cuales son ininteligibles
               para quienes no conocen la clave o la forma cómo leer un
               mensaje cifrado, pero esto se ha logrado a través de la cripto-
               grafía y específicamente por medio de los algoritmos que se
               han desarrollado para tal fin.

               Es así que la criptografía cubre dos tipos, de una parte, los
               algoritmos criptográficos simétricos que se estudiaron en la
               semana anterior a esta y que se refieren a que se usa la misma
               clave para cifrar y descifrar información; pero de otra parte
               existen también los algoritmos asimétricos, los cuales se dis-
               tinguen por utilizar dos claves diferentes, pero con la caracte-
               rística que si un mensaje es cifrado con una clave, podrá ser
               descifrada con la otra clave, estos algoritmos utilizan una cla-
               ve pública y la otra privada.

               En el transcurso de este escrito se explicará precisamente
               cómo es el manejo de los algoritmos asimétricos, cómo fun-
               cionan y qué usos se les da.




                                             Fundación
                                             Fundación Universitaria
                                                       Universitaria del
                                                                     del Área
                                                                         Área Andina
                                                                              Andina   95
                                                                                       3
U3            Metodología


     En este momento, los estudiantes tienen la fundamentación de lo que es la criptografía, sus
     tipos, el uso que ha tenido las matemáticas en este campo, han aprendido la terminología
     esperada para comprender el tema del ciframiento y lo que éste hace sobre la seguridad. Por
     ello, es pertinente que en este momento se conozca más a fondo los algoritmos asimétricos,
     sus usos y características. Para lograr este cometido, se hacen las siguientes recomendacio-
     nes:

     Recomendaciones:
     ■ Realizar las lecturas asignadas.
     ■ Elaborar cada uno de los trabajos asignados.
     ■ Participar en el foro propuesto.
     ■ Realizar las evaluaciones propuestas.
     ■ Cuando no entienda algo, comuníquese con su tutor.
     ■ No continúe con el siguiente tema, hasta que esté perfectamente claro el tema actual.
     ■ Siempre que lea, hágalo entendiendo las ideas.




                                                                Fundación
                                                                Fundación Universitaria
                                                                          Universitaria del
                                                                                        del Área
                                                                                            Área Andina
                                                                                                 Andina   96
                                                                                                          4
U3            Desarrollo temático



     Algoritmos de criptografía asimé-                El procedimiento básicamente es el siguien-
                                                      te:
     trica
                                                      Cuando se calcula las claves pública y priva-
     Algoritmo RSA                                    da, se hace la siguiente operación:
     Rivest, Shamir y Adleman - RSA, creadores
     del algoritmo en 1978. Es un algoritmo uti-      Se consiguen dos números primos distintos,
                                                      que se llamarán p y q, luego se encuentra n,
     lizado para realizar transmisión en canales
                                                      a través de la siguiente fórmula:
     inseguros.
                                                      n = p *q, siendo n el módulo de las dos cla-
     Para generar las claves, este algoritmo uti-
                                                      ves.
     liza dos números primos muy grandes, po-
     sitivos y de longitud similar en bits; gene-     Luego se calcula la función de Euler así: Ø
     ralmente entre 100 y 300 dígitos. La clave       (n) = (p-1)(q-1)
     pública se genera a partir de una multiplica-
     ción entre los dos números primos grandes        Se calcula e, para ello se toma un número
     encontrados, mientras que la clave privada       entero positivo menor que Ø (n), cumplien-
     se consigue a partir de haber encontrado un      do con la propiedad de ser primo relativo de
     número e que no tenga múltiplos comunes          Ø (n).
     con módulo Ø.
                                                      La e, será el exponente de la clave pública,
     RSA trabaja con longitudes variables para        teniendo en cuenta siempre que e > n/2 y e
     las claves, pero nunca menos de 1024 bits.       será la clave pública.
     La seguridad de este algoritmo es alta de-
                                                      Para calcular la clave privada, se hace por
     bido a que utiliza lo que comúnmente se
                                                      aritmética modular, a la que se le aplica el
     denomina función computacional, que con-
                                                      denominado algoritmo de Euclides extendi-
     siste en realizar lo que en matemática se lla-   do (calcula el máximo común divisor-MCD).
     ma exponenciación modular antes de crear
     las claves, pero es muy complicado realizar      Al calcular las claves pública y privada, se
     la operación inversa, mucho menos extraer        almacenan en lugar seguro y deberá pro-
     las raíces del módulo Ø, por cuanto para ha-     tegerse amabas claves por medio de un al-
     cerlo, se requiere conocer el número e cal-      goritmo criptográfico simétrico, ya que una
     culado.                                          vez que se tienen las llaves pública y priva-




                                                                  Fundación
                                                                  Fundación Universitaria
                                                                            Universitaria del
                                                                                          del Área
                                                                                              Área Andina   97
                                                                                                   Andina   5
da, e y d, respectivamente, se inicia con el          Este mensaje se descifra con la llave privada.
cifrado así:
c = me (mod (n)), siendo m el mensaje origi-          Es un algoritmo relativamente rápido y muy
nal y c el mensaje cifrado, haciéndose este
ciframiento con la llave pública.                     utilizado como sistema de llave pública, in-
                                                      cluye la firma digital y empleado para en-
Para descifrar el mensaje se procede así:             criptar y hacer envío de la clave simétrica
m = cd (mod (n)), siendo m el mensaje origi-
nal pero visto numéricamente y c es el men-           que será usada luego al realizar comunica-
saje cifrado.                                         ción cifrada ver imagen 1.




                                        Imagen 1. Algoritmo RSA
          Fuente: http://html.rincondelvago.com/redes-y-autenticacion-de-firmas-digitales.html


Una importante característica de RSA, es              Ejemplo, para cifrar el mensaje “muc”, uti-
que un mensaje que ha sido cifrado con la             lizando el algoritmo RSA:
clave pública, se descifra con la llave priva-        Primer paso: seleccionar dos números pri-
da, aunque también, si se ha cifrado con la           mos grandes.
clave privada, se puede descifrar con la llave
pública.                                              p: 83
                                                      q: 89
En los algoritmos asimétricos, cuando se ci-
fra un mensaje con clave pública o privada,           Segundo paso: se calcula n.
se afirma que lo que cifra una, sólo la desci-
frará la otra y viceversa.                            n = p * q = 83 * 89 = 7387
                                                      Tercer paso: calcular Ø (n).
Existen tres pasos básicos para realizar la
criptografía asimétrica con el algoritmo              Ø (n)= (p - 1)(q - 1) = (83 - 1)(89 - 1)= 7216
RSA, a) se generan las claves pública y priva-
da, b) se cifra el mensaje utilizando la llave        Cuarto paso: se selecciona e como un nú-
                                                      mero relativo de Ø (n).
pública, c) se descifra el mensaje, para ello
se utiliza la llave privada.                          e = 5009




                                                                    Fundación
                                                                    Fundación Universitaria
                                                                              Universitaria del
                                                                                            del Área
                                                                                                Área Andina
                                                                                                     Andina   98
                                                                                                              6
Quinto paso: se calcula d, utilizando un algoritmo que calcule el mcd entre e y ø (n), luego
se aplica módulo ø (n).

d = 2753

Sexto paso: se cifra el mensaje, convirtiendo el texto “MUC” a numérico con su ASCII equi-
valente.

MUC = M---77      U---85   C---67

Se aplica la fórmula: me (mod(n))

c1 = 77 5009 (mod(7387)) = 6663

c2 = 85 5009 (mod(7387)) = 5440

c3 = 67 5009 (mod(7387)) = 7128

Séptimo paso: se descifra el mensaje

c1= 6663

c2= 5440

c3= 7128

Se aplica la siguiente fórmula para descifrar:

m = cd (mod(n))

m1 = 6663 2753 (mod(7387)) = 77

m2 = 5440 2753 (mod(7387)) = 85

m3 = 7128 2753 (mod(7387)) = 67

Algoritmo ElGamal
Este algoritmo fue creado por Taher ElGamal en 1984, se basó en el algoritmo de Diffie-
Hellman, el funcionamiento de ElGamal, es a través del logaritmo discreto, que se basa en la
siguiente expresión:

Son dos los usos que se le dan a este algoritmo, para generar firmas digitales y para cifrar y
descifrar información.

ElGamal tiene tres componentes básicos: a) Un generador de claves, b) El algoritmo de cifra-
do y c) el algoritmo de descifrado.




                                                             Fundación
                                                             Fundación Universitaria
                                                                       Universitaria del
                                                                                     del Área
                                                                                         Área Andina
                                                                                              Andina   99
                                                                                                       7
Ejemplo (tomado de https://es.wikipedia.org/wiki/Cifrado_ElGamal):

Se eligen los siguientes valores:

           (primo elegido al azar)

           (generador)

            (llave privada elegida al azar)

                                                         (llave pública)

La llave pública será                  y la privada       .

El texto claro es          .   Escoge un              aleatorio:



                                                              .

El texto cifrado               está compuesto por la tupla                              .

El texto cifrado puede ser descifrado por utilizando la llave privada               .

Utilizando el Teorema de Fermat:



Algoritmo DSA
Digital Signature Algorithm – DSA, desarrollado en 1991 por el National Institute of Stan-
dards and Technology – NIST, es un algoritmo de firma digital, no para cifrar.

DSA tiene tres fases o etapas para que funcione: a) generación de claves, b) firma y c) ve-
rificación. Los ítems a) y b) los ejecuta el emisor, mientras que c) la realiza el receptor (ver
imagen 2).




                                                                  Fundación
                                                                  Fundación Universitaria
                                                                            Universitaria del
                                                                                          del Área
                                                                                              Área Andina
                                                                                                   Andina   100
                                                                                                            8
                                         Imagen 2. Algoritmo DSA
  Fuente: http://redyseguridad.fi-p.unam.mx/proyectos/criptografia/criptografia/index.php/5-criptografia-
           asimetrica-o-de-clave-publica/56-firmas-digitales/562-dsa-digital-signature-algorithm


Según Universidad Nacional Autónoma de                 2. En la firma
México. (2013), los parámetros que usa el al-              •   k: Número pseudoaleatorio único
goritmo DSA son:                                               para cada firma.
1. Para generación de claves: los datos son                •   s: Valor que corresponde a la firma.
   públicos excepto x                                      •   r: Valor de comprobación de la firma.
   •   p: número primo de 512 bits de lon-             3. Para la verificación
       gitud como mínimo.                                  •   w: Valor que se requiere en el desci-
   •   q: número primo de 160 bits de lon-                     frado de la firma.
       gitud.                                              •   u1: Dato relativo al valor del hash del
   •   g: parámetro utilizado para calcular
                                                               mensaje en claro.
       la clave pública.                                   •   u2: Dato relativo a la Integridad de la
                                                               firma.
   •   x: clave privada del remitente.
                                                           •   v: Valor de comprobación y verifica-
   •   y: clave pública del remitente.                         ción de firma.




                                                                     Fundación
                                                                     Fundación Universitaria
                                                                               Universitaria del
                                                                                             del Área
                                                                                                 Área Andina
                                                                                                      Andina   101
                                                                                                               9
Algoritmo Diffie-Hellman                            Diffie-Hellman fue el primer algoritmo de
                                                    clave pública. Diffie-Hellman es utilizado
Creado por Whitfield Diffie y Martin Hell-
                                                    para distribuir o intercambiar llaves, pero
man. Este algoritmo hace que dos personas
que se quieren comunicar por un canal inse-         no para cifrar o descifrar mensajes. Es un al-
guro se pongan de acuerdo en un valor nu-           goritmo seguro, debido a la complejidad en
mérico, sin que una tercera persona tenga           el cálculo de los logaritmos discretos en un
acceso pleno a la conversación.                     campo finito




                        Imagen 3. Funcionamiento del protocolo Diffie-Hellman
         Fuente: http://www.javiercampos.es/blog/2011/07/22/el-algoritmo-de-diffie-hellman/




                                                                 Fundación Universitaria del Área Andina   10
                                                                                                           102
En la imagen anterior, se muestra cómo el emisor selecciona dos números A y B; el receptor
también escoge dos números llamados R, S. Estos individuos pueden comunicarse por ca-
nales denominados no seguros, que pueden ser como el correo electrónico o cualquier otro
medio. Ambos, receptor y emisor hacen que el otro conozca los números A y R.

Enseguida, el emisor calcula un nuevo número Z utilizando la siguiente fórmula: Z = (R ^ B)
% A.

También el receptor calcula su número T, usando la siguiente fórmula:

T = (R ^ S) % A.

Tanto emisor como receptor hacen públicos sus números Z y T.

Nuevamente el emisor calcula un número W, utilizando la siguiente fórmula:

W = (T ^ B) % A.

Y el Receptor calcula su número V, con la fórmula: Y = (Z ^ S) % A.

Tanto el número W como V, son los mismos, por lo que emisor y receptor comparten un se-
creto, es decir, sus claves que las pueden utilizar para cifrar sus mensajes. Los números W y V,
han de ser muy grandes y sobre todo, números primos.




                           Imagen 4. Intercambio de claves de Diffie-Hellman
         Fuente: http://www.itesa.edu.mx/netacad/networks/course/module7/7.3.2.3/7.3.2.3.html




                                                                  Fundación Universitaria
                                                                  Fundación Universitaria del
                                                                                          del Área
                                                                                              Área Andina
                                                                                                   Andina   103
                                                                                                            11
Un sencillo ejemplo del algoritmo de Diffie-    da, la cual pueden usar para cifrar, utilizan-
Hellman se aprecia en la imagen 4, en don-      do también los algoritmos de hash.
de se aprecia que el método se utiliza para
                                                Ejercicio para realizar
intercambiar llaves que cifran datos con
                                                Utilizando las fórmulas de los pasos descri-
seguridad, es así que tanto el emisor como
                                                tos en el algoritmo de Diffie-Hellman, halle
el receptor, utilizando el algoritmo DH, pue-   las claves que un emisor y un receptor pue-
den establecer una clave secreta comparti-      den compartir para cifrar sus mensajes.




                                                            Fundación Universitaria
                                                            Fundación Universitaria del
                                                                                    del Área
                                                                                        Área Andina
                                                                                             Andina   104
                                                                                                      12
 1
UNIDAD


     4Unidad 4




  Criptografía
  en la capa de        Criptografía y
   aplicación     mecanismos de seguridad

                      Autor: Lucy Medina
Introducción   Son dos los temas que en este escrito nos ocupan, de una par-
               te, la capa de Aplicación del modelo TCP/IP y de otra, los pro-
               tocolos utilizados como medida de seguridad de dicha capa.

               En cuanto a la capa de aplicación, esta integra tres de los nive-
               les utilizados en el modelo OSI como son: Aplicación, Presen-
               tación y Sesión. En esta capa de aplicación del modelo TCP/
               IP, se utilizan todas las aplicaciones o programas que pueden
               comunicarse con otros a través de la red. Esta capa ofrece los
               servicios para trabajar con las aplicaciones de usuario.

               Entre otros protocolos utilizados en esta capa se encuentran:

               FTP: File Transfer Protocol (protocolo de transferencia de ar-
               chivos).

               HTTP: Hypertext Transfer Protocol (protocolo de transferen-
               cia de hipertexto).

               SMTP: Simple Mail Transfer Protocol (protocolo de transferen-
               cia de correo simple).

               DNS: Domain Name System (sistema de nombres de domi-
               nio).

               TFTP: Trivial File Transfer Protocol (protocolo de transferencia
               de archivo trivial).

               El modelo TCP/IP es la esencia de Internet, sirve para enlazar
               computadoras que utilizan diferentes sistemas operativos,
               que pueden incluir, computadoras de escritorio, minicompu-
               tadoras y computadoras centrales sobre redes de área local y
               área extensa.

               En esta semana se revisarán con más detalle los algoritmos
               criptográficos utilizados como seguridad en la capa de Aplica-
               ción del modelo TCP/IP, con el objeto de centrar el tema de la
               criptografía y hacer que los estudiantes conozcan por qué es
               tan importante la criptografía en la comunicaciones, especial-
               mente cuando se transmite información sensible entre dos o
               más máquinas.




                                              Fundación
                                              Fundación Universitaria
                                                        Universitaria del
                                                                      del Área
                                                                          Área Andina
                                                                               Andina   106
                                                                                        3
U4            Metodología


     En este momento, los estudiantes han de entender la criptografía y los algoritmos simé-
     tricos y asimétricos, por lo tanto, se revisa en este escrito cómo se usan en la vida práctica
     los algoritmos y cuáles son los que se emplean para poder realizar transmisiones seguras a
     través de la red Internet o de las redes LAN en las cuales operamos todos los días, sin prestar
     demasiado cuidado.

     Para lograr el anterior cometido, se hacen las siguientes recomendaciones:

     Recomendaciones:
     ■ Realizar las lecturas asignadas.
     ■ Elaborar cada uno de los trabajos asignados.
     ■ Desarrollar el taller propuesto.
     ■ Realizar las evaluaciones propuestas.
     ■ Cuando no entienda algo, comuníquese con su tutor.
     ■ No continúe con el siguiente tema, hasta que esté perfectamente claro el tema actual.
     ■ Siempre que lea, hágalo entendiendo las ideas.




                                                                  Fundación Universitaria del Área Andina   4
                                                                                                            107
U4             Desarrollo temático



     Criptografía en la capa de aplica-                  ser, de esta manera se brinda confianza a
                                                         quien envía como a quien recibe el mensaje,
     ción
                                                         esto es lo que se denomina comunicación
     SSL/TLS, SET y OPENSSL TOOLKIT                      segura SSL/TLS.

     SSL/TLS                                             De otra parte, el Certificado digital SSL/TLS,
                                                         es un documento digital único que certifica
     a. SSL - Secure Sockets Layer - Capa de             la vinculación entre una persona o entidad
        Conexiones Seguras. Este protocolo               con su clave o llave pública. Este documen-
        utiliza certificados digitales con el fin de     to contiene la siguiente información del
        establecer comunicaciones seguras por            propietario de la llave: nombre, dirección,
        internet.                                        correo electrónico, empresa a la que perte-
     La importancia de este protocolo radica en          nece su llave pública y la información propia
     que se puede enviar información por la web,         del certificado, como por ejemplo: el perio-
     pues los datos se ocultan por medio de mé-          do de validez, el número único de serie, el
     todos criptográficos cuando se navega por           nombre de la autoridad Certificadora que
     la red. Este protocolo se utiliza en bancos,        emitió el certificado, la firma digital de la
     tiendas en líneas y todos los servicios que se      Autoridad Certificadora cifrada con su llave
     necesiten al enviar datos personales o con-         privada, entre otros.
     traseñas, pero no todos los sitios web utili-
     zan SSL, por lo que deberá tenerse cuidado.         Para ejemplificar el uso de SSL/TLS, teclee
                                                         la siguiente dirección: www.facebook.com,
     Vale la pena que se entienda el término Au-         verá usted que figura un candado, (ver ima-
     toridad Certificadora - AC, que hace referen-       gen 1) todo dependerá del navegador que
     cia a una entidad que garantiza que quien           se utilice. Ese Candado indica que el SSL/TLS
     posea un certificado digital, sea quien dice        ha hecho el trabajo adecuadamente.

        Candado



                                    Imagen 1. Sitio Web oficial de Facebook
                                                Fuente: Propia.




                                                                       Fundación
                                                                       Fundación Universitaria
                                                                                 Universitaria del
                                                                                               del Área
                                                                                                   Área Andina
                                                                                                        Andina   108
                                                                                                                 5
                              Imagen 2. Funcionamiento general de SSL/TLS
               Fuente: http://revista.seguridad.unam.mx/numero-10/el-cifrado-web-ssltls


SSL-Secure Socket Layer: definido como               SSL permite que la comunicación fluya en-
un protocolo de seguridad, que permite la            tre emisor y receptor de manera que sus co-
interacción entre usuarios de forma segura.          municaciones no puedan ser interceptadas,
Sus objetivos son: ofrecer seguridad cripto-         modificadas o alteradas de alguna forma.
gráfica, interoperabilidad, extensibilidad y         Está conformado por dos niveles o capas: de
eficiencia relativa, cuando se realiza una co-       una parte, se encuentra el SSL Record Pro-
municación por la red.                               tocol, y de otra el SSL Handshake Protocolo,
                                                     como se muestra en la imagen 3.

                                                     En cuanto al SSL Record Protocol, tiene co-
                                                     nexión privada y utiliza el cifrado simétrico
                                                     (una sola clave para emisor y receptor) para
                                                     el envío de mensajes, para ello utiliza el al-
                                                     goritmo DES, RC4, entre otros.

                                                     Cuando SSL Record Protocol va a cifrar un
                                                     mensaje, negocia, por ejemplo con SSL
                                                     Handshake Protocol para que en cada cone-
                                                     xión se use solo una clave.

                                                     Los mensajes en esta capa, incluyen código
      Imagen 3. Capas de protocolos en SSL           de autenticidad del mensaje (MD5, SHA...),
                 Fuente: Propia.                     es decir la MAC.




                                                                  Fundación
                                                                  Fundación Universitaria
                                                                            Universitaria del
                                                                                          del Área
                                                                                              Área Andina
                                                                                                   Andina   109
                                                                                                            6
En cuanto a SSL Handshake Protocol, utili-           ello, permite agregar niveles de seguridad
za el cifrado asimétrico, con el fin de lograr       adicional, como por ejemplo, Secure Elec-
la autenticidad del emisor y receptor, esto          tronic Transaction - SET.
lo hace mediante algoritmos como el RSA,
DDS, entre otros.                                    El protocolo SSL permite que haya tres tipos
SSL no depende de los protocolos que se              de conexión a saber: Autentificada, semi-
implementan en la capa de aplicación, por            autentificada y anónima.




                                    Imagen 4. SSL Record Protocol
 Fuente: http://2.bp.blogspot.com/_YXGbhu29rAY/STYaSykeO9I/AAAAAAAAAAs/TEynPsdg-J8/s400/recordssl.jpg

En la imagen anterior, se nota cómo se reali-        de la red y cómo se realiza el cifrado y desci-
za la comunicación entre un cliente y un ser-        frado del mensaje en las capas internas del
vidor, cuando se envía un mensaje a través           y más bajas del sistema.




                                  Imagen 5. SSL Handshake Protocol
                                           Fuente: Propia.




                                                                    Fundación
                                                                    Fundación Universitaria
                                                                              Universitaria del
                                                                                            del Área
                                                                                                Área Andina
                                                                                                     Andina   110
                                                                                                              7
En la imagen 5, se muestra el recorrido que         el protocolo en un campo llamado con-
se hace desde que se solicita una conexión          tent-type, el cifrado y empaquetamien-
al servidor, hasta cuando esta es recibida por      to lo hace por medio de un código de
el mismo servidor. SSL Handshake Protocol,          autenticación o MAC.
permite mensajes opcionales o dependien-
tes de la situación, como por ejemplo cuan-         TLS trabaja en un canal seguro y se hace
do se envía e certificado y se verifica el certi-   un ciframiento de claves entre cliente y
ficado, así como que se requiere certificado,       servidor, se negocia la criptografía del
que figuran en las distintas capas tanto del        mensaje, se autentican las claves del ci-
cliente como del servidor.                          frado y se realiza la transmisión segura.
b. TLS - Transport Layer Security, protocolo        Los cifrados de mensajes los asegura TLS
   que se basa en SSL y presenta pocas dife-        para que sean transmitidos en internet
   rencias. Permite la gestión de las comu-         con tecnología de cifrado estándar, esto
   nicaciones para que estas sean seguras           hace que los correos electrónicos envia-
   cuando se realizan transacciones comer-          dos no sean interceptados por intrusos.
   ciales por medio de la red.
                                                    TLS funciona de la siguiente manera:
    TLS es un certificado que hace parte
                                                    1. Habilitar TLS en los servidores de
    de la nueva generación del certificado
                                                       correo del emisor y el receptor, para
    SSL, está destinado al e-comerce, que
                                                       que cualquier información que se
    encripta los datos cuando se hace in-
                                                       intercambie entre ellos esté cifrada,
    tercambio de información por la web,
                                                       incluyendo el asunto, el texto y los
    protege los datos confidenciales como
                                                       adjuntos del correo enviado.
    las tarjetas de crédito o cualquier otra
    información. Para garantizar el inter-          2. En el momento que el emisor se co-
    cambio de datos de forma segura utiliza            necta con el recetor del mensaje, el
    aplicaciones como el HTTP, POP3, IMAP,             sistema debe verificar automática-
    SSH, SMTP, NNTP.                                   mente que esté habilitado TLS en el
                                                       servidor de correos del cliente.
    La encripción la realiza por medio de
                                                    3. De estar habilitado TLS en los dos
    dos protocolos encapas distintas, ellos
                                                       servidores de correos, se establece
    son el protocolo TLS Record Protocol y
                                                       la conexión TLS segura, por medio
    el TLS Handshake Protocol que hace las
                                                       de un “Handshake” o apretón de
    veces de mutuo acuerdo.
                                                       manos, que un procedimiento de
    Añadiendo algo más de lo visto ante-               protocolo de intercambio.
    riormente, el Record Protocol, autenti-         4. En el paso anterior se intercambian
    ca para que la transmisión de datos se             los certificados TLS, de tal forma que
    haga por medio de una conexión priva-              si el servidor del emisor confía en el
    da, fiable e íntegra entre emisor y recep-         certificado del servidor del receptor,
    tor. En cuanto al Handshake Protocol, él           se inicia la sesión TLS y el correo es
    negocia el mensaje de forma segura, es             enviado por medio de una conexión
    decir, que en cada mensaje especifica              segura.




                                                            Fundación
                                                            Fundación Universitaria
                                                                      Universitaria del
                                                                                    del Área
                                                                                        Área Andina
                                                                                             Andina   111
                                                                                                      8
    Al utilizar TLS no se requiere interven-        SET funciona así:
    ción ni del emisor ni del receptor, lo que
    lo hace confiable, estable, previo acuer-       Mediante certificados digitales, tanto el co-
    do entre el servidor de correos de las          merciante como el cliente, se identifican y
    personas que se quieren comunicar.              autentican.

    Por todo lo anterior, TLS se ha converti-       El comerciante no puede ver ni conservar
    do en un estándar que entrega benefi-           los datos del cliente, ni de su tarjeta una vez
    cios para quienes intercambian correos          que se cierre la transacción.
    por medio de la web, beneficios como la
                                                    Los datos viajan por la red, encriptados.
    mayor protección, ofrece disponibilidad
    en la mayor parte de servidores de co-          Los pasos que sigue una transacción SET,
    rreo, permite escanear los correos para         son los siguientes (tomado de El Portal de
    buscar virus, reduce costos, pues una           los Negocios en Internet):
    empresa que lo utilice solo adquirirá
    el certificado TLS, por último, la imple-
                                                    ■ Cuando se va a cerrar el pedido, el cliente
                                                      recibe la firma digital de la tienda y veri-
    mentación de TLS es muy sencillo, solo
                                                      fica su validez.
    basta con configurarlo en los servidores
    de correo y no se necesita tenerlo insta-       ■ El cliente envía al comerciante la siguien-
    lado en las estaciones de trabajo indivi-         te información firmada digitalmente:
    duales.                                            •   Los datos del pedido (básicamente:
                                                           identificación del comerciante, im-
SET - Secure Electronic Transactions-                      porte y fecha).
Transacciones electrónicas seguras, fue
propuesto por Visa y Master Card, ayuda-               •   La orden de pago, con una encripta-
das por American Express, Microsoft, IBM,                  ción que sólo puede leer el banco.
Netscape, VeriSign, entre otras, con el fin            •   La relación entre el pedido y la orden
de permitir seguridad en las transacciones                 de pago, que los liga indisoluble-
electrónicas y brindar mayores garantías,                  mente.
para ello, utiliza certificados digitales, con
el fin de verificar la identidad de los usua-
                                                       •   El comercio recibe el pedido y verifi-
                                                           ca la validez de la firma digital.
rios involucrado en la transacción, la veri-
ficación se hace por medio del cifrado asi-            •   El comerciante pasa al banco la or-
métrico.                                                   den de pago (que él no ha podido
                                                           leer) con su firma digital.
Al utilizar el protocolo SET, el comerciante
puede disponer de un certificado digital que
                                                       •   El banco autoriza la transacción y de-
                                                           vuelve dos confirmaciones, una para
es emitido por la Autoridad de Certificación               el comerciante y otra para el titular
requerida, de otra parte, el comprador tam-                de la tarjeta.
bién dispone de un certificado digital que
es emitido por la entidad que emite la tarje-       El protocolo SET proporciona seguridad,
ta, el certificado incluye la firma digital de la   confidencialidad de los datos de las tarjetas
institución y la fecha de expiración.               de crédito, por cuanto el usuario comprado




                                                                Fundación
                                                                Fundación Universitaria
                                                                          Universitaria del
                                                                                        del Área
                                                                                            Área Andina
                                                                                                 Andina   112
                                                                                                          9
se identifica ante la entidad financiera, por        timo titular de la tarjeta de crédito que eje-
medio del certificado digital que emite por          cute la transacción.
el banco, lo que hace que la información de
la tarjeta de crédito no viaje por la red, lo        SET no es un protocolo gratuito, las entida-
que hace que dicha información no llegará            des bancarias deben pagar por el certifica-
                                                     do digital, aunque para el usuario es trans-
al comerciante, ni mucho menos puede ser
                                                     parente el uso del mismo. Generalmente,
interceptada.
                                                     cuando se utiliza SET, la duración de la tran-
Cuando los datos viajan por la red, lo hacen         sacción se establece entre 25 y 30 segundos,
                                                     es mayor que el tiempo de que gasta SSL. El
encriptados y protegidos por la firma digi-
                                                     comerciante prevé mayor complejidad, por
tal, lo que hace que no puedan ser alterados         cuanto al trabajar con SET, debe hacerlo con
por la red, a esto se le denomina “la integri-       SSL, pues no todos los clientes tienen certi-
dad de los datos”.                                   ficado digital.
Entre tanto, el comerciante se autentica ante        Hoy, se requiere que las transacciones co-
el comprador, indicando que se encuentra             merciales que se hacen por medio de la red,
autorizado para hacer cobros con tarjeta de          tenga mayores seguridades, por ello, se está
crédito. Por su parte, el cliente o usuario se       utilizando el protocolo SET, pues los nego-
autentica ante el comerciante como el legí-          cios virtuales B2B, lo utilizan también.




                              Imagen 6. Una típica compra de un cliente
                 Fuente: http://es.ccm.net/contents/136-criptografia-el-protocolo-set

En resumen, al utilizar el SET en una transac-       ción y el uso de bibliotecas para criptogra-
ción segura, los datos del usuario-cliente se        fía, incluyen funciones criptográficas que
envían al servidor del vendedor, y este solo         utilizan por ejemplo, los paquetes OpenSSH
recibe la orden, entre tanto, los números de         y los navegadores web.
la tarjeta de crédito de X banco, son envia-
dos al banco del vendedor, él lee los detalles       Las herramientas OpenSSL permiten al sis-
de la cuenta bancaria del comprador y con-           tema la implementación de SSL o TLS, como
tacta con el banco para que los verifique en         también crear certificados digitales para
tiempo real.                                         aplicarse en servidores como el Apache.
                                                     Otro de los usos de OpenSSL, es que ofre-
OpenSSL
                                                     ce certificados que se pueden utilizar con
Proyecto de software libre desarrollado por          aplicaciones software para asegurar que las
Eric Young y Tim Hudson. Es un paquete de            credenciales de quien las utilice (empresa o
herramientas que permiten la administra-             usuario individual) son válidas.




                                                                   Fundación Universitaria
                                                                   Fundación Universitaria del
                                                                                           del Área
                                                                                               Área Andina
                                                                                                    Andina   113
                                                                                                             10
Una de las mejores características de             cado. A continuación se guarda en el servi-
OpenSSL es que ofrece una capa cifrada de         dor web el archivo cacert.crt para poderlo
transporte sobre una capa normal de comu-         descargar e instalar.
nicación, la cual permite combinar aplica-
ciones con los servicios de red.                  En seguida se puede proceder a utilizar el
                                                  certificado, para ello, se crea una clave pri-
Los usos más valiosos de OpenSSL es que           vada y una solicitud de certificado, se utiliza
permite la validación cifrada de clientes de      un nombre común, una dirección web para
correo, como también las transacciones ba-        autentificar la página, el nombre del usuario
sadas en web, como por ejemplo, el pago           para autentificar los correos de ese usuario.
con tarjetas de crédito, entre otros.
                                                  OpenSSL es una aplicación que se trabaja
OpenSSL es utilizado para:                        desde la línea de comandos para poder usar
a. Crear certificados digitales, los cuales ga-   las funciones criptográficas de su librería
   rantizan técnica y legalmente la identidad     criptográfica desde la shell.
   de un usuario en Internet, también permi-
                                                  Otros usos de esta aplicación es para:
   ten la firma electrónica de documentos y
   cifrar en general las comunicaciones.          Crear claves RSA, DH y DSA, crear de certifica-
b. Instalar certificados digitales.               dos X.509, CSRs y CRLs, calcular funciones re-
                                                  súmenes de mensajes (MD5), encriptar y des-
c. Manejar los certificados digitales
                                                  encriptar con distintos algoritmos de cifrado
   •   Generar y firmar certificados.             simétricos (DES, IDEA, ...), realizar pruebas
   •   Revocar certificados.                      cliente/servidor utilizando el protocolo SSL.
   •   Renovar un certificado.                    PGP, Estándar OPENPGP y GNUPG
   •   Visualizar un certificado.
                                                  PGP
Para crear un certificado digital con             PGP - Pretty Good Privacy. Este programa
OpenSSL, se hace lo siguiente:                    fue desarrollado por Phil Zimmermann en
   •   Se crea un certificado raíz, el cual ge-   1991, su objetivo es la protección de la in-
       nera dos partes, una llave primaria y      formación que viaja a través de la red, por
       un certificado.                            medio de criptografía de clave pública, ade-
                                                  más autentica documentos por medio de
   •   Se protege el certificado de ataques       firmas digitales. Es el sistema para encrip-
       supuestos o robos y se usará solo          tación de comunicaciones por Internet más
       para firmar otros certificados.            utilizado en el mundo
   •   Se crean dos archivos, uno denomina-
       do index.txt, el cual debe estar vacío y   En otras palabras PGP respalda el autentica-
       el otro serial, el cual contiene un 01.    do de mensajes y comprueba su integridad.
                                                  PGP no solo protege os datos que viajan por
Luego se procede a la instalación del certifi-    la red, sino que también lo hace con los da-
cado, para ello se crea este como certificado     tos que se encuentran en los discos y en las
raíz y se almacena solo una parte del certifi-    copias de seguridad.




                                                              Fundación Universitaria
                                                              Fundación Universitaria del
                                                                                      del Área
                                                                                          Área Andina
                                                                                               Andina   114
                                                                                                        11
                          Imagen 7. Envío de un mensaje utilizando PGP
                                         Fuente: Propia


Como características principales de PGP se            •   Incorpora el algoritmo de ecripción
pueden enumerar las siguientes:                           AES-256.
   •   Aporta privacidad al correo electró-           •   Posee la función de resumen SHA-1.
       nico                                           •   Comprime datos BZip2, ZLIB, Zip.
   •   Como funciones principales se indi-        Para utilizar el PGP, ambos, emisor y recep-
       can: encripta mensajes, acepta firma       tor deben instalarlo en sus máquinas, de
       digital, comprime datos, ofrece com-       esta forma se genera automáticamente las
       patibilidad de correo.                     claves privadas y públicas.




                                   Imagen 8. PGP en el Emisor
                                        Fuente: Propia.


                                                                Fundación Universitaria
                                                                Fundación Universitaria del
                                                                                        del Área
                                                                                            Área Andina
                                                                                                 Andina   115
                                                                                                          12
                                 Imagen 9. PGP en el Receptor
                                       Fuente: Propia.

En las imágenes 8 y 9, se muestra cómo pro-      sido enviado por el verdadero emisor. Tam-
cede el protocolo PGP tanto en el servidor       bién se manifestará Confidencialidad del
Emisor y en el Receptor, desde que se envía      mensaje porque el cifrado de clave pública
el mensaje, hasta que se recibe.                 garantiza que el mensaje no ha sido leído
                                                 por algún intruso.
De las imágenes 8 y 9, se puede concluir lo
siguiente:
                                                 Una característica de PGP es que es muy
Se presentará Integridad de un mensaje           eficiente cuando se intercambian mensa-
cuando los resúmenes coinciden. Además           jes, porque cuando es posible, los datos son
se revelará Identidad, por medio de la firma     comprimidos antes de cifrarlos y/o después
digital, porque se sabrá que el mensaje ha       de formarlos.




                                                                Fundación Universitaria
                                                                Fundación Universitaria del
                                                                                        del Área
                                                                                            Área Andina
                                                                                                 Andina   116
                                                                                                          13
Los paquetes, son la estructura de datos              generar un paquete de datos cifrados
predilecta por PGP para codificar esos datos.         simétricamente, también se usa para en-
Es así que un mensaje PGP se puede formar             viar un mensaje con sobre digital. La cla-
por uno o más paquetes PGP. Estos paque-              ve pública que se utiliza en este paquete
tes no son otra cosa que un flujo de bytes            es la de cada uno de los destinatarios del
compuestos de una cabecera que identifica             mensaje.
el tipo de paquete y su longitud; luego tiene
                                                    e. Paquete de firma: contiene campos que
unos campos de datos que dependerán del
                                                       almacenan información como por ejem-
tipo de paquete.
                                                       plo, la clase de firma como:
Los tipos de paquetes PGP son los siguien-              •   firma de datos binarios.
tes:
                                                        •   Firma de texto canónico.
a. Paquetes de datos literales: utilizados
   para representar el claro, sin cifrar. Este          •   Certificado (agrupación de clave pú-
   paquete tiene dos campos, el uno indica                  blica y nombre de usuario).
   el valor de los datos y el otro dice si el va-       •   Revocación de clave pública.
   lor de los datos se ha de procesar como
                                                        •   Revocación de certificado.
   texto o como datos binarios.
                                                        •   Fechado – timestamp, que contie-
b. Paquetes de datos comprimidos: com-
                                                            ne, la fecha y hora en que se creó
   puesto por un campo para indicar el al-
                                                            a firma, el identificador de la clave
   goritmo que hará la compresión de los
   datos y el otro campo contiene una se-                   con la que se ha credo, los algorit-
   cuencia de bytes comprimidos, que al                     mos utilizados para el hash y para el
   descomprimirlos, resultará uno o más                     cifrado simétrico, la firma obtenida
   paquetes PGP.                                            aplicando los algoritmos que se es-
                                                            pecifican en los datos que se debe
c. Paquete de datos cifrados con clave si-                  firmar concatenados con los cam-
   métrica: compuesto por una secuencia                     pos autenticados.
   de bytes cifrados por medio de un algo-
   ritmo simétrico, al igual que en el caso         f. Paquete de clave pública: contiene infor-
   anterior, al descifrar los datos, dará como         mación relativa a una clave pública como:
   resultado uno o más paquetes PGP. Lo                fecha de creación de la clave, el algoritmo
   que se cifra en este paquete son paque-             a que corresponde la clave, los valores de
   tes de datos en claro o paquetes de datos           los componentes de la clave, cuando se
   comprimidos.                                        trate del algoritmo RSA, llevará como va-
                                                       lores el módulo n y el exponente público
d. Paquete de datos cifrados con clave pú-
                                                       e. La clave pública utiliza un número de
   blica: paquete que tiene tres campos, el
                                                       ocho bytes que sirve para buscar el valor
   uno para identificar la clave pública utili-
                                                       de la clave en una base de datos.
   zada, el otro para indicar el algoritmo de
   ciframiento utilizado y el tercer campo          g. Paquete de nombre de usuario: contiene
   usado para almacenar los datos cifrados.            una cadena de caracteres, utilizada para
   Este paquete es usado para cifrar la cla-           identificar el propietario de una clave
   ve des sesión, que ha sido utilizada para           pública.




                                                                Fundación Universitaria
                                                                Fundación Universitaria del
                                                                                        del Área
                                                                                            Área Andina
                                                                                                 Andina   14
                                                                                                          117
h. Paquete de clave privada: utilizado para        i. Paquete de nivel de confianza en una cla-
   almacenar los componentes de la clave              ve: paquete que no se envía nunca, sino
   privada de un usuario. La confidenciali-           que se almacena en el paquete de claves
   dad se logra a través de un archivo don-           de cada usuario. Es utilizado este paque-
   de se almacena el paquete con los com-             te para indicar qué confiabilidad tiene la
   ponentes secretos de la clave, los cuales          clave certificadora, lo que quiere decir
   deberán estar cifrados con una clave si-           que utiliza otras claves para asociar cla-
   métrica derivada de un passphrase, para            ves y nombres de usuarios.
   que cuando el usuario desee descifrar o
                                                   Cómo distribuye las claves PGP
   firmar el mensaje con la clave privada,
   deba indicar la passphrase para obtener         La certificación de claves PGP sigue el mode-
   los valores necesarios. De aquí que un          lo de las autoridades de certificación X.509
   usuario puede tener varas claves asocia-        y tiene un modelo descentralizado llamado
   das al mismo nombre o a diferentes nom-         de confianza mutua o malla de confianza,
   bres.                                           como se muestra en la imagen 10.




                                 Imagen 10. El modelo de confianza PGP
           Fuente: http://datateca.unad.edu.co/contenidos/233011/233011Exe/imagen13.jpg

Cuando un usuario genera su par de claves          del nombre de usuario y el de la firma for-
PGP (pública y privada), a la clave pública le     man un bloque de clave.
tiene que asociar un nombre de usuario y,
a continuación, tiene que autocertificar esta      Opcionalmente, el usuario puede asociar
asociación, es decir, firmar con su clave pri-     más de un nombre a la clave (por ejemplo, si
vada la concatenación de la clave pública y        tiene diversas direcciones de correo electró-
el nombre. El paquete de la clave pública, el      nico) y entonces, el bloque estará formado




                                                                Fundación Universitaria del Área Andina   118
                                                                Fundación Universitaria del Área Andina   15
por la clave pública y tantos pares nombre-      todos los correos electrónicos cifrados del
firma como sea preciso.                          mundo.

Otra manera en que se realiza la distribu-       Al convertirse en un estándar IETF propues-
ción de claves, es a través del servido de       to (RFC 4880), OpenPGP puede ser imple-
claves PGP, que almacena todas las claves        mentado por cualquier empresa sin pagar
públicas con sus certificados, los servidores    derechos de licencia.
se sincronizan entre ellos, de tal forma que
se realicen las actualizaciones del almacén      La Alianza OpenPGP reúne a empresas que
y se distribuyan de forma automática a to-       persiguen un objetivo común de promo-
dos los servidores, la falla estará en que los   ver el mismo estándar de cifrado de correo
servidores almacenan cualquier llave públi-      electrónico y aplicar la PKI a otras aplicacio-
ca sin verificar la identidad de quien guarda    nes que no sean de correo electrónico.
la clave, por lo que cada usuario que use el
servidor PGP, será quien se asegure de lo au-    OpenPGP es un estándar de Internet orien-
tenticidad de su clave.                          tado a la interoperabilidad de mensajes
                                                 que se protegen con criptografía. Utiliza
OpenPGP                                          dos programas a saber: Pretty Good Privacy
                                                 (PGP) y GNU Privacy Guard (GPG).
OpenPGP es un estándar de cifrado de
correo electrónico, muy utilizado a nivel        El correo electrónico es una herramienta
mundial. Se define por el Grupo de Traba-        que a diario millones de personas utilizan,
jo OpenPGP del Internet Engineering Task
                                                 sin imaginar lo inseguros que son; pero exis-
Force (IETF) es una propuesta RFC Standard
                                                 ten programas de software que permiten
4880. El estándar OpenPGP fue derivado
                                                 proteger los datos que viajan a través de la
originalmente de PGP (Pretty Good Priva-
                                                 red, como es el OpenPGP, cuyo objetivo es
cy).
                                                 el de salvaguardar esa información que se
OpenPGP es un protocolo no propietario           distribuye a través de Internet, por medio
para el cifrado de correo electrónico utili-     de cifrado de clave pública, de esta manera,
zando la criptografía de clave pública. Se       se facilita la autenticación de documentos
basa en PGP, que fue desarrollado por Phil       por medio de firmas digitales.
Zimmermann. El protocolo OpenPGP define
formatos estándar para los mensajes cifra-       El OpenPGP, es un sistema utilizado para
dos, firmas y certificados para el intercam-     encriptar y desencriptar datos que van por
bio de claves públicas.                          medio de la red, entre ellos, el correo elec-
                                                 trónico, también almacenamiento en el dis-
A partir de 1997, el Grupo de Trabajo            co duro. Este sistema utiliza la criptografía
OpenPGP se formó en la Internet Enginee-         de clave pública.
ring Task Force (IETF) para definir esta nor-
ma que anteriormente había sido un pro-          Estas herramientas OpenPGP son de uso
ducto propietario desde 1991. Durante la         libre para todas las personas y corren bajo
década pasada, PGP, y más tarde OpenPGP,         cualquier sistema operativo y se encuentran
se han convertido en el estándar para casi       en distintos idiomas.




                                                             Fundación Universitaria
                                                             Fundación Universitaria del
                                                                                     del Área
                                                                                         Área Andina
                                                                                              Andina   119
                                                                                                       16
GnuPG                                                cuales una clave primaria debe ser capaz de
                                                     generar firmas. De aquí que surgen tres op-
GNU Privacy Guard o GPG. Esta es una he-             ciones:
rramienta utilizada en la seguridad de las
comunicaciones electrónicas.                         1. Se generan dos pares de claves, de las
                                                        cuales una, es el par de claves DSA, lla-
Algunas de las tareas de GNUPG es la gene-              mado primario y se utiliza para firmar
rar el par de claves (pública y privada), así           únicamente.Genera también un par de
como intercambiar y comprobar la su auten-              claves ElGamal llamadas subordinadas,
ticidad; a la vez, cifra y descifra documentos,         utilizadas para el cifrado.
permite la firma digital de documentos y las
verifica.                                            2. Sólo se generarán un par de claves DSA.
                                                     3. Se generan un único par de claves ElGa-
                                                        mal, utilizadas para cifrar y descifrar.

                                                     No olvidar que cuando se escoge una clave,
                                                     debe indicarse el tamaño, que para las cla-
                                                     ves DSA es de 412 a 1024 bits, mientras que
                                                     la clave ElGamal puede ser de cualquier ta-
                                                     maño, pero en el caso de GnuPG, las claves
            Imagen 11. Logo de GnuPG
                                                     no debe ser inferiores a 768 bits. Por lo ante-
Fuente: https://lignux.com/crear-claves-gpg-desde-
              la-terminal-en-gnulinux/               rior, si se escoge la opción 1 y el tamaño de
                                                     clave mayor a 1024 bits, entonces ElGamal
La criptografía que utiliza GnuPG es la de           tendrá el tamaño deseado, pero DSA solo al-
clave pública, con el objeto que los usua-           canzará a 1024 bits. Una vez que se asigne el
rios se comuniquen de forma segura. Recor-           tamaño de clave, no se podrá cambiar nun-
dando, el sistema de claves públicas utiliza         ca. Luego se escogerá la fecha de caducidad
dos claves, una privada y una pública, de las        de la clave, por cuanto si se escoge la opción
cuales cada usuario mantiene la clave priva-         1, la fecha de caducidad se tomará para los
da muy secreta, mientras que la clave públi-
                                                     pares de claves de ElGamal y DSA.
ca la conoce cualquier persona con la que la
persona desee comunicarse.                           PnuPG criptosistema que reemplaza en su
                                                     totalidad a PGP, pues no utiliza IDEA ni RSA,
El esquema que practica GnuPG consiste en
                                                     se utilizan sin ninguna restricción y cumple
que el usuario tiene el par de claves prima-
                                                     las normas RFC2440.
rio y ninguno o más de un par de claves adi-
cionales subordinadas. Todas estas claves,           Sus principales características:
primarios y subordinados están agrupadas,
con el fin de facilitar la gestión de claves,        ■ No utiliza algoritmos patentados
con lo que el grupo se considera como un             ■ Se utiliza como un programa de filtrado
solo par de claves.
                                                     ■ Implementa los algoritmos: ElGamal en
Pero GnuPG tiene la capacidad de crear va-             firma y cifrado, DSA, TDESm BlowFish,
rios tipos distintos de pares de claves, de las        MD5, SAH-1, entre otros.




                                                                 Fundación Universitaria
                                                                 Fundación Universitaria del
                                                                                         del Área
                                                                                             Área Andina
                                                                                                  Andina   120
                                                                                                           17
■ Como tiene módulos de extensión, im-             Al personalizar el uso de GnuPG, se debe te-
   plementa nuevos algoritmos                      ner en cuenta:
■ El formato estándar que posee, permite           ■ Elegir el tamaño del par de claves pública
   identificar al usuario                            y privada, para prevenir ataques de fuer-
                                                     za bruta.
■ Puede implementar la fecha de caducidad
                                                   ■ Proteger la clave privada, para ayudar a
■ Puede ser utilizado libremente de forma            prevenir que un atacante llegue a utili-
   personal pero no comercial.                       zarla para descifrar los mensajes o para
                                                     firmar mensajes a nombre del dueño de
Las funciones básicas de GnuPG. Estas                la clave privada.
funciones incluyen generar un par de claves,
intercambiar y comprobar la autenticidad           ■ Seleccionar la fecha de caducidad y el
                                                     uso de subclaves
de claves, cifrar y descifrar documentos, y fir-
mar documentos y verificar firmas digitales.       ■ Gestionar el anillo de confianza, para ayu-
                                                     dar a evitar que algún atacante se haga
Utiliza criptografía de llave pública, con el        pasar por una persona de confianza.
objeto que los usuarios se comuniquen de
forma segura.                                      Seleccionar el tamaño de la clave

Cómo utilizar GnuPG                                El tamaño de la clave depende de la clave
                                                   en sí. El par de claves pública y privada con-
Primero se instala el paquete, luego se ge-        tienen en su mayoría claves múltiples, por
neran el par de claves, a continuación se es-      ejemplo, una clave de firmado maestra, po-
coge el periodo de validez o de caducidad,         siblemente una o más subclaves de cifrado
                                                   adicionales. Cuando se utilizan los paráme-
luego se crea el usuario que va a utilizar la
                                                   tros que trae por defecto GnuPG para gene-
clave y la contraseña privada,
                                                   rar claves, la clave maestra será una DSA y
El usuario intercambia las claves públicas,        las subclaves serán claves ElGamal.
para poder comunicarse con otros usuarios          Otro aspecto importante, es el cuidado de la
y puede generar claves públicas.                   clave privada y su tamaño, por ello es con-
                                                   veniente poder recordar con facilidad una
Se exporta la clave pública para poderla uti-      clave, pero que para otros sea difícil de adi-
lizar por correo o con otros equipos.              vinar, esto quiere decir, incluir en una clave,
                                                   números, letras, caracteres numéricos y ca-
Ahora se puede cifrar/descifrar archivos o
                                                   racteres especiales, pues de la fortaleza de
firmar un archivo.                                 la clave dependerá la privacidad de la infor-
                                                   mación que se cifre.
También se puede crear un certificado de
revocación, por si se olvida la clave o se pier-   Ejercicio para realizar
de la misma.
                                                   De la dirección: https://www.gnupg.org/
Se puede descargar desde la página oficial:        download/index.en.html descargue el pa-
https://www.gnupg.org/download/index.              quete GnuPG y una vez instalado, cree un
en.html                                            par de claves pública y privada.




                                                               Fundación Universitaria
                                                               Fundación Universitaria del
                                                                                       del Área
                                                                                           Área Andina
                                                                                                Andina   121
                                                                                                         18
 1
UNIDAD


     4Unidad 4




  Criptografía
  en la capa de        Criptografía y
   aplicación     mecanismos de seguridad

                      Autor: Lucy Medina
Introducción   En esta semana ocho, se continúa con el tema visto en la se-
               mana anterior. Los temas que aquí se estudian, corresponde
               a las herramientas denominadas OpenSSH que permiten rea-
               lizar comunicaciones cifradas a través de la red, para ello se
               utiliza el protocolo SSH.

               De la misma manera, se estudia el protocolo SSH, que encripta
               todo lo que envía y recibe, con el fin de facilitar las comunica-
               ciones seguras entre dos sistemas que utilizan la arquitectura
               cliente/servidor y que permite a los usuarios conectarse a un
               host remotamente.

               Enseguida de este escrito se estudia el protocolo Kerberos, el
               cual puede verse como un servicio que se utiliza en una arqui-
               tectura cliente-servidor, con el fin de ofrecer seguridad a cada
               una de las transacciones que se lleven a cabo en la red.

               Por último, en este escrito, se revisarán los temas que hacen
               referencia a las aplicaciones criptográficas, TrueCrypt, Ax-
               Crypt, STunnel y OpenVPN,




                                              Fundación
                                              Fundación Universitaria
                                                        Universitaria del
                                                                      del Área
                                                                          Área Andina
                                                                               Andina   123
                                                                                        3
U4            Metodología


     Ya se está en la última semana, es hora que el estudiante tenga los conceptos claros que se
     han analizado en el transcurso de esta asignatura. Por ello, es pertinente que por medio de
     este escrito avance en el conocimiento sobre los protocolos y herramientas criptográficas
     que se ubican en la capa de Aplicación del modelo TCP/IP.

     Para lograr los cometidos expuestos, se hacen las siguientes recomendaciones:

     Recomendaciones:
     ■ Realizar las lecturas asignadas.
     ■ Elaborar cada uno de los trabajos asignados.
     ■ Utilizar a conciencia, los recursos de aprendizaje sugeridos.
     ■ Realizar las evaluaciones propuestas.
     ■ Cuando no entienda algo, comuníquese con su tutor.
     ■ No continúe con el siguiente tema, hasta que esté perfectamente claro el tema actual.
     ■ Siempre que lea, hágalo entendiendo las ideas.




                                                                Fundación
                                                                Fundación Universitaria
                                                                          Universitaria del
                                                                                        del Área
                                                                                            Área Andina
                                                                                                 Andina   124
                                                                                                          4
U4            Desarrollo temático



     Criptografía en la capa de aplica-               difícil de descifrar para ser leídos. SSH per-
                                                      mite utilizar aplicaciones gráficas sobre la
     ción                                             red, las cuales son reenviadas desde el ser-
                                                      vidor, a esta técnica se le llama “reenvío por
     SSH y herramientas OpenSSH
                                                      X11”.
     SSH
                                                      SSH también utiliza la técnica denominada
     SSH-Secure Shell. Protocolo utilizado para       “reenvío por puerto”, que consiste en que
     facilitar las comunicaciones seguras entre       como SSH encripta lo que se envía o recibe
     los sistemas que utilicen una arquitectura       desde un cliente-servidor o viceversa, el ser-
     Cliente-Servidor. El trabajo de SSH, es el de    vidor SSH se convierte en un conducto para
     encriptar la sesión de conexión, lo que hace     que todos los protocolos inseguros se vuel-
     más difícil que algún intruso se apodere de      van seguros.
     contraseñas no encriptadas.
                                                      Al usar SSH desde el inicio de una sesión re-
     Algunas características del protocolo SSH,       mota o para copia de archivo, se disminu-
     es que proporciona protección luego de           yen las amenazas de seguridad como son,
     establecer la conexión inicial entre un clien-   la intercepción de comunicación entre dos
     te y un servidor. SSH es rápido, ya que sólo     sistemas a través de algún paquete sniffer
     hace envíos de texto, lo que permite enviar      o la personificación de un host en particu-
     menos datos, como por ejemplo imágenes           lar. Lo anterior se entiende como aquella
     de pantalla o programas vcn.                     seguridad que el servidor SSH, así como el
                                                      servidor utilizan firmas digitales para reali-
     Otras particularidades de SSH, es que el         zar la verificación de las entidades, teniendo
     cliente puede verificar que sí se encuen-        presente que la comunicación que existe
     tra conectado al servidor correspondiente.       entre el cliente y el servidor estará encripta-
     También el cliente puede transmitir la in-       da. Debido a lo anterior, hace casi imposible
     formación que lo autentica ante el servidor,     aquellos intentos por falsificar la identidad
     para ello utilizará 128 bits como encripta-      de alguno de los participantes en la comu-
     ción, la cual es robusta. Otra característica    nicación, pues los paquetes enviados o re-
     de SSH, es que tanto los datos enviados          cibidos, se encontrarán cifrados a través de
     como recibidos en la sesión establecida, se      una clave conocida únicamente por el siste-
     encriptan con 128 bits, lo que los hace muy      ma cliente y por el servidor.




                                                                  Fundación
                                                                  Fundación Universitaria
                                                                            Universitaria del
                                                                                          del Área
                                                                                              Área Andina
                                                                                                   Andina   125
                                                                                                            5
                                         Imagen 1. Protocolo SSH
    Fuente: http://ingeniatic.euitt.upm.es/index.php/tecnologias/item/560-protocolo-ssh-secure-shell

En la imagen 1, se puede apreciar la cone-            Un computador local que tenga lo si-
xión entre un cliente y un servidor, de tal           guiente:
manera que cuando el cliente es autentica-            ■ Un cliente SSH.
do ante el servidor, estos tienen la posibili-
dad de utilizar distintos servicios seguros a
                                                      ■ Tener instalada por ejemplo, la aplicación
                                                         PuTTY si usted tiene un sistema Windows,
través de la conexión, por ejemplo, usando
                                                         PuTTY es un cliente SSH con licencia libre
una sesión Shell interactiva, aplicaciones               y está disponible para Windows, Unix, Li-
X11 o túneles TCP-IP, evitando así la interfe-           nux. (La aplicación PUTTY, es un emula-
rencia de un intruso, el cual puede utilizar             dor gratuito utilizado con SSH entre otros
aplicaciones sniffer.                                    protocolos, para realizar conexiones y
                                                         conectar máquinas Windows con servi-
Para utilizar SSH, se requieren los siguientes           dores Linux o Unix).
elementos:
                                                      ■ Saber la dirección IP del servidor o má-
Un servidor y un cliente.                                quina remota.
                                                      ■ Tener el usuario válido del servidor o má-
El servidor SSH que deberá contar con:                   quina remota.
■ Una conexión a la red Internet en lo po-            ■ La contraseña del usuario que se encuen-
  sible.                                                 tra en la computadora remota o servidor.
■ El puerto 22 abierto y un firewall instala-         ■ El puerto 22 de salida deberá estar habili-
  do.                                                    tado en el firewall.




                                                                    Fundación
                                                                    Fundación Universitaria
                                                                              Universitaria del
                                                                                            del Área
                                                                                                Área Andina
                                                                                                     Andina   6
                                                                                                              126
Cuando se conecta un cliente SSH a un ser-          5. Una clave de sesión aleatoria es gene-
vidor, se siguen los siguientes pasos:                 rada por el cliente, quien deberá selec-
1. El cliente abre una conexión TCP al puer-           cionar un algoritmo para realizar cifrado
   to 22 del servidor.                                 simétrico.
2. Cliente y servidor se ponen de acuerdo           6. Utilizando el algoritmo RSA, el cliente
   en la versión del protocolo que van a               hace envío de un mensaje que contiene
   usar, todo de acuerdo a la configuración            clave de sesión y el algoritmo que selec-
   y capacidades de cada máquina.                      cionó para el cifrado.
3. El servidor envía al cliente su clave pú-        7. A partir de ese momento, en la comu-
   blica, pues él tiene el par de claves pú-           nicación se usará el algoritmo de cifra-
   blica-privada de RSA, que se llaman “cla-           do simétrico que fue seleccionado, así
   ves de host”.                                       como la clave de sesión compartida.
4. El cliente hace una comparación de la
                                                    8. A continuación, el usuario se autentica.
   clave pública que tiene almacenada con
   la enviada por el servidor, con el fin de        9. Se inicia la sesión interactiva entre clien-
   verificar la autenticidad de la clave.              te y máquina remota.




                                        Imagen 2. Túnel SSH
                  Fuente: http://geekland.eu/que-es-y-para-que-sirve-un-tunel-ssh/

En la imagen 2 se aprecia, la construcción          hace vulnerables, pero si se establece el tú-
que se ha hecho de un túnel SSH, el cual
                                                    nel SSH, será una solución para navegar con
proporciona seguridad en la comunicación
                                                    tranquilidad sobre la red, así no sea segura.
entre un cliente y la máquina remota. El tú-
nel SSH, sirve para minimizar los ataques por       Por ello, la confidencialidad estará asegura,
parte de intrusos, pues hoy en día la tecno-        lo mismo que la integridad de los datos que
logía impulsa a los usuarios a estar conecta-       se envían reciben. El túnel también es útil
dos casi todo el tiempo a una red, lo que los       para vulnerar algunas restricciones que tie-




                                                                 Fundación
                                                                 Fundación Universitaria
                                                                           Universitaria del
                                                                                         del Área
                                                                                             Área Andina
                                                                                                  Andina   127
                                                                                                           7
nen los proxis y los firewalls, estos túneles    OpenSSH
aseguran la comunicación entre dos com-          OpenSSH -Open Secure Shell- es una suit
putadoras y permiten que los protocolos          compuesta por varias herramientas como
débiles se fortalezcan, de estos, como el        ssh, scp (Secure Copy), sftp (Secure file Trans-
SMTP, HTTP, FTP, TELNET, entre otros. Hoy es     fer Progrma), sshd (el demonio SSH), estas
mucho más sencillo montar un servidor SSH        herramientas permiten realizar conexiones
que un servidor VPN o un Proxy.                  cifradas para comunicaciones sobre la red
                                                 utilizando el protocolo SSH. Este conjunto
Luego de mencionar las maravillas que ofre-      de herramientas ha sido desarrollado como
ce el túnel SSH, existen dos falencias que       alternativa abierta a SSH que es propietario.
también se deben considerar, como por
ejemplo, cuando se comunican el cliente y        OpenSSH se utiliza para la autenticación
el servidor, hay tramos en los cuales los da-    y sirve para realizar implementaciones en
                                                 diferentes sistemas operativos. Es capaz
tos se transmiten sin encriptar. Estos tramos
                                                 de autenticar usuarios utilizando sistemas
van del servidor SSH y el servidor web, así
                                                 como Keyboard interative, Kerberos y clave
como del servidor web al Servidor SSH. De        pública, que ya trae implementadas.
otra parte, se deben configurar aplicación
por aplicación, para poder realizar peticio-     Una característica importante de OpenSSH,
nes por medio del túnel SSH.                     es que cifra la información que viaja por la
                                                 red, con el fin de eliminar cualquier intru-
Para utilizar el protocolo SSH en Windows se     sión de personas no autorizadas o aquellas
utiliza la aplicación Putty, que permite hacer   que secuestran conexiones o cualquier otro
conexiones a distintos puertos, entre ellos el   tipo de ataque sobre la información en la
puerto 22, que es el puerto por defecto de       capad de red.
SSH. En cambio, para Linux y Unix, el proto-
colo SSH viene incorporado por defecto.          Algunas propiedades de protección de
                                                 OpenSSH, es que el cliente puede verificar
Algunos de los ataques que previene SSH          que realmente está conectado a un mismo
son:                                             servidor, de otra parte, la información de au-
                                                 tenticación utiliza 128 bits, al igual que los
   •   Ataques proveniente de Sniffers.          datos que se envían o reciben se encriptan
   •   IP Spoofing.                              con 128 bits; posibilita en envío de aplica-
                                                 ciones que vienen del intérprete de coman-
   •   MACpoofing.                               dos o lo que se denomina reenvío X11.
   •   DNS Spoofing.
                                                 En el evento que se desee instalar OpenS-
   •   Telnet Hickjacking.                       SH se deberá descargar el paquete ssh, pues
   •   ARP Spoofing.                             este paquete instala el servidor y el cliente.

   •   ARP Spoofing.                             Una vez que se instale la suit OpenSSH se
   •   IP Routing Spoofing.
                                                 puede configurar dos tipos de archivos, uno
                                                 es el dedicado al cliente, con ssh, scp y sftp;
   •   ICMP Spoofing.                            el otro está orientado al servidor.




                                                             Fundación Universitaria del Área Andina   8
                                                                                                       128
De otra parte, algunas herramientas que uti-      archivo asegura que el cliente SSH está co-
liza OpenSSH son: Ssh, scp, sftp, sshd, ssh-      nectado al servidor SSH correcto.
keygen, ssh-agent, ssh-add, ssh-keyscan.
                                                  Kerberos
Los archivos de configuración que se en-
cuentran en el directorio para el servidor son:   Kerberos es un protocolo de autenticación
                                                  de redes y fue creado por el MIT. Es un servi-
Moduli, que se compone de grupos Diffie-          cio que trabaja en una arquitectura Cliente-
Hellman, estos se utilizan para el intercam-      Servidor. Tiene la particularidad de que las
bio de claves.                                    computadoras puedan interactuar en una
                                                  red insegura, demostrando su identidad
ssh_config, archivo encargado de la confi-        proporcionando seguridad a las transaccio-
guración del sistema cliente SSH.                 nes en las redes.

sshd_config, archivo que permite la confi-        Conocido como un protocolo de seguridad,
ruación del demonio sshd.                         pues utiliza criptografía de claves simétricas
                                                  con el fin de evaluar los usuarios con los ser-
ssh_host_dsa_key, es la clave privada RSA         vicios de red, de esta forma no se envían las
que utiliza el demonio sshd.                      contraseñas a través de la red, es así que los
                                                  usuarios no autorizados no podrán capturar
ssh_host_dsa_key.pub, es la clave privada         las contraseñas que van por la red.
DSA que utiliza el demonio sshd.
                                                  Quizá una de las principales tareas de Ker-
ssh_host_rsa_key, es la clave privada RSA         beros es la de eliminar la transmisión por la
que utiliza el demonio sshd para la versión       red de la información utilizada para la au-
2 del protocolo SSH.                              tenticación, por ello es que Kerberos quita
                                                  la amenaza de los analizadores de paquetes
ssh_host_rsa_key.pub, archivo que contie-
                                                  que pueden interceptar contraseñas en la
ne la clave pública RSA, utilizada por el de-
                                                  red.
monio sshd para la versión 2 del protocolo
SSH.                                              Resumiendo, Kerberos impide que las cla-
                                                  ves se envíen por la red y centraliza la auten-
Entre tanto, los archivos para configurar el
                                                  ticación de usuarios, para ello mantiene una
cliente se encuentran en el directorio de tra-
                                                  sola base de datos de usuarios para toda la
bajo de cada uno de los usuarios.
                                                  red.
Los archivos que se encuentran dentro del
                                                  El uso de Kerberos simplemente es el de
directorio .ssh para configurar el cliente son:
                                                  restringir el acceso a los usuarios autoriza-
Identity.pub, es la clave pública RSA uti-        dos y lo que hace también es que autentica
lizada por ssh para el protocolo SSH en su        los requerimientos a servicios, tomando en
versión 1.                                        consideración que esté en un entorno distri-
                                                  buido abierto, pues esos usuarios acceden a
Known_hosts, archivo que contiene las cla-        los servicios de los servidores que se distri-
ves de host DSA de los servidires SSH, este       buyen a través de la red.




                                                              Fundación
                                                              Fundación Universitaria
                                                                        Universitaria del
                                                                                      del Área
                                                                                          Área Andina
                                                                                               Andina   129
                                                                                                        9
El funcionamiento general de Kerberos es el      iniciar sesiones en equipos diferentes pero
siguiente:                                       que tengan instalado el servicio Kerberos,
■ Cada uno de los usuarios posee una cla-        se pueden ejecutar comandos, intercambiar
  ve.                                            datos y se pueden enviar archivos de forma
                                                 segura.
■ Cada     uno de los servidores posee una
  clave.                                         Integridad de los datos. Confirma que los
■ En Kerberos, existe una base de datos          datos no se modificaron en tránsito, es lo
  que contiene todas las claves, tanto de        que comúnmente se denomina Mensaje Se-
  usuario como de los servidores.                guro.
■ La clave de cada usuario se deriva de su       Privacidad de los datos. Pues cumple con
  contraseña y estará cifrada.                   su objetivo principal y es el de que los datos
■ Las claves de los servidores se generan        no sean leídos en el transcurso de la trans-
  de forma aleatoria.                            misión, para ello cifra y autentica cada uno
■ En Kerberos deberán registrarse los usua-      de los mensajes privados.
  rios que necesiten utilizar servicios, así
                                                 Cómo funciona Kerberos. Los servidores
  como los servicios de red que requieran
                                                 Kerberos se les denominan Kerberos Distri-
  autenticación, también estarán registra-
                                                 bution Center - KDC y entrega dos servicios
  dos.
                                                 muy importantes como son, la Autentica-
■ Cuando los usuarios se registren pueden        ción - AS- Authentication Service y el Ticket
  negociar sus claves privadas.                  - TGS- Ticket Granting Service.
■ Como Kerberos conoce todas las claves          Cuando se utiliza el servicio AS, este tiene
  privadas, entonces crea mensajes para
  indicar al servidor sobre la autenticidad      como meta autenticar la primera vez a un
  de un usuario que necesita un servicio         usuario y le entrega un ticket, que servirá
  que está en el servidor.                       para comunicarse con otro usuario.

Kerberos presenta algunos niveles de pro-        El servicio de Tickets entrega a los usuarios,
tección como son:                                los documentos necesarios para establecer
                                                 la comunicación con el servidor que le en-
La autenticación. Porque prueba que el           tregará el servicio, pues él es el que posee
usuario es quien dice ser, en términos gene-     una base de datos con las claves privadas de
rales, garantiza que las identidades tanto el    los usuarios.
usuario como del servidor son las verdade-
ras. Este nivel ofrece la Integridad, debido a   Cuando se habla de Arquitectura de Ker-
que se verifica la validez de los datos que se   beros, puede indicarse que se basa en tres
transmiten entre cliente y servidor, a la vez,   objetos imprescindibles de seguridad como
entrega privacidad, debido a que los datos       son: la Clave de Sesión, el Ticket y el Auten-
son cifrados, es así que Kerberos se pueden      ticador (ver imagen 3).




                                                             Fundación Universitaria del Área Andina   130
                                                             Fundación Universitaria del Área Andina   10
                                   Imagen 3. Arquitectura de Kerberos
                    Fuente: http://www.monografias.com/trabajos12/rete/rete.shtml

La clave de sesión, Kerberos produce la cla-          usuario o un servicio. Este ticket tiene como
ve secreta para el cliente, la cual utilizará         función la de garantizar que el cliente se ha
con el servidor mientras realiza su sesión de         autenticado en el servidor.
trabajo.
                                                      El autenticador, lo construye el cliente y lo
El Ticket, o también denominado vale; este
                                                      envía al servidor, con el objeto de probar la
proporciona el control de acceso desde
la estación de trabajo del usuario hacia el           identidad del usuario, así como para ver la
servidor. Se considera como un conjunto               actualidad de la comunicación, este objeto
de datos electrónicos para identificar a un           solo puede ser usado una sola vez.




            Imagen 4. Autenticación inicial de un cliente para establecer una sesión Kerberos
                                             Fuente: Propia.

Cómo se autentica un usuario inicialmen-              pueda autenticarse por sí mismo. En la ima-
te                                                    gen 4 puede apreciarse esta autenticación
Para poderse identificar un usuario debe              inicial, en donde el usuario-cliente o servi-
cumplir dos pasos, el primero consisten en            cio como el NFS inicia la sesión Kerberos pi-
autenticarse por primera vez para que luego           diendo se le asigne un Ticket -TGT- desde el




                                                                    Fundación Universitaria
                                                                    Fundación Universitaria del
                                                                                            del Área
                                                                                                Área Andina
                                                                                                     Andina   131
                                                                                                              11
Centro de Distribución de claves -KDC- esta          ras, teniendo claro que si requiere hacer una
petición es automática en el inicio de se-           operación de red única, solicitará al KDC un
sión. A continuación KDC crea el ticket para         ticket para esa operación.
entregárselo al cliente y se lo envía en for-
mato cifrado. El cliente descifra el ticket de       El segundo paso consiste en que si el usua-
                                                     rio ya recibió la autenticación inicial, cada
otorgamiento de tickets con la contraseña
                                                     autenticación posterior sigue el patrón que
del cliente. Una vez el cliente tiene el ticket
                                                     se muestra en la imagen 5.
válido, puede pedir otros tickets para reali-
zar operaciones de red (operaciones como             Cuando el cliente o usuario ha hecho su au-
rlogin, telnet) mientras el periodo de otor-         tenticación inicial, cada una de las autenti-
gamiento de tickets en el servidor sea váli-         caciones siguientes, deben seguir los pasos
do, pues generalmente solo dura unas ho-             que se muestran en la imagen 5.




                      Imagen 5. Acceso a un servicio con la autenticación Kerberos
                                            Fuente: Propia.


En la imagen anterior se aprecia cómo el             ■ El tercer paso, consiste en que el cliente
usuario o cliente accede a un servicio con               envía el ticket al servidor.
Kerberos, para ello, se siguen cuatro (4) pa-
sos, en el primer paso, se hace la petición al       ■ El cuarto paso es cuando el servidor per-
KDC de un ticket para un servicio en parti-              mite el acceso de clientes.
cular, podría ser para iniciar sesión de ma-
nera remota en otra máquina, por lo tanto            Cuando un cliente se une a un server por
deberá enviar al KDC el ticket que le han            Kerberos de manera remota, los comandos
otorgado como prueba de su identidad.                que se utilizan son: ftp, rcp, rdist, rlogin, rsh,
■ En segunda medida, el KDC envía el tic-            ssh, telnet. Los anteriores, son llamados co-
  ket por el servicio específico al cliente.         mandos de usuario Kerberos.


                                                                   Fundación Universitaria
                                                                   Fundación Universitaria del
                                                                                           del Área
                                                                                               Área Andina
                                                                                                    Andina   132
                                                                                                             12
    Imagen 6. Ejemplo de dominios Kerberos
                 Fuente: Propia.


Los dominios de Kerberos (ver imagen 6)
son redes lógicas las cuales se componen
de un grupo de sistemas que tienen el mis-
mo KDC principal. Los dominios pueden
relacionarse entre sí y algunos de ellos, son
jerárquicos, pero el tipo de jerarquía deberá
                                                 Imagen 7. Cómo puede ser un dominio Kerberos
ser definida y entre ellos deberán autenti-       Fuente: https://docs.oracle.com/cd/E24842_01/
carse; este proceso de Kerberos se llama Au-                html/E23286/intro-25.html
tenticación entre dominios.
                                                Otras aplicaciones criptográficas
De los dominios que se observan en la Figu-
ra 4, cada uno debe incluir un servidor que     TrueCrypt
almacene una copia de las bases de datos        TrueCrypt es una aplicación informática
del principal, a este servidor se le denomi-    freeware descontinuada que sirve para ci-
na servidor KDC maestro y cada uno de los       frar y ocultar datos que el usuario considere
dominios también deberá tener por lo me-        reservados empleando para ello diferentes
nos un servidor KDC esclavo, el cual tendrá     algoritmos de cifrado como AES, Serpent y
copias de la base de datos del principal. El    Twofish o una combinación de los mismos.
servidor maestro y el esclavo han de crear
tickets usados para la autenticación.           TrueCrypt es una aplicación que se utiliza en
                                                la codificación y decodificación de datos en
Aparte del servidor KDC maestro y esclavo,      tiempo real. Tiene un volumen normal, que
el dominio incluirá un servidor de aplicacio-   permite el acceso por medio de una con-
nes Kerberos. En la imagen 7, se visualiza un   traseña, luego el sistema mostrará un nue-
ejemplo de dominio.                             vo disco duro. El volumen oculto, accede a




                                                            Fundación Universitaria
                                                            Fundación Universitaria del
                                                                                    del Área
                                                                                        Área Andina
                                                                                             Andina   133
                                                                                                      13
la información tras digitar una clave y solo   duro o las USB; el procedimiento anterior
muestra el volumen oculto, el cual tendrá      hace casi imposible la intrusión de extra-
los archivos más importantes, como las cla-    ños, además que la unidad cifrada funciona
ves de banco, claves de correos electrónicos   como si no lo estuviera
documentos privados.
                                               AxCrypt
De otra parte, TrueCrypt sirve para crear y
mantener un dispositivo de almacenamien-       Esta herramienta permite proteger la confi-
to de datos cifrado; los datos se pueden ci-   dencialidad de los archivos. La codificación
frar al instante, de forma automática sin la   por medio de esta herramienta es de 128
intervención del humano y todo el sistema      bits, que hace que un documento esté total-
se cifra, desde los nombres de los archivos,   mente protegido. Se utiliza para el envío de
carpetas, contenido, espacio libre, meta da-   archivos por correo electrónico, teniendo la
tos y demás.                                   seguridad que sólo la persona interesada y
                                               receptora que conoce la contraseña podrá
Como se indicó en un párrafo anterior, los     revisarlos.
algoritmos de cifrado que soporta True-
Crypt son: AES, Serpent, Twofish.              AxCrypt es el software para cifrar archivos
                                               de código abierto para Windows. Se integra
Además utiliza diferentes combinaciones        perfectamente con Windows para compri-
de los anteriores algoritmos como son:         mir, cifrar, descifrar, almacenar, enviar y tra-
                                               bajar con archivos individuales.
   •   AES-Twofish.
   •   AES-Twofish-Serpent.                    Una característica importante es que Ax-
                                               Crypt tiene la opción de auto desencripción
   •   Serpent-AES.                            de archivos y reencripción automática, des-
   •   Serpent-Twofish-AES.                    pués de haberlo editado, elimina de forma
   •   Twofish-Serpent.
                                               total y segura de archivos, además valida la
                                               integridad de los datos y contraseñas crip-
   •   Algoritmos de hash, como RIPE-          tográficas. Los archivos que cifra la herra-
       MD-160, SHA-512 y WHIRLPOOL.            mienta tienen la extensión *.axx.
La característica más notoria de TrueCrypt e   AxCrypt está integrado al navegador In-
que crea un área completa protegida den-       ternet Explorer, quien encripta, desencrip-
tro de la PC, allí se pueden almacenar los     ta, visualiza y edita cualquier archivo. Esta
archivos asegurados, pues todo el volumen      herramienta usa los algoritmos AES-128 y
estará cifrado con una clave que el usuario    SHA-1, quienes cumplen los requerimientos
mismo crea.                                    de seguridad de los Estados Unidos y de las
                                               normas, reglas y convenios de Internet.
TrueCrypt, esta aplicación de código abierto
está hecha para funcionar en sistemas ope-     AxCryt es una herramienta de software gra-
rativos, Windows, Linux y Mac. Los discos      tuita, de código abierto, que realiza cifrados
virtuales cifrados que crea, se comportan      de alta seguridad, y al ser de código abierto
como unidades de disco externos sin serlo;     asegura que no hay puertas traseras cuando
también se puede proteger todo el disco        se cifran los archivos.




                                                           Fundación Universitaria
                                                           Fundación Universitaria del
                                                                                   del Área
                                                                                       Área Andina
                                                                                            Andina   134
                                                                                                     14
Las características más notables de AxCrypt     certificados, ofrece certificado de remoción
son las siguientes:                             CRL y OCSP, soporta servidores virtuales
■ El cifrado de archivos de alta seguridad      basados en nombre, llamados SNI-Server
                                                Name Indication; para el cumplimiento, uti-
  lo ofrece AxCryt sobre un número X de
  archivos.                                     liza el modo FIPS y configura los motores de
                                                hardware.
■ Se integra con el browser Internet Explo-
  rer.                                          En las plataformas Windows utiliza una GUI-
■ Con un solo doble clic sobre un archivo,      Interfaz Gráfica muy sencilla, ofrece la posi-
  es posible abrir, editar y guardar cual-      bilidad de almacenar en caché cadenas de
  quier archivo.                                certificados de pares a los archivos y utiliza
                                                el modo servicio de Windows. Además de
■ Es  una herramienta muy sencilla, solo        las características mencionadas, también re-
  se instala y funciona, sin ningún tipo de     direcciona conexiones de cliente SSL cuan-
  configuración, además de poder desci-         do se presentan errores de autenticación,
  frar archivos.                                soporta IPv6.
■ Tiene la capacidad de cifrar archivos que
  se envían a través de Internet, como por      OpenVPN
  ejemplo, a través del correo electrónico.
                                                OpenVPN es una solución de software libre,
■ Esta herramienta se encuentra en mu-          creada por James Yonan (2001), está basado
  chos idiomas, lo que hace que pueda ser       en SSL-Secure Sockets Layer y VPN - Virtual
  usada casi por todo el mundo.                 Private Network.
La página en la que puede descargarse gra-      Una de las principales características es que
tuitamente es: http://www.axantum.com/          OpenVPN proporciona conectividad en-
axcrypt/                                        tre máquinas conectadas a dos extremos
                                                (punto a punto), además permite validar
STunnel                                         jerárquicamente a los usuarios y a los host
                                                conectados de forma remota. Utilizada a
STunnel es un programa que funciona con el
                                                menudo en redes inalámbricas o wifi.
protocolo de encripción SSL entre el cliente
y el servidor. Al usar OpenSSL para la crip-    La seguridad que ofrece OpenVPN se com-
tografía, lo hace compatible con los algorit-   bina con el nivel empresarial, la simplifica-
mos criptográficos de la biblioteca.            ción en el uso y el cúmulo de características
                                                que posee. Además es una solución multi-
Las principales características de STunnel:
                                                plataforma que proporciona un uso sencillo
En cuanto al rendimiento y escalabilidad, re-   cuando se desea usar con configuraciones
parte carga entre varios servidores de back-    VPN’s. Este tipo de soluciones se emplea
end, para grupos trabaja con la caché de se-    por ejemplo para, acelerar los procesos de
sión externo.                                   negocios, por cuanto se tendría intercam-
                                                bio rápido y flexible de la información, en
Sirve como soporte para las funciones           el evento de comunicar toda una empresa
OpenSSL, controlando el acceso basado en        con sus sucursales, además, si un empleado




                                                            Fundación Universitaria del Área Andina   15
                                                                                                      135
requiere comunicarse con su oficina o con          ternet, la privacidad se encuentra, porque
compañeros de trabajo, podrán intercam-            solo los autorizados pueden capturar o leer
biar información de manera rápida. Lo an-          los datos que viajan por la red, de esta ma-
terior quiere decir que OpenVPN ofrece au-         nera se logra seguridad usando los nuevos
tenticidad, integridad, disponibilidad de la       mecanismos de criptografía. Es así, como se
información a través de las redes.                 observa en la ver imagen 9 que solo se re-
                                                   quieren cuatro (4) conexiones a la red Inter-
Las VPN’s surgen de aquella necesidad de           net en lugar de las seis (6) que se requerirían
conectar a través de Internet distintos usua-      en una conexión dedicada (Ver imagen 8),
rios. Es el caso de la utilización de estas re-    en donde se tiene una red de cuatro nodos,
des VPN - Redes Virtuales y Privadas, que no       los cuales quieren comunicarse entre ellos
son otra cosa que conexiones virtuales que         (todos con todos), por lo que se requieren
mediante software pueden operar sobre In-          seis (6) líneas para poderse comunicar.




                       Imagen 8. Comunicación de nodos por redes dedicadas
                                         Fuente: Propia.




                           Imagen 9. Comunicación de nodos por red VPN
                                         Fuente: Propia.




                                                                Fundación Universitaria
                                                                Fundación Universitaria del
                                                                                        del Área
                                                                                            Área Andina
                                                                                                 Andina   136
                                                                                                          16
El uso que se les da a las redes VPN van des-       intercambiar información pero no deberán
de conectar varios puntos de una empresa            ingresar al resto de la red propia de la em-
a través de Internet o conectar a usuarios
                                                    presa. En este tipo de redes, la fiabilidad en
corrientes con IP dinámica, pasando por
soluciones que dan acceso a clientes de             la comunicación es excelente en los usua-
forma extrared con los cuales se necesita           rios móviles.




                Imagen 10. Una red Virtual Private Network –VPN o Red privada Virtual
                             Fuente: http://www.telypc.com/vpn.html


En la Imagen 10 puede verse una red VPM,            Los componentes de la red VPN, se pueden
que se monta de la siguiente manera:                ver en la imagen 11, que consisten en el Ser-
                                                    vidor VPN, El Túnel, la conexión VPN, la red
■ El servidor VPN, es el que acepta peticio-        por donde transitan los dato y por supuesto
  nes de un cliente VPN.                            el cliente VPN.
■ El cliente VPN, es el equipo que inicia la
  conexión hacia el servidor VPN, el equipo         Es así que los protocolos de túnel, son usa-
  VPN cliente, puede ser un máquina indi-           dos para la administración de túnele, así
                                                    como para encapsular los datos, los cuales
  vidual o en su defecto un enrutador.
                                                    también deberán estar cifrados, con ello se
■ El túnel, es una parte de la conexión so-         puede construir una conexión VPN.
  bre la cual se encapsula la información.
                                                    En cuanto a los datos en el túnel, estos se
■ Conexión VPN, en esta parte se cifran los         envían por medio de una conexión punto a
  datos, es así que cuando se utilizan cone-        punto. En un ambiente VPN, existen redes
  xiones VPN seguras, los datos se cifran y         compartidas o privadas, por donde viajan los
  encapsulan en la misma parte de la co-            datos encriptados y estas redes pueden ser
  nexión.                                           una intranet basada en IP o la red internet.




                                                                  Fundación Universitaria
                                                                  Fundación Universitaria del
                                                                                          del Área
                                                                                              Área Andina
                                                                                                   Andina   137
                                                                                                            17
                                                     estar encriptada para que viaje de forma
                                                     segura y no pueda ser leída o interpretada
                                                     sino solo por el interesado y para ello, se po-
                                                     drá cifrar por medio de los algoritmos DES-
                                                     Data Encryption Standar, o por el Triple DES-
                                                     3DES o en su defecto por AES-Advanced
                                                     Encrytion Standar.

                                                     Para complementar, OpenVPN es una solu-
                                                     ción de software del tipo cliente-servidor,
                                                     que funciona en máquina Linux o Windows.
                                                     Como se ve en las imagenes 10 y 11, el túnel
   Imagen 11. Componentes de una red privada         que se forma entre el cliente VPN y el servi-
                      virtual                        dor VPN a través de Internet. De aquí que
 Fuente: https://msdn.microsoft.com/es-es/library/
                                                     a OpenVPN se le denomine un modelo de
              cc786563(v=ws.10).aspx
                                                     seguridad basado en SSL, pues este es un
Una red VPN da la posibilidad de extender            estándar de seguridad utilizado para las co-
la red local sobre la red pública Internet, un       municaciones seguras a través de internet.
claro ejemplo, es el de conectar dos o más
                                                     El software OpenVPN es utilizado para crear
sucursales de una misma empresa por me-
                                                     las VPN que se basan en SSL, que permiten
dio de Internet o en su defecto que un usua-
                                                     la conexión segura de oficinas remotas, ade-
rio pueda comunicarse con su PC personal
                                                     más de ofrecer seguridad a clientes móviles
desde su trabajo a su casa.
                                                     que se sirven en redes privadas o LAN.
Pero para poder ratificar las virtudes de una
                                                     Algunas características del software Open-
buena conexión, se debe garantizar la con-
                                                     VPN son:
fidencialidad, la integridad y por supuesto
la autenticación. En la autenticación o tam-         ■ Ofrece soluciones VPN a las empresas ba-
bién llamada autorización se debe tener en             sadas en software libre.
cuenta quién está al otro lado de la red, qué
usuario, en qué equipo y el nivel de acceso
                                                     ■ Se pueden diseñar túneles VPM, utiliza-
                                                       dos para conexiones punto a punto, así
que tenga el usuario. En cuanto a la integri-
                                                       como para usuarios móviles.
dad, es la certeza de que los datos que se
envían no sean alterados, para lograrlo, se          ■ El medio de transporte que utiliza son los
utilizan las funciones Hash, como ejemplo              protocolos TCP o UDP.
sería el MD2, MD5 o el SHA (Secure Hash Al-          ■ Utiliza un único puerto TCP o UDP con
goritm).                                               múltiples conexiones a una misma ins-
                                                       tancia.
En cuanto a la confidencialidad, los datos
viajan por una red potencialmente insegu-            ■ Al crear los túneles VPN estos funcionan
ra como lo es Internet, a la cual se le puede          sobre una Network Address Traslation -
interceptar, por ello, la información deberá           NAT, así como direcciones IP dinámicas.




                                                                 Fundación Universitaria del Área Andina   18
                                                                                                           138
■ Para   ofrecer comunicaciones seguras y          ■ Las conexiones OpenVPN se hacen utili-
   con autenticación, se basa en los están-          zando casi todos los firewall del merca-
   dares SSL/TLS, para cumplir con su come-          do.
   tido utiliza todas sus características para
   el cifrado, autenticación y certificación,      Ejercicio para realizar
   esto con el fin de preservar el tráfico que
   se hace por la red.                             Aprenda a utilizar la herramienta Vantir, uti-
                                                   lizada para definir el tamaño del bloque a
■ El cifrado que utiliza es muy amplio, pues       encriptar, el tamaño de la clave utilizada y el
   toma cualquiera de ellos, también el ta-        número de fases de encriptación. Con estas
   maño de la clave es cualquiera.                 características se puede encriptar y desen-
■ El cifrado que utiliza OpenVPN es flexible       criptar texto con uno de los siguientes Algo-
   tanto en tamaño como en el tipo de lla-         ritmos: RC2, TripeDES, AES, DES.
   ves estáticas, esto cuando se realiza cifra-
   do convencional y si se hace cifrado asi-       Para lograr el cometido, ingrese a la di-
   métrico, utiliza llaves públicas que usan       rección: http://www.vantir.com/Encriptar.
   certificados x509.                              aspx
■ Las llaves estáticas que utiliza, pueden         Escoja todos los algoritmos criptográficos
   ser compartidas o dinámicas basadas en          que allí aparecen en la margen izquierda,
   TLS cuando realiza intercambio de claves.       haga el ejercicio uno por uno: RC2, Tripe-
■ Cuando se usan redes VPN, se puede en-           DES, AES, DES. Escriba un texto claro o listo
   tregar por medio del servidor DHCP que          para ser encriptado. Pulse botón Encriptar.
   se integra a OpenVPN información como           Notará que el texto se encripta y la herra-
   la dirección IP virtual dinámica o estática,    mienta le otorga una Llave-key y un campo
   la dirección de los servidores DNS, la di-      IV, copie en algún archivo: la clave genera-
   rección del gateway predeterminado y el         da, el campo IV y el mensaje cifrado. Oprima
   servidor Wins.                                  el botón limpiar (le limpiará todos los cam-
                                                   pos). A continuación, copie el texto cifrado
■ Integra el firewall con el fin de filtrar trá-   que figura en la parte inferior de la pantalla
   fico VPN.                                       y péguelo en la parte superior. A continua-
■ Ofrece soporte a los clientes cuando uti-        ción oprima el botón Desencriptar, luego de
   lice sistemas operativos Linux, solaris,        escribir la clave que le generó el sistema y
   OpenBSD, Windows, Mac OSX, FreeBSD,             llene el campo IV con la información guar-
   entre otros.                                    dada.




                                                               Fundación Universitaria
                                                               Fundación Universitaria del
                                                                                       del Área
                                                                                           Área Andina
                                                                                                Andina   139
                                                                                                         19
Bibliografia
■■Alonso de armiño, A. (2014). Kerberos: un servicio de autenticación para redes. Dpto. de
  Informática y Estadística. Fac. De Economía Y Administración-Universidad Nacional Del
  Comahue. Buenos Aires: Argentina.
■■Ángel, J. (s.f.). Criptografía para principiantes.
■■Arteaga, A. (2014). El gamal. Criptografía de clave pública. Ver Link
■■Ayuso, J. (2003). Protocolos criptográficos. Universidad de Valladolid. Ver Link
■■Bart, P. (2014). Cryptographic Primitives for Information Authentication. Criptografia- -
  State of the Art. Katholieke Universiteit Leuven.
■■Bejarano, K., Londoño, M., Amador, S. & Muñoz, L. (2014). Criptografía simétrica y asimé-
  trica. Ver Link
■■Caballero, P. (2002). Introducción a la criptografía. 2ª edición. RAMA Editorial.
■■Chinchilla, E. (2008). Aplicaciones criptográficas. Ver Link
■■Delgado, V. (2006). Introducción a la criptografía: Tipos de algoritmos. Anales de mecánica
  y Electricidad. Vol. 83.
■■Durán, R., Hernández, L. & Muñoz, J. (2005). El criptosistema. RSA. Rama-editorial.
■■Franco, J., Sarasa, M. &, Salazar, J. (1998). Criptografía digital: fundamentos y aplicaciones.
  Ed. Prensas Universitarias de Zaragoza.
■■Fuster, A., De la Guia, D., Hernández, L. & Montoya, F. (2004). Técnicas.
■■García, E., López, M. & Ortega, J. (s.f.). Una introducción a la criptografía. Ver Link
■■Hernández, S. (s.f.). La Criptografía Clásica. Ver Link
■■Huguet, L., Rifá, J. & Tena, J. (2013). Protocolos criptográficos. Universidad Oberta de Ca-
  taluña.
■■Instituto Nacional de Tecnologías de la Comunicación. (2014). Esteganografía, el arte de
  ocultar información. Observatorio de la Seguridad de la Información.
■■Jarauta, J., Palacios, R. & Sierra, J. (2008). Seguridad informática, criptografía asimétrica.
  Universidad Pontificia Comillas. Madrid: España.
■■Kioskea.net. (2014). Criptografía -Secure Sockets Layers- SSL.
■■Lucena, M. (2010). Criptografía y seguridad en computadores.
■■Maiorano, A. (2010). Criptrografía. Técnicas de desarrollo para profesionales. RA-MA Edi-
  torial.




                                                               Fundación Universitaria del Área Andina   140
Bibliografia
■■Massachusetts Institute of Technology-MIT. (2013). La criptografía - Escritura oculta.
■■Orozco, G. (s.f.). Introducción a la criptografía. México.
■■Pousa, A. (2011). Algoritmo de cifrado simétrico aes. Aceleración de tiempo de cómputo
  sobre arquitecturas Multicore. Universidad Nacional de la Plata. Argentina.
■■Stallings, W. (2006). Fundamentos de seguridad en redes, aplicaciones y estándares. Pear-
  son, Prentice Hall, Tercera Edición.
■■Wanumen, L. (2006). Cómo crear herramientas seguras de desarrollo usando código segu-
  ro. Revista Vínculos. Universidad Distrital Francisco José de caldas. vol.3, No.1.




                                                              Fundación Universitaria del Área Andina   141
Esta obra se terminó de editar en el mes de noviembre
            Tipografá Myriad Pro 12 puntos
                Bogotá D.C,-Colombia.
